{
 "paragraphs": [
  {
   "settings": {
    "params": {
     "bdtMeta": {}
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "// FILE #2",
   "id": "",
   "dateCreated": "2023-05-08 15:40:50.806",
   "config": {},
   "dateStarted": "2023-06-11 15:23:50.913",
   "dateUpdated": "2023-06-11 15:23:54.178",
   "dateFinished": "2023-06-11 15:23:54.177",
   "results": {
    "code": "SUCCESS",
    "msg": []
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Quantidade de quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "import org.apache.spark.sql.DataFrame\nimport org.apache.spark.sql.functions._\nimport spark.implicits._\n\nval joinFolder = \"/data/joins\"\nval saveJoins = false\n\ndef saveDataFrame(df: DataFrame, name: String): Unit = {\n    df.coalesce(1) // Print into a single file\n            .write\n            .mode(\"overwrite\")\n            .option(\"delimiter\", \";\")\n            .option(\"header\", true) // Maintain Headers\n            .csv(s\"$joinFolder/$name\") // Write to csv\n}\nval initialCount = spark.sql(\"SELECT DISTINCT * FROM QuartosReservados\")\ninitialCount.show(100)\nprintln(initialCount.count())",
   "id": "",
   "dateCreated": "2023-04-30 19:59:44.804",
   "config": {
    "editorHide": false
   },
   "dateStarted": "2023-06-11 15:23:53.791",
   "dateUpdated": "2023-06-11 15:24:03.421",
   "dateFinished": "2023-06-11 15:24:03.420",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+--------------------+--------------------+--------+----------+--------------+--------------+-------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+------------------+------------------+--------------------+-----------------------------+\n|         tipo_quarto|           rate_plan|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|        data_reserva|num_noites|Quantidade de quartos|ocupacao|adultos|criancas|bebes|   preco_euros|data_chegada|data_partida|       preco_noite|preco_noite_adulto|preco_noite_ocupacao|dif_data_chegada_data_reserva|\n+--------------------+--------------------+--------+----------+--------------+--------------+-------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+------------------+------------------+--------------------+-----------------------------+\n|      duplo standard|                 bar|     539|   1650596|      Portugal|     Registado|   2542|2023-01-05 11:01:...|         1|                    1|       1|      1|       0|    0|          48.0|  2023-02-04|  2023-02-05|              48.0|              48.0|                48.0|                           30|\n|      duplo standard|        mr main rate|     311|   1633608|      Portugal|     Registado|   1407|2022-11-29 22:31:...|         1|                    1|       2|      2|       0|    0|          63.7|  2023-01-27|  2023-01-28|              63.7|             31.85|               31.85|                           59|\n|duplo vista mar l...|              normal|     444|   1521134|      Portugal|    Modificada|   2074|2022-06-15 10:42:...|         1|                    1|       2|      2|       0|    0|         110.0|  2022-06-15|  2022-06-16|             110.0|              55.0|                55.0|                            0|\n|       twin standard|      non-refundable|     311|   1529352|      Portugal|     Registado|   1429|2022-06-26 17:21:...|         1|                    1|       2|      2|       0|    0|          98.0|  2022-08-03|  2022-08-04|              98.0|              49.0|                49.0|                           38|\n|      duplo standard|        main rate bb|     309|   1607432|      Portugal|  NãoRegistado|   1372|2022-10-13 07:09:...|         1|                    1|       2|      2|       0|    0|         52.92|  2022-10-14|  2022-10-15|             52.92|             26.46|               26.46|                            1|\n|               duplo|                  hb|      49|   1588112|      Alemanha|     Registado|     92|2022-09-13 10:17:...|         4|                    2|       2|      4|       0|    0|        2176.0|  2022-10-09|  2022-10-13|             544.0|             136.0|               272.0|                           26|\n|            superior|      non-refundable|     311|   1464089|        Canadá|     Registado|   2034|2022-04-01 15:37:...|         1|                    1|       2|      2|       0|    0|          70.2|  2022-04-02|  2022-04-03|              70.2|              35.1|                35.1|                            1|\n|        duplo deluxe|                 bar|     465|   1607872|   Reino Unido|     Registado|   2407|2022-10-13 16:26:...|         2|                    1|       2|      2|       0|    0|         200.0|  2023-02-01|  2023-02-03|             100.0|              50.0|                50.0|                          111|\n|      duplo standard|             website|     556|   1430853|      Portugal|     Registado|   2831|2022-02-04 14:30:...|         1|                    1|       2|      2|       0|    0|         104.5|  2022-02-19|  2022-02-20|             104.5|             52.25|               52.25|                           15|\n|       duplo confort|      non-refundable|     179|   1591874|      Portugal|     Registado|    630|2022-09-19 09:25:...|         2|                    1|       1|      1|       0|    0|         306.0|  2022-09-28|  2022-09-30|             153.0|             153.0|               153.0|                            9|\n|           duplotwin|      non-refundable|     416|   1642291|Estados Unidos|     Registado|   1967|2022-12-18 02:48:...|         2|                    1|       2|      2|       0|    0|         138.0|  2023-01-16|  2023-01-18|              69.0|              34.5|                34.5|                           29|\n|      duplo standard|        mr main rate|     309|   1672625|      Portugal|     Registado|   1372|2023-02-06 14:25:...|         3|                    1|       1|      1|       0|    0|        117.45|  2023-02-07|  2023-02-10|             39.15|             39.15|               39.15|                            1|\n|               suite|                 bar|     280|   1569883|       Espanha|     Registado|   2563|2022-08-16 20:48:...|         1|                    1|       2|      2|       0|    1|         158.0|  2022-08-17|  2022-08-18|             158.0|              79.0|                79.0|                            1|\n|                  t1|                 bar|     539|   1499613|      Portugal|    Confirmado|   2545|2022-05-18 19:52:...|         3|                    1|       1|      1|       0|    0|         345.0|  2022-07-06|  2022-07-09|             115.0|             115.0|               115.0|                           49|\n|      duplo standard|      non-refundable|     311|   1481180|        França|     Registado|   1407|2022-04-25 08:04:...|         1|                    1|       2|      2|       0|    0|          73.0|  2022-04-28|  2022-04-29|              73.0|              36.5|                36.5|                            3|\n|        twin confort|              normal|     179|   1453817|      Portugal|     Registado|    631|2022-03-17 22:44:...|         8|                    1|       2|      2|       0|    0|      1322.595|  2022-06-23|  2022-07-01|        165.324375|        82.6621875|          82.6621875|                           98|\n|               other|      non-refundable|     400|   1586271|       Holanda|     Registado|   1864|2022-09-10 12:10:...|         5|                    1|       2|      2|       0|    0|        366.08|  2022-10-21|  2022-10-26|            73.216|            36.608|              36.608|                           41|\n|      duplo standard|        mr main rate|     311|   1674346|         Japão|     Registado|   1407|2023-02-08 16:53:...|         1|                    1|       1|      1|       0|    0|         57.33|  2023-02-11|  2023-02-12|             57.33|             57.33|               57.33|                            3|\n|     duplo economico|                 bar|     503|   1688254|        Brasil|     Registado|   2785|2023-03-01 13:56:...|         1|                    1|       2|      2|       0|    0|          85.0|  2023-07-18|  2023-07-19|              85.0|              42.5|                42.5|                          139|\n|               duplo|      non-refundable|     322|   1484468|      Portugal|     Registado|   1413|2022-04-29 17:05:...|         2|                    1|       2|      2|       0|    0|         144.0|  2022-07-16|  2022-07-18|              72.0|              36.0|                36.0|                           78|\n|               duplo|             website|     535|   1436601|      Portugal|      Pendente|   2523|2022-02-15 10:46:...|         1|                    1|       2|      2|       0|    0|          58.5|  2022-02-16|  2022-02-17|              58.5|             29.25|               29.25|                            1|\n|               other|              normal|     391|   1696533|       Espanha|    Modificada|   1808|2023-03-13 12:42:...|         1|                    1|       2|      1|       0|    0|          60.0|  2023-03-20|  2023-03-21|              60.0|              60.0|                30.0|                            7|\n|      duplo standard|             website|     556|   1438998|      Portugal|      Pendente|   2831|2022-02-19 12:10:...|         1|                    1|       2|      2|       0|    0|         52.25|  2022-03-13|  2022-03-14|             52.25|            26.125|              26.125|                           22|\n|            bungalow|             website|     535|   1438180|      Portugal|      Pendente|   2783|2022-02-17 19:40:...|         1|                    1|       2|      2|       0|    0|          67.5|  2022-02-18|  2022-02-19|              67.5|             33.75|               33.75|                            1|\n|duplot duplo com ...|      non-refundable|     311|   1580180|    Luxemburgo|  NãoRegistado|   1946|2022-09-01 08:37:...|         1|                    1|       2|      2|       1|    0|115.7499999999|  2022-09-13|  2022-09-14|    115.7499999999|    57.87499999995|      57.87499999995|                           12|\n|               suite|                 bar|     465|   1436885|Estados Unidos|     Cancelado|   2408|2022-02-15 18:45:...|         1|                    1|       1|      1|       0|    0|         120.0|  2022-05-21|  2022-05-22|             120.0|             120.0|               120.0|                           95|\n|                  t1|             website|     482|   1579578|      Portugal|     Cancelado|   2285|2022-08-31 12:48:...|         7|                    1|       4|      4|       0|    0|         988.0|  2022-09-06|  2022-09-13|141.14285714285714|35.285714285714285|  35.285714285714285|                            6|\n|twin vista mar pa...|              normal|     444|   1707984|       Espanha|     Registado|   2386|2023-03-29 07:24:...|         5|                    1|       2|      2|       0|    0|         900.0|  2023-08-17|  2023-08-22|             180.0|              90.0|                90.0|                          141|\n|            standard|                 bar|      20|   1665467|      Portugal|    Modificada|     81|2023-01-26 19:02:...|         1|                    1|       2|      2|       0|    0|          62.0|  2023-01-27|  2023-01-28|              62.0|              31.0|                31.0|                            1|\n|          eco garden|      non-refundable|     514|   1574436|        França|     Registado|   2425|2022-08-23 21:03:...|         4|                    1|       1|      1|       0|    0|         486.0|  2022-09-20|  2022-09-24|             121.5|             121.5|               121.5|                           28|\n|              single|      non-refundable|     516|   1705334|      Portugal|     Cancelado|   2468|2023-03-25 17:35:...|         1|                    1|       1|      1|       0|    0| 44.9999999999|  2023-04-04|  2023-04-05|     44.9999999999|     44.9999999999|       44.9999999999|                           10|\n|      duplo standard|        main rate bb|     311|   1646562|      Portugal|  NãoRegistado|   1407|2022-12-28 15:03:...|         1|                    3|       1|      3|       0|    0|       194.445|  2023-01-05|  2023-01-06|           194.445|            64.815|             194.445|                            8|\n|                  t1|             website|     482|   1709066|      Portugal|     Registado|   2285|2023-03-30 14:15:...|         1|                    1|       2|      2|       0|    0|          41.8|  2023-03-31|  2023-04-01|              41.8|              20.9|                20.9|                            1|\n|     triplo standard|             website|     556|   1641857|      Portugal|      Pendente|   2833|2022-12-16 19:49:...|         1|                    1|       3|      3|       0|    0|          85.0|  2022-12-16|  2022-12-17|              85.0|28.333333333333332|  28.333333333333332|                            0|\n|       twin standard|        mr main rate|     310|   1564558|      Portugal|     Registado|   1424|2022-08-08 21:58:...|         1|                    1|       2|      2|       0|    0|          63.7|  2022-08-12|  2022-08-13|              63.7|             31.85|               31.85|                            4|\n|duplo vista mar l...|              normal|     444|   1680378|       Espanha|     Registado|   2074|2023-02-17 17:40:...|         3|                    1|       2|      2|       0|    0|         480.0|  2023-04-06|  2023-04-09|             160.0|              80.0|                80.0|                           48|\n|                  t2|             website|     482|   1503518|      Portugal|     Registado|   2286|2022-05-23 21:34:...|         2|                    1|       5|      5|       0|    0|         209.0|  2022-06-03|  2022-06-05|             104.5|              20.9|                20.9|                           11|\n|  duplo top mosteiro|      non-refundable|     378|   1651413|      Portugal|    Modificada|   1737|2023-01-06 15:12:...|         2|                    1|       2|      2|       0|    0|         187.8|  2023-01-18|  2023-01-20|              93.9|             46.95|               46.95|                           12|\n|              triplo|              normal|     444|   1615343|        França|     Registado|   2229|2022-10-26 08:49:...|         3|                    1|       3|      3|       0|    0|         270.0|  2022-12-09|  2022-12-12|              90.0|              30.0|                30.0|                           44|\n|       twin standard|      non-refundable|     310|   1456116|      Portugal|  NãoRegistado|   1424|2022-03-21 17:49:...|         2|                    1|       1|      1|       0|    0|         111.0|  2022-03-22|  2022-03-24|              55.5|              55.5|                55.5|                            1|\n|              studio|                  4n|     283|   1665607|        França|     Registado|   1241|2023-01-26 21:41:...|         4|                    1|       2|      2|       0|    0|         216.0|  2023-05-28|  2023-06-01|              54.0|              27.0|                27.0|                          122|\n|          eco garden|      non-refundable|     514|   1701684|        Canadá|     Registado|   2425|2023-03-20 17:02:...|         2|                    1|       2|      2|       0|    0|         225.0|  2023-05-18|  2023-05-20|             112.5|             56.25|               56.25|                           59|\n|      duplo standard|               promo|     311|   1470407|        França|  NãoRegistado|   1407|2022-04-08 19:37:...|         1|                    1|       2|      2|       0|    0|          49.5|  2022-04-21|  2022-04-22|              49.5|             24.75|               24.75|                           13|\n|               other| best available rate|     399|   1513682|      Portugal|     Registado|   1852|2022-06-05 23:54:...|         5|                    1|       2|      2|       1|    0|         510.0|  2022-06-12|  2022-06-17|             102.0|              51.0|                51.0|                            7|\n|            standard|               other|     259|   1424247|Estados Unidos|     Registado|   1103|2022-01-19 18:34:...|         3|                    1|       2|      2|       0|    0|        356.25|  2022-09-20|  2022-09-23|            118.75|            59.375|              59.375|                          244|\n|casal com wc priv...|      non-refundable|     494|   1589699|      Portugal|     Registado|   2326|2022-09-15 14:02:...|         3|                    1|       2|      2|       0|    0|         195.0|  2022-09-27|  2022-09-30|              65.0|              32.5|                32.5|                           12|\n|      duplo standard|                 bar|     539|   1442807|      Portugal|    Confirmado|   2542|2022-02-25 22:57:...|         2|                    1|       1|      1|       0|    0|         140.0|  2022-06-17|  2022-06-19|              70.0|              70.0|                70.0|                          112|\n|       duplo confort|              normal|     179|   1653999|        França|     Registado|    630|2023-01-10 15:11:...|         2|                    1|       2|      2|       0|    0|         331.1|  2023-04-14|  2023-04-16|            165.55|            82.775|              82.775|                           94|\n|   duplo wc exterior|         tarifa site|     304|   1618986|      Alemanha|    Modificada|   1357|2022-11-02 08:06:...|         1|                    1|       1|      2|       0|    0|         62.56|  2022-11-08|  2022-11-09|             62.56|             31.28|               62.56|                            6|\n|      duplo standard|        mr main rate|     310|   1654268|      Portugal|     Registado|   1395|2023-01-10 21:16:...|         1|                    1|       2|      2|       0|    0|          44.1|  2023-04-24|  2023-04-25|              44.1|             22.05|               22.05|                          104|\n|          individual|              normal|     314|   1452286|      Portugal|     Registado|   1428|2022-03-15 11:06:...|         1|                    1|       1|      1|       0|    0|          58.0|  2022-03-20|  2022-03-21|              58.0|              58.0|                58.0|                            5|\n|      duplo standard|      non-refundable|     309|   1420044|      Portugal|  NãoRegistado|   1372|2022-01-07 17:53:...|         1|                    1|       2|      2|       0|    0|          38.7|  2022-01-07|  2022-01-08|              38.7|             19.35|               19.35|                            0|\n|               duplo|melhor preo garan...|      49|   1629196|      Portugal|     Cancelado|     92|2022-11-21 16:15:...|         1|                    1|       2|      2|       0|    0|         100.0|  2022-11-23|  2022-11-24|             100.0|              50.0|                50.0|                            2|\n|      duplo standard|                 bar|     539|   1512335|      Portugal|     Registado|   2542|2022-06-03 21:58:...|         2|                    1|       1|      1|       0|    0|         140.0|  2022-06-04|  2022-06-06|              70.0|              70.0|                70.0|                            1|\n|      duplo standard|        db room only|     311|   1445251|       Polónia|     Registado|   1407|2022-03-02 14:58:...|         1|                    2|       1|      2|       0|    0|         128.0|  2022-03-10|  2022-03-11|             128.0|              64.0|               128.0|                            8|\n|    clssico standard|               other|     443|   1479657|      Portugal|     Registado|   2061|2022-04-22 20:42:...|         1|                    1|       2|      2|       0|    0|         143.0|  2022-04-25|  2022-04-26|             143.0|              71.5|                71.5|                            3|\n|                twin|             website|     535|   1528937|       Espanha|     Registado|   2524|2022-06-26 00:18:...|         1|                    1|       2|      2|       1|    0|         128.0|  2022-08-16|  2022-08-17|             128.0|              64.0|                64.0|                           51|\n|      duplo standard|        mr main rate|     311|   1640506|        Brasil|  NãoRegistado|   1407|2022-12-13 23:43:...|         1|                    1|       1|      1|       0|    0|          63.7|  2023-01-11|  2023-01-12|              63.7|              63.7|                63.7|                           29|\n|                twin|reembolsvel suple...|     322|   1558239|Estados Unidos|     Registado|   2259|2022-07-31 17:04:...|         2|                    1|       2|      2|       0|    0|         170.0|  2022-10-09|  2022-10-11|              85.0|              42.5|                42.5|                           70|\n|               duplo|              normal|     444|   1520694|      Portugal|     Registado|   2073|2022-06-14 19:13:...|         2|                    1|       2|      2|       0|    0|         200.0|  2022-06-16|  2022-06-18|             100.0|              50.0|                50.0|                            2|\n|                twin|              normal|     444|   1595897|      Portugal|     Registado|   2384|2022-09-25 17:16:...|         3|                    1|       2|      2|       0|    0|         300.0|  2022-10-01|  2022-10-04|             100.0|              50.0|                50.0|                            6|\n|                  t2|             website|     482|   1561009|      Portugal|     Registado|   2286|2022-08-03 22:50:...|         5|                    1|       4|      4|       0|    0|        688.75|  2022-09-09|  2022-09-14|            137.75|           34.4375|             34.4375|                           37|\n| duplo cama de casal|      non-refundable|     478|   1708027|   Reino Unido|     Registado|   2231|2023-03-29 09:12:...|         3|                    1|       2|      2|       0|    0|         180.0|  2023-11-06|  2023-11-09|              60.0|              30.0|                30.0|                          222|\n|      duplo standard|             website|     556|   1516607|      Portugal|      Pendente|   2831|2022-06-09 13:00:...|         2|                    1|       2|      2|       0|    0|        118.75|  2022-06-12|  2022-06-14|            59.375|           29.6875|             29.6875|                            3|\n|            standard|              normal|     259|   1669864|      Portugal|     Registado|   1103|2023-02-02 12:32:...|         1|                    1|       2|      2|       0|    0|         155.0|  2023-04-22|  2023-04-23|             155.0|              77.5|                77.5|                           79|\n|      duplo standard|                 bar|     426|   1629365|      Portugal|     Registado|   1995|2022-11-21 21:03:...|         1|                    1|       2|      2|       0|    0|          56.0|  2022-12-10|  2022-12-11|              56.0|              28.0|                28.0|                           19|\n|      duplo standard|             website|     556|   1475490|      Portugal|      Pendente|   2831|2022-04-16 17:47:...|         2|                    1|       2|      2|       0|    0|         165.3|  2022-04-23|  2022-04-25|             82.65|            41.325|              41.325|                            7|\n|           duplotwin|                 bar|     185|   1475080|        França|     Registado|    660|2022-04-15 19:56:...|         1|                    1|       2|      2|       0|    0|         139.0|  2022-07-17|  2022-07-18|             139.0|              69.5|                69.5|                           93|\n|               duplo|                 bar|     368|   1603122|      Alemanha|     Registado|   1668|2022-10-06 08:10:...|         3|                    1|       2|      2|       0|    0|         312.0|  2022-10-06|  2022-10-09|             104.0|              52.0|                52.0|                            0|\n|          eco garden|      non-refundable|     514|   1440387|   Reino Unido|     Cancelado|   2425|2022-02-21 18:22:...|         5|                    1|       2|      2|       0|    0|         540.0|  2022-06-01|  2022-06-06|             108.0|              54.0|                54.0|                          100|\n|duplot duplo com ...|      non-refundable|     311|   1687083|Estados Unidos|  NãoRegistado|   1946|2023-02-27 21:06:...|         1|                    1|       3|      3|       0|    0|146.7799999999|  2023-03-20|  2023-03-21|    146.7799999999| 48.92666666663334|   48.92666666663334|                           21|\n|      single confort|              normal|     179|   1721910|      Portugal|     Registado|    629|2023-04-16 19:17:...|         1|                    1|       1|      1|       0|    0|         103.5|  2023-04-17|  2023-04-18|             103.5|             103.5|               103.5|                            1|\n|            bungalow|             website|     535|   1421804|      Portugal|    Modificada|   2783|2022-01-12 18:01:...|         1|                    1|       2|      2|       0|    0|          67.5|  2022-01-12|  2022-01-13|              67.5|             33.75|               33.75|                            0|\n|       twin standard|                 bar|     426|   1551906|        França|     Registado|   1990|2022-07-25 14:27:...|         2|                    1|       2|      2|       0|    0|         190.0|  2022-07-31|  2022-08-02|              95.0|              47.5|                47.5|                            6|\n|s v vi vii vista mar|              normal|     313|   1544498|      Alemanha|     Registado|   1382|2022-07-17 13:16:...|         3|                    1|       2|      2|       0|    0|         720.0|  2022-08-25|  2022-08-28|             240.0|             120.0|               120.0|                           39|\n|      duplo standard|        main rate bb|     311|   1643721|        Itália|  NãoRegistado|   1407|2022-12-21 10:05:...|         1|                    1|       2|      2|       0|    0|        74.088|  2022-12-26|  2022-12-27|            74.088|            37.044|              37.044|                            5|\n|            familiar|clientes fidelizados|     349|   1495498|       Holanda|     Registado|   1553|2022-05-13 15:41:...|         3|                    1|       4|      4|       0|    0|         357.0|  2022-08-04|  2022-08-07|             119.0|             29.75|               29.75|                           83|\n|            standard|                 bar|      20|   1515292|        Brasil|     Registado|     81|2022-06-07 20:09:...|         7|                    1|       2|      2|       0|    0|         401.0|  2022-06-13|  2022-06-20|57.285714285714285|28.642857142857142|  28.642857142857142|                            6|\n|      duplo standard|        mr main rate|     310|   1642126|      Portugal|    Modificada|   1395|2022-12-17 16:03:...|         1|                    1|       2|      2|       0|    0|          44.1|  2022-12-17|  2022-12-18|              44.1|             22.05|               22.05|                            0|\n|     alojamento nisa|      non-refundable|     537|   1554048|      Portugal|     Registado|   2721|2022-07-26 23:02:...|         2|                    1|       2|      2|       0|    0|258.9999999999|  2022-08-22|  2022-08-24|   129.49999999995|   64.749999999975|     64.749999999975|                           27|\n|      duplo standard|        main rate bb|     310|   1663527|       Espanha|     Cancelado|   1397|2023-01-24 21:47:...|         4|                    1|       3|      3|       0|    0|       340.452|  2023-04-01|  2023-04-05|            85.113|            28.371|              28.371|                           67|\n|     triplo standard|             website|     556|   1696962|      Portugal|      Pendente|   2833|2023-03-13 21:32:...|         1|                    1|       3|      3|       0|    0|         102.0|  2023-03-25|  2023-03-26|             102.0|              34.0|                34.0|                           12|\n|            superior|      non-refundable|     311|   1518199|        França|  NãoRegistado|   2034|2022-06-11 19:36:...|         1|                    1|       2|      2|       0|    0|          78.0|  2022-06-24|  2022-06-25|              78.0|              39.0|                39.0|                           13|\n|               duplo|              normal|     444|   1516356|       Espanha|     Registado|   2073|2022-06-09 07:07:...|         5|                    1|       2|      2|       0|    0|         500.0|  2022-06-23|  2022-06-28|             100.0|              50.0|                50.0|                           14|\n|                  t1|      non-refundable|     482|   1574227|       Polónia|     Cancelado|   2285|2022-08-23 16:17:...|         4|                    2|       2|      4|       0|    0|        282.72|  2022-10-23|  2022-10-27|             70.68|             17.67|               35.34|                           61|\n|      duplo standard|        main rate bb|     310|   1625953|      Portugal|    Modificada|   1395|2022-11-15 13:49:...|         1|                    3|       2|      6|       0|    0|       177.282|  2022-11-15|  2022-11-16|           177.282|            29.547|              88.641|                            0|\n|               duplo|      non-refundable|     415|   1573762|        França|     Registado|   1940|2022-08-22 22:02:...|         1|                    1|       2|      2|       0|    0|          96.0|  2022-08-23|  2022-08-24|              96.0|              48.0|                48.0|                            1|\n|       twin standard|                twin|     311|   1476879|     Singapura|     Cancelado|   1429|2022-04-19 04:14:...|         1|                    1|       2|      2|       0|    0|          74.0|  2022-05-27|  2022-05-28|              74.0|              37.0|                37.0|                           38|\n|      duplo standard|             website|     556|   1694643|        Brasil|      Pendente|   2831|2023-03-10 15:28:...|         2|                    1|       2|      2|       0|    0|         187.0|  2023-03-10|  2023-03-12|              93.5|             46.75|               46.75|                            0|\n|                twin|             website|     335|   1453818|Estados Unidos|     Registado|   1494|2022-03-17 22:46:...|         1|                    1|       3|      3|       0|    0|          95.0|  2022-08-19|  2022-08-20|              95.0|31.666666666666668|  31.666666666666668|                          155|\n|               suite|                 bar|     465|   1447279|       Bélgica|     Registado|   2408|2022-03-06 15:01:...|         1|                    1|       3|      3|       0|    1|         150.0|  2022-04-08|  2022-04-09|             150.0|              50.0|                50.0|                           33|\n|                  t1|             website|     453|   1542803|       Arménia|     Cancelado|   2117|2022-07-14 16:17:...|         1|                    1|       1|      1|       0|    0|          45.0|  2022-07-17|  2022-07-18|              45.0|              45.0|                45.0|                            3|\n|            familiar|              normal|     179|   1453840|       Espanha|     Registado|   1765|2022-03-17 23:41:...|         1|                    1|       3|      3|       1|    0|        157.14|  2022-03-19|  2022-03-20|            157.14|52.379999999999995|  52.379999999999995|                            2|\n|                  t1|             website|     482|   1610031|      Portugal|     Registado|   2285|2022-10-17 10:06:...|         4|                    3|       1|      3|       0|    0|         581.4|  2022-10-19|  2022-10-23|            145.35|48.449999999999996|              145.35|                            2|\n|               duplo|         tarifa site|     304|   1667238|      Alemanha|    Modificada|   1352|2023-01-29 16:53:...|         1|                    1|       2|      2|       0|    0|          73.6|  2023-09-18|  2023-09-19|              73.6|              36.8|                36.8|                          232|\n|              studio|                 bar|     493|   1427682|      Portugal|     Registado|   2324|2022-01-28 12:13:...|         1|                    1|       2|      2|       0|    0|          55.0|  2022-01-30|  2022-01-31|              55.0|              27.5|                27.5|                            2|\n|       twin standard|               promo|     311|   1442044|       Espanha|     Registado|   1429|2022-02-24 16:29:...|         1|                    1|       2|      2|       0|    0|          59.0|  2022-04-09|  2022-04-10|              59.0|              29.5|                29.5|                           44|\n|      duplo standard|        mr main rate|     311|   1643994|      Portugal|     Registado|   1407|2022-12-21 20:20:...|         1|                    1|       2|      2|       0|    0|          63.7|  2022-12-21|  2022-12-22|              63.7|             31.85|               31.85|                            0|\n|                twin|reembolsvel suple...|     322|   1626661|      Portugal|     Registado|   2259|2022-11-16 18:26:...|         1|                    1|       1|      1|       0|    0|          67.0|  2022-12-09|  2022-12-10|              67.0|              67.0|                67.0|                           23|\n|      duplo standard|        mr main rate|     310|   1627035|      Portugal|  NãoRegistado|   1397|2022-11-17 14:03:...|         1|                    1|       2|      2|       0|    0|         61.74|  2022-11-17|  2022-11-18|             61.74|             30.87|               30.87|                            0|\n+--------------------+--------------------+--------+----------+--------------+--------------+-------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+------------------+------------------+--------------------+-----------------------------+\nonly showing top 100 rows\n\n24955\nimport org.apache.spark.sql.DataFrame\nimport org.apache.spark.sql.functions._\nimport spark.implicits._\n\u001b[1m\u001b[34mjoinFolder\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /data/joins\n\u001b[1m\u001b[34msaveJoins\u001b[0m: \u001b[1m\u001b[32mBoolean\u001b[0m = false\n\u001b[1m\u001b[34msaveDataFrame\u001b[0m: \u001b[1m\u001b[32m(df: org.apache.spark.sql.DataFrame, name: String)Unit\u001b[0m\n\u001b[1m\u001b[34minitialCount\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [tipo_quarto: string, rate_plan: string ... 19 more fields]\n"
     }
    ]
   }
  },
  {
   "user": "anonymous",
   "config": {
    "colWidth": 12,
    "fontSize": 9,
    "enabled": true,
    "results": {},
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "editorMode": "ace/mode/scala"
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Quantidade de quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "jobName": "paragraph_1563110258183_1613653816",
   "id": "20190714-161738_1950435706",
   "dateCreated": "2019-07-14T16:17:38+0300",
   "status": "FINISHED",
   "progressUpdateIntervalMs": 500,
   "focus": true,
   "$$hashKey": "object:394",
   "text": "val joinTipologia = spark.sql(\n    \"\"\"\n       SELECT DISTINCT \n           Q.hotel_ID, \n           Q.Reserve_ID,\n           Q.pais,\n           Q.estado_reserva,\n           Q.room_ID,\n           Q.tipo_quarto AS Q_tipo_quarto,\n           Q.rate_plan,\n           Q.data_reserva,\n           Q.data_chegada,\n           Q.data_partida,\n           Q.num_noites,\n           Q.ocupacao,\n           Q.adultos,\n           Q.criancas,\n           Q.bebes,\n           Q.preco_euros,\n           Q.preco_noite,\n           Q.preco_noite_adulto,\n           Q.preco_noite_ocupacao,\n           Q.dif_data_chegada_data_reserva,        \n           T.tipo_quarto as T_tipo_quarto, \n           T.quantidade,\n           T.capacidade_maxima,\n           T.capacidade_max_adultos,\n           T.capacidade_max_criancas,\n           T.capacidade_max_bebes\n       FROM QuartosReservados as Q\n       Inner JOIN Tipologias as T\n           ON Q.hotel_ID = T.hotel_ID AND T.room_ID = Q.room_ID\n      \"\"\")\n\nval joinTipologiaNotExists = spark.sql(\n    \"\"\"\n        SELECT *\n        FROM QuartosReservados\n        WHERE NOT EXISTS (\n           SELECT *\n           FROM Tipologias\n           WHERE QuartosReservados.hotel_ID = Tipologias.hotel_ID AND \n           QuartosReservados.room_ID = Tipologias.room_ID\n        )\n      \"\"\")\njoinTipologiaNotExists.show();\n\n\njoinTipologia.createOrReplaceTempView(\"JoinTipologia\")\njoinTipologia.cache()\n\nif (saveJoins)\n    saveDataFrame(joinTipologia, \"joinTipologia\")\n\nprintln(joinTipologia.count())\njoinTipologia.printSchema()",
   "dateStarted": "2023-06-11 15:24:03.422",
   "dateUpdated": "2023-06-11 15:24:10.577",
   "dateFinished": "2023-06-11 15:24:10.577",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+-------------+---------+--------+----------+--------+--------------+-------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+-----------------+------------------+--------------------+-----------------------------+\n|  tipo_quarto|rate_plan|hotel_ID|Reserve_ID|    pais|estado_reserva|room_ID|        data_reserva|num_noites|Quantidade de quartos|ocupacao|adultos|criancas|bebes|   preco_euros|data_chegada|data_partida|      preco_noite|preco_noite_adulto|preco_noite_ocupacao|dif_data_chegada_data_reserva|\n+-------------+---------+--------+----------+--------+--------------+-------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+-----------------+------------------+--------------------+-----------------------------+\n|twin standard|    promo|     309|   1438425|Portugal|    Modificada|   2802|2022-02-18 10:48:...|         1|                    1|       2|      2|       0|    0|          38.7|  2022-02-19|  2022-02-20|             38.7|             19.35|               19.35|                            1|\n|twin standard|    promo|     309|   1441490|Portugal|     Cancelado|   2802|2022-02-23 16:10:...|         1|                    1|       2|      2|       0|    0|          43.0|  2022-02-23|  2022-02-24|             43.0|              21.5|                21.5|                            0|\n|twin standard|    promo|     309|   1441490|Portugal|     Cancelado|   2802|2022-02-23 16:10:...|         1|                    1|       2|      2|       0|    0|          43.0|  2022-03-19|  2022-03-20|             43.0|              21.5|                21.5|                           24|\n|twin standard|    promo|     309|   1440314| Espanha|  NãoRegistado|   2802|2022-02-21 16:44:...|         3|                    1|       2|      2|       0|    0|128.9999999999|  2022-02-22|  2022-02-25|42.99999999996667|21.499999999983334|  21.499999999983334|                            1|\n|twin standard|    promo|     309|   1442562|Portugal|     Cancelado|   2802|2022-02-25 16:06:...|         1|                    1|       2|      2|       0|    0|          43.0|  2022-02-25|  2022-02-26|             43.0|              21.5|                21.5|                            0|\n|twin standard|    promo|     309|   1441186|Portugal|     Registado|   2802|2022-02-22 22:43:...|         1|                    1|       2|      2|       0|    0|          43.0|  2022-02-26|  2022-02-27|             43.0|              21.5|                21.5|                            4|\n|twin standard|    promo|     309|   1438484|Portugal|    Modificada|   2802|2022-02-18 12:14:...|         3|                    1|       2|      2|       0|    0|128.9999999999|  2022-02-18|  2022-02-21|42.99999999996667|21.499999999983334|  21.499999999983334|                            0|\n|twin standard|    promo|     309|   1444879|Portugal|     Registado|   2802|2022-03-01 21:17:...|         2|                    1|       2|      2|       0|    0| 77.3999999999|  2022-03-11|  2022-03-13|   38.69999999995|   19.349999999975|     19.349999999975|                           10|\n+-------------+---------+--------+----------+--------+--------------+-------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+-----------------+------------------+--------------------+-----------------------------+\n\n24947\nroot\n |-- hotel_ID: integer (nullable = true)\n |-- Reserve_ID: integer (nullable = true)\n |-- pais: string (nullable = true)\n |-- estado_reserva: string (nullable = true)\n |-- room_ID: integer (nullable = true)\n |-- Q_tipo_quarto: string (nullable = true)\n |-- rate_plan: string (nullable = true)\n |-- data_reserva: timestamp (nullable = true)\n |-- data_chegada: date (nullable = true)\n |-- data_partida: date (nullable = true)\n |-- num_noites: integer (nullable = true)\n |-- ocupacao: integer (nullable = true)\n |-- adultos: integer (nullable = true)\n |-- criancas: integer (nullable = true)\n |-- bebes: integer (nullable = true)\n |-- preco_euros: double (nullable = true)\n |-- preco_noite: double (nullable = true)\n |-- preco_noite_adulto: double (nullable = true)\n |-- preco_noite_ocupacao: double (nullable = true)\n |-- dif_data_chegada_data_reserva: integer (nullable = true)\n |-- T_tipo_quarto: string (nullable = true)\n |-- quantidade: integer (nullable = true)\n |-- capacidade_maxima: integer (nullable = true)\n |-- capacidade_max_adultos: integer (nullable = true)\n |-- capacidade_max_criancas: integer (nullable = true)\n |-- capacidade_max_bebes: integer (nullable = true)\n\n\u001b[1m\u001b[34mjoinTipologia\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 24 more fields]\n\u001b[1m\u001b[34mjoinTipologiaNotExists\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [tipo_quarto: string, rate_plan: string ... 19 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {},
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinTipologiaAndHotel = spark.sql(\n    \"\"\"\n       SELECT \n           J.*,\n           H.localizacao,\n           H.area_localizacao,\n           H.estrelas,\n           H.idade_max_criancas,\n           H.idade_max_bebes,\n           H.hora_max_checkin,\n           H.qtd_quartos\n       FROM joinTipologia as J\n       INNER JOIN Hotel as H\n           ON J.hotel_ID = H.hotel_ID\n    \"\"\")\n\njoinTipologiaAndHotel.createOrReplaceTempView(\"JoinTipologiaAndHotel\")\n\nprintln(joinTipologiaAndHotel.count())\n//joinTipologiaAndHotel.printSchema()\nif (saveJoins)\n    saveDataFrame(joinTipologiaAndHotel, \"joinTipologiaAndHotel\")",
   "id": "",
   "dateCreated": "2023-04-30 20:01:48.781",
   "config": {
    "tableHide": false
   },
   "dateStarted": "2023-06-11 15:24:10.578",
   "dateUpdated": "2023-06-11 15:24:14.584",
   "dateFinished": "2023-06-11 15:24:14.584",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n\u001b[1m\u001b[34mjoinTipologiaAndHotel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 31 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {},
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": false
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinFeriados = spark.sql(\n    \"\"\"\n        SELECT J.*, F.is_holiday\n        FROM JoinTipologiaAndHotel AS J\n        LEFT JOIN (SELECT * FROM Feriados WHERE is_holiday=1) AS F\n            ON F.date <= J.data_partida AND f.date >= data_chegada\n    \"\"\"\n)\njoinFeriados = joinFeriados.na.fill(0, Seq(\"is_holiday\"))\n\njoinFeriados.createOrReplaceTempView(\"JoinFeriados\")\n\nprintln(joinFeriados.count())\n\njoinFeriados.show()",
   "id": "",
   "dateCreated": "2023-04-30 20:12:14.191",
   "config": {
    "tableHide": false
   },
   "dateStarted": "2023-06-11 15:24:14.587",
   "dateUpdated": "2023-06-11 15:24:19.802",
   "dateFinished": "2023-06-11 15:24:19.802",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "25213\n+--------+----------+--------------+--------------+-------+----------------+----------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|   Q_tipo_quarto|       rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|   preco_euros|       preco_noite|preco_noite_adulto|preco_noite_ocupacao|dif_data_chegada_data_reserva|       T_tipo_quarto|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|\n+--------+----------+--------------+--------------+-------+----------------+----------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\n|     443|   1527679|      Portugal|     Registado|   2061|clssico standard|          normal|2022-06-23 22:16:...|  2022-06-26|  2022-06-27|         1|       2|      2|       0|    0|         193.0|             193.0|              96.5|                96.5|                            3|   Clássico Standard|        18|                2|                     2|                      0|                   0|             Cascais|      Carcavelos|       5|                12|             24|2023-06-11 23:59:00|         42|         0|\n|     516|   1471872|      Portugal|     Registado|   2488|           other|             bar|2022-04-11 00:24:...|  2022-04-11|  2022-04-12|         1|       2|      2|       0|    0|          45.0|              45.0|              22.5|                22.5|                            0|Temático 1001 Noites|         1|                2|                     2|                      0|                   0|            Portimão|           Lagos|       2|                12|             36|2023-06-11 23:00:00|         32|         0|\n|     444|   1606553|      Portugal|     Registado|   2229|          triplo|          normal|2022-10-11 18:47:...|  2022-11-11|  2022-11-13|         2|       2|      2|       0|    0|         200.0|             100.0|              50.0|                50.0|                           31|              Triplo|         5|                3|                     3|                      2|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|\n|     482|   1619729|      Portugal|     Registado|   2286|              t2|  non-refundable|2022-11-03 13:12:...|  2022-11-04|  2022-11-06|         2|       6|     12|       0|    0|265.0399999998|    132.5199999999|   11.043333333325|      22.08666666665|                            1|      Apartamento T2|        43|                6|                     6|                      5|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-06-11 23:59:00|        143|         0|\n|     444|   1471609|      Portugal|     Registado|   2077|        familiar|          normal|2022-04-10 17:35:...|  2022-04-14|  2022-04-16|         2|       2|      2|       1|    1|         300.0|             150.0|              75.0|                75.0|                            4|            Familiar|         4|                4|                     2|                      3|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         1|\n|     319|   1703653|      Portugal|     Registado|   2264|        standard|          normal|2023-03-23 09:44:...|  2023-07-23|  2023-07-26|         3|       2|      2|       0|    0|         222.0|              74.0|              37.0|                37.0|                          122|            Standard|        18|                2|                     2|                      0|                   0|              Aveiro|          Aveiro|       3|                12|             24|2023-06-11 23:59:00|         96|         0|\n|     546|   1581054|       Espanha|     Registado|   2682|           duplo|  non-refundable|2022-09-02 12:05:...|  2022-09-05|  2022-09-09|         4|       1|      2|       0|    0|        689.92|            172.48|             86.24|              172.48|                            3|        Quarto Duplo|         9|                2|                     2|                      0|                   0|                Alte|       Albufeira|       0|                12|             24|2023-06-11 17:00:00|          9|         0|\n|     310|   1625677|      Portugal|    Modificada|   1674|        superior|    mr main rate|2022-11-14 22:08:...|  2022-11-17|  2022-11-20|         3|       2|      2|       0|    0|        158.76|52.919999999999995|26.459999999999997|  26.459999999999997|                            3|Quarto Twin Superior|         8|                2|                     2|                      1|                   0|                Gaia|           Porto|       3|                 0|              0|2023-06-11 23:59:00|        192|         0|\n|     444|   1623430|       Espanha|     Registado|   2384|            twin|          normal|2022-11-10 10:21:...|  2022-12-04|  2022-12-06|         2|       1|      2|       0|    0|         280.0|             140.0|              70.0|               140.0|                           24|                Twin|        24|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|\n|     535|   1613745|      Portugal|      Pendente|   2523|           duplo|         website|2022-10-23 13:16:...|  2022-10-29|  2022-10-30|         1|       2|      2|       0|    0|          90.0|              90.0|              45.0|                45.0|                            6|        Quarto Duplo|         5|                3|                     2|                      1|                   1| Travanca do Mondego|         Coimbra|       4|                12|             24|2023-06-11 23:55:00|         11|         0|\n|     309|   1566663|      Portugal|    Modificada|   2254|        superior|semi flexivel bb|2022-08-11 18:57:...|  2022-08-19|  2022-08-22|         3|       2|      2|       0|    0|       196.425| 65.47500000000001|32.737500000000004|  32.737500000000004|                            8|Quarto Duplo Supe...|         8|                2|                     2|                      1|                   0|             Valongo|           Porto|       3|                12|              4|2023-06-11 23:59:00|         41|         0|\n|     311|   1610542|       Espanha|  NãoRegistado|   1407|  duplo standard|    main rate bb|2022-10-17 20:40:...|  2022-10-31|  2022-11-01|         1|       2|      2|       0|    0|          98.0|              98.0|              49.0|                49.0|                           14|DB - Quarto Duplo...|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|\n|     414|   1517196|   Reino Unido|     Registado|   2050|           other|          normal|2022-06-10 08:59:...|  2022-09-23|  2022-09-24|         1|       2|      2|       0|    0|         100.0|             100.0|              50.0|                50.0|                          105|Duplo Vista Interior|         3|                3|                     2|                      1|                   1|São Martinho do P...|        Alcobaça|       3|                12|             36|2023-06-11 23:30:00|         30|         0|\n|     514|   1496048|Estados Unidos|     Cancelado|   2425|      eco garden|  non-refundable|2022-05-14 13:05:...|  2022-05-30|  2022-06-05|         6|       1|      1|       0|    0|         648.0|             108.0|             108.0|               108.0|                           16|     Eco Garden Room|         4|                2|                     2|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-06-11 18:00:00|         13|         0|\n|     311|   1646551|       Espanha|    Modificada|   1407|  duplo standard|    mr main rate|2022-12-28 14:44:...|  2022-12-28|  2022-12-29|         1|       2|      2|       0|    0|          63.7|              63.7|             31.85|               31.85|                            0|DB - Quarto Duplo...|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         0|\n|     319|   1614242|        Brasil|     Registado|   2877|        familiar|          normal|2022-10-24 11:43:...|  2023-01-01|  2023-01-02|         1|       2|      2|       1|    0|         102.5|             102.5|             51.25|               51.25|                           69|     Quarto Familiar|         5|                3|                     3|                      1|                   1|              Aveiro|          Aveiro|       3|                12|             24|2023-06-11 23:59:00|         96|         1|\n|     358|   1510690|       Espanha|     Registado|   1771|           suite|             bar|2022-06-01 19:16:...|  2022-06-02|  2022-06-04|         2|       2|      2|       0|    0|         500.0|             250.0|             125.0|               125.0|                            1|         Suite Canto|         1|                2|                     2|                      1|                   1|               Porto|           Porto|       0|                12|              2|2023-06-11 23:59:00|         10|         0|\n|     495|   1711907|      Portugal|     Registado|   2335|            twin|           promo|2023-04-03 10:14:...|  2023-04-24|  2023-04-25|         1|       2|      2|       0|    0|          95.0|              95.0|              47.5|                47.5|                           21|        Quarto Twin |         1|                2|                     2|                      1|                   2|        Vale do Peso|  Castelo Branco|       0|                 0|              0|2023-06-11 12:00:00|         10|         1|\n|     358|   1578165|   Reino Unido|     Registado|   1772|           suite|             bar|2022-08-29 14:24:...|  2022-09-29|  2022-10-02|         3|       2|      2|       0|    0|         834.0|             278.0|             139.0|               139.0|                           31|Suite com Vista C...|         1|                2|                     2|                      1|                   1|               Porto|           Porto|       0|                12|              2|2023-06-11 23:59:00|         10|         0|\n|     539|   1432632|      Portugal|     Cancelado|   2545|              t1|             bar|2022-02-08 11:26:...|  2022-02-18|  2022-02-20|         2|       1|      1|       0|    0|          96.0|              48.0|              48.0|                48.0|                           10|            Villa T1|         1|                4|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-06-11 18:00:00|         58|         0|\n+--------+----------+--------------+--------------+-------+----------------+----------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinFeriados\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 32 more fields]\njoinFeriados: org.apache.spark.sql.DataFrame = [hotel_ID: int, Reserve_ID: int ... 32 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinFeriadosGrouped = spark.sql(\n    \"\"\"\n        SELECT \n            hotel_ID,  Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros,preco_noite,preco_noite_adulto,preco_noite_ocupacao, dif_data_chegada_data_reserva, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, max(is_holiday) AS is_holiday\n        FROM JoinFeriados\n        GROUP BY hotel_ID, Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros,preco_noite,preco_noite_adulto,preco_noite_ocupacao, dif_data_chegada_data_reserva, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos\n    \"\"\"\n)\n   \njoinFeriadosGrouped.createOrReplaceTempView(\"JoinFeriadosGrouped\")\n\nprintln(joinFeriadosGrouped.count())\njoinFeriadosGrouped.show()",
   "id": "",
   "dateCreated": "2023-05-16 20:45:38.018",
   "config": {},
   "dateStarted": "2023-06-11 15:24:19.802",
   "dateUpdated": "2023-06-11 15:24:31.745",
   "dateFinished": "2023-06-11 15:24:31.745",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|     rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|   preco_euros|       preco_noite|preco_noite_adulto|preco_noite_ocupacao|dif_data_chegada_data_reserva|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\n|     311|   1610542|       Espanha|  NãoRegistado|   1407|      duplo standard|DB - Quarto Duplo...|  main rate bb|2022-10-17 20:40:...|  2022-10-31|  2022-11-01|         1|       2|      2|       0|    0|          98.0|              98.0|              49.0|                49.0|                           14|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|\n|     311|   1539749|        França|     Registado|   1407|      duplo standard|DB - Quarto Duplo...|non-refundable|2022-07-10 18:57:...|  2022-08-11|  2022-08-12|         1|       2|      2|       0|    0|          83.0|              83.0|              41.5|                41.5|                           32|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         0|\n|     559|   1575104|      Portugal|     Registado|   2862|         apartamento|         Apartamento|           bar|2022-08-24 19:34:...|  2022-09-04|  2022-09-07|         3|       2|      2|       0|    0|         546.0|             182.0|              91.0|                91.0|                           11|         3|                3|                     2|                      1|                   1|    Benafim|       Albufeira|       0|                11|             36|2023-06-11 18:00:00|         15|         0|\n|     311|   1464163|      Portugal|  NãoRegistado|   1407|      duplo standard|DB - Quarto Duplo...|         promo|2022-04-01 16:59:...|  2022-04-16|  2022-04-17|         1|       2|      2|       0|    0|          49.5|              49.5|             24.75|               24.75|                           15|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|\n|     309|   1668585|      Portugal|     Cancelado|   1372|      duplo standard|Quarto Duplo Stan...|  mr main rate|2023-01-31 15:22:...|  2023-03-03|  2023-03-05|         2|       2|      2|       0|    0|          88.2|              44.1|             22.05|               22.05|                           31|        10|                2|                     2|                      1|                   0|    Valongo|           Porto|       3|                12|              4|2023-06-11 23:59:00|         41|         0|\n|     310|   1573582|      Portugal|     Registado|   1674|            superior|Quarto Twin Superior|non-refundable|2022-08-22 18:21:...|  2022-08-27|  2022-08-29|         2|       1|      1|       0|    0|        138.15|            69.075|            69.075|              69.075|                            5|         8|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-06-11 23:59:00|        192|         0|\n|     556|   1631879|      Portugal|     Registado|   2831|      duplo standard|Double Room Standard|       website|2022-11-26 19:51:...|  2022-11-27|  2022-11-28|         1|       2|      2|       0|    0|          57.0|              57.0|              28.5|                28.5|                            1|        45|                3|                     2|                      0|                   1|    Covilhã|  Castelo Branco|       3|                10|              3|2023-06-11 23:00:00|         84|         0|\n|     494|   1441498|      Portugal|     Registado|   2383|twin com wc priva...|Quarto twin Com W...|           bar|2022-02-23 16:24:...|  2022-02-24|  2022-02-25|         1|       2|      2|       0|    0|          55.0|              55.0|              27.5|                27.5|                            1|         1|                2|                     2|                      1|                   1|     Lisboa|       Carnaxide|       0|                 0|              0|2023-06-11 12:00:00|          6|         0|\n|     444|   1522331|       Espanha|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|        normal|2022-06-16 18:02:...|  2022-07-08|  2022-07-09|         1|       2|      2|       0|    0|         130.0|             130.0|              65.0|                65.0|                           22|         5|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|\n|     482|   1610762|      Portugal|     Registado|   2285|                  t1|      Apartamento T1|       website|2022-10-18 08:21:...|  2022-10-18|  2022-10-19|         1|       2|      4|       0|    0|          96.9|              96.9|            24.225|               48.45|                            0|        90|                4|                     4|                      3|                   1|   Portimão|           Lagos|       4|                 3|             36|2023-06-11 23:59:00|        143|         0|\n|     311|   1550994|       Holanda|     Registado|   1407|      duplo standard|DB - Quarto Duplo...|non-refundable|2022-07-24 10:52:...|  2022-08-01|  2022-08-02|         1|       2|      2|       0|    0|         80.75|             80.75|            40.375|              40.375|                            8|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         0|\n|     328|   1718730|        França|     Registado|   2813|               other|Interior Double Room|       website|2023-04-12 14:11:...|  2023-08-15|  2023-08-18|         3|       2|      2|       0|    0|        189.24|63.080000000000005|31.540000000000003|  31.540000000000003|                          125|         3|                2|                     2|                      0|                   0|     Lisboa|       Carnaxide|       0|                 0|              0|2023-06-11 22:00:00|         56|         1|\n|     392|   1489614|        França|     Registado|   1801|       duplo ou twin|QUARTO DUPLO OU T...|         promo|2022-05-06 14:29:...|  2022-09-04|  2022-09-08|         4|       2|      2|       0|    0|         505.4|            126.35|            63.175|              63.175|                          121|         6|                3|                     3|                      0|                   1|      Olhão|       Albufeira|       4|                11|             24|2023-06-11 23:30:00|         19|         0|\n|     179|   1698235|      Portugal|     Registado|    630|       duplo confort|      Duplo  Comfort|non-refundable|2023-03-15 16:50:...|  2023-04-12|  2023-04-15|         3|       2|      2|       0|    0|        375.84|125.27999999999999| 62.63999999999999|   62.63999999999999|                           28|        27|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-06-11 23:59:00|        132|         0|\n|     537|   1580996|       Espanha|     Cancelado|   2719|               other|    Alojamento Alter|non-refundable|2022-09-02 10:27:...|  2022-09-04|  2022-09-05|         1|       2|      2|       0|    0|129.4999999999|    129.4999999999|    64.74999999995|      64.74999999995|                            2|         1|                2|                     2|                      0|                   0|Campo Maior|     Campo Maior|       0|                12|             36|2023-06-11 14:00:00|         13|         0|\n|     444|   1670868|Estados Unidos|     Registado|   2073|               duplo|              Duplo |        normal|2023-02-03 19:12:...|  2023-02-05|  2023-02-06|         1|       2|      4|       0|    0|         140.0|             140.0|              35.0|                70.0|                            2|        14|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|\n|     310|   1624658|Estados Unidos|  NãoRegistado|   1395|      duplo standard|Quarto Duplo Stan...|  mr main rate|2022-11-12 19:42:...|  2022-11-24|  2022-11-26|         2|       2|      2|       0|    0|          98.0|              49.0|              24.5|                24.5|                           12|        10|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-06-11 23:59:00|        192|         0|\n|     444|   1667749|      Portugal|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|        normal|2023-01-30 11:15:...|  2023-02-03|  2023-02-05|         2|       2|      2|       0|    0|         160.0|              80.0|              40.0|                40.0|                            4|         5|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|\n|     504|   1446302|      Portugal|     Registado|   2378|        cela sculare|       Cela Sæculare|           bar|2022-03-04 12:37:...|  2022-03-05|  2022-03-06|         1|       2|      6|       0|    0|       218.025|           218.025|           36.3375|            109.0125|                            1|        13|                2|                     2|                      0|                   1|     Monção|          Monção|       4|                12|             36|2023-06-11 23:59:00|         27|         0|\n|     511|   1457653|Estados Unidos|     Registado|   2394|       duplo ou twin|Quarto Duplo ou Twin|      standard|2022-03-23 19:26:...|  2022-03-23|  2022-03-24|         1|       2|      2|       0|    0|          75.0|              75.0|              37.5|                37.5|                            0|         6|                3|                     3|                      1|                   1|     Sagres|           Lagos|       0|                12|             36|2023-06-11 20:00:00|         16|         0|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinFeriadosGrouped\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 32 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {},
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Location",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "Event",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "start_Date",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "end_date",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "val joinEventos = spark.sql(\n    \"\"\"\n        SELECT QR.*, E.*\n        FROM JoinFeriadosGrouped QR\n        LEFT JOIN Eventos E\n            ON QR.data_partida >= E.start_Date AND QR.data_chegada <= E.end_date\n            AND QR.area_localizacao = E.Location\n    \"\"\")\n\njoinEventos.createOrReplaceTempView(\"JoinEventos\")\n\nprintln(joinEventos.count())\njoinEventos.show()",
   "id": "",
   "dateCreated": "2023-04-30 20:16:51.675",
   "config": {},
   "dateStarted": "2023-06-11 15:24:31.747",
   "dateUpdated": "2023-06-11 15:24:40.509",
   "dateFinished": "2023-06-11 15:24:40.509",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24961\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+---------+--------------------+----------+----------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|     rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|   preco_euros|       preco_noite|preco_noite_adulto|preco_noite_ocupacao|dif_data_chegada_data_reserva|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday| Location|               Event|start_Date|  end_date|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+---------+--------------------+----------+----------+\n|     311|   1610542|       Espanha|  NãoRegistado|   1407|      duplo standard|DB - Quarto Duplo...|  main rate bb|2022-10-17 20:40:...|  2022-10-31|  2022-11-01|         1|       2|      2|       0|    0|          98.0|              98.0|              49.0|                49.0|                           14|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|     null|                null|      null|      null|\n|     311|   1539749|        França|     Registado|   1407|      duplo standard|DB - Quarto Duplo...|non-refundable|2022-07-10 18:57:...|  2022-08-11|  2022-08-12|         1|       2|      2|       0|    0|          83.0|              83.0|              41.5|                41.5|                           32|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         0|     null|                null|      null|      null|\n|     559|   1575104|      Portugal|     Registado|   2862|         apartamento|         Apartamento|           bar|2022-08-24 19:34:...|  2022-09-04|  2022-09-07|         3|       2|      2|       0|    0|         546.0|             182.0|              91.0|                91.0|                           11|         3|                3|                     2|                      1|                   1|    Benafim|       Albufeira|       0|                11|             36|2023-06-11 18:00:00|         15|         0|     null|                null|      null|      null|\n|     311|   1464163|      Portugal|  NãoRegistado|   1407|      duplo standard|DB - Quarto Duplo...|         promo|2022-04-01 16:59:...|  2022-04-16|  2022-04-17|         1|       2|      2|       0|    0|          49.5|              49.5|             24.75|               24.75|                           15|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|     null|                null|      null|      null|\n|     309|   1668585|      Portugal|     Cancelado|   1372|      duplo standard|Quarto Duplo Stan...|  mr main rate|2023-01-31 15:22:...|  2023-03-03|  2023-03-05|         2|       2|      2|       0|    0|          88.2|              44.1|             22.05|               22.05|                           31|        10|                2|                     2|                      1|                   0|    Valongo|           Porto|       3|                12|              4|2023-06-11 23:59:00|         41|         0|    Porto| Fantasporto - In...|2023-02-28|2023-03-12|\n|     310|   1573582|      Portugal|     Registado|   1674|            superior|Quarto Twin Superior|non-refundable|2022-08-22 18:21:...|  2022-08-27|  2022-08-29|         2|       1|      1|       0|    0|        138.15|            69.075|            69.075|              69.075|                            5|         8|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-06-11 23:59:00|        192|         0|     null|                null|      null|      null|\n|     556|   1631879|      Portugal|     Registado|   2831|      duplo standard|Double Room Standard|       website|2022-11-26 19:51:...|  2022-11-27|  2022-11-28|         1|       2|      2|       0|    0|          57.0|              57.0|              28.5|                28.5|                            1|        45|                3|                     2|                      0|                   1|    Covilhã|  Castelo Branco|       3|                10|              3|2023-06-11 23:00:00|         84|         0|     null|                null|      null|      null|\n|     494|   1441498|      Portugal|     Registado|   2383|twin com wc priva...|Quarto twin Com W...|           bar|2022-02-23 16:24:...|  2022-02-24|  2022-02-25|         1|       2|      2|       0|    0|          55.0|              55.0|              27.5|                27.5|                            1|         1|                2|                     2|                      1|                   1|     Lisboa|       Carnaxide|       0|                 0|              0|2023-06-11 12:00:00|          6|         0|     null|                null|      null|      null|\n|     444|   1522331|       Espanha|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|        normal|2022-06-16 18:02:...|  2022-07-08|  2022-07-09|         1|       2|      2|       0|    0|         130.0|             130.0|              65.0|                65.0|                           22|         5|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|     null|                null|      null|      null|\n|     482|   1610762|      Portugal|     Registado|   2285|                  t1|      Apartamento T1|       website|2022-10-18 08:21:...|  2022-10-18|  2022-10-19|         1|       2|      4|       0|    0|          96.9|              96.9|            24.225|               48.45|                            0|        90|                4|                     4|                      3|                   1|   Portimão|           Lagos|       4|                 3|             36|2023-06-11 23:59:00|        143|         0|     null|                null|      null|      null|\n|     311|   1550994|       Holanda|     Registado|   1407|      duplo standard|DB - Quarto Duplo...|non-refundable|2022-07-24 10:52:...|  2022-08-01|  2022-08-02|         1|       2|      2|       0|    0|         80.75|             80.75|            40.375|              40.375|                            8|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         0|     null|                null|      null|      null|\n|     328|   1718730|        França|     Registado|   2813|               other|Interior Double Room|       website|2023-04-12 14:11:...|  2023-08-15|  2023-08-18|         3|       2|      2|       0|    0|        189.24|63.080000000000005|31.540000000000003|  31.540000000000003|                          125|         3|                2|                     2|                      0|                   0|     Lisboa|       Carnaxide|       0|                 0|              0|2023-06-11 22:00:00|         56|         1|     null|                null|      null|      null|\n|     392|   1489614|        França|     Registado|   1801|       duplo ou twin|QUARTO DUPLO OU T...|         promo|2022-05-06 14:29:...|  2022-09-04|  2022-09-08|         4|       2|      2|       0|    0|         505.4|            126.35|            63.175|              63.175|                          121|         6|                3|                     3|                      0|                   1|      Olhão|       Albufeira|       4|                11|             24|2023-06-11 23:30:00|         19|         0|Albufeira| Vilamoura Champi...|2022-09-08|2022-09-11|\n|     179|   1698235|      Portugal|     Registado|    630|       duplo confort|      Duplo  Comfort|non-refundable|2023-03-15 16:50:...|  2023-04-12|  2023-04-15|         3|       2|      2|       0|    0|        375.84|125.27999999999999| 62.63999999999999|   62.63999999999999|                           28|        27|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-06-11 23:59:00|        132|         0|     null|                null|      null|      null|\n|     537|   1580996|       Espanha|     Cancelado|   2719|               other|    Alojamento Alter|non-refundable|2022-09-02 10:27:...|  2022-09-04|  2022-09-05|         1|       2|      2|       0|    0|129.4999999999|    129.4999999999|    64.74999999995|      64.74999999995|                            2|         1|                2|                     2|                      0|                   0|Campo Maior|     Campo Maior|       0|                12|             36|2023-06-11 14:00:00|         13|         0|     null|                null|      null|      null|\n|     444|   1670868|Estados Unidos|     Registado|   2073|               duplo|              Duplo |        normal|2023-02-03 19:12:...|  2023-02-05|  2023-02-06|         1|       2|      4|       0|    0|         140.0|             140.0|              35.0|                70.0|                            2|        14|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|     null|                null|      null|      null|\n|     310|   1624658|Estados Unidos|  NãoRegistado|   1395|      duplo standard|Quarto Duplo Stan...|  mr main rate|2022-11-12 19:42:...|  2022-11-24|  2022-11-26|         2|       2|      2|       0|    0|          98.0|              49.0|              24.5|                24.5|                           12|        10|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-06-11 23:59:00|        192|         0|     null|                null|      null|      null|\n|     444|   1667749|      Portugal|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|        normal|2023-01-30 11:15:...|  2023-02-03|  2023-02-05|         2|       2|      2|       0|    0|         160.0|              80.0|              40.0|                40.0|                            4|         5|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|     null|                null|      null|      null|\n|     504|   1446302|      Portugal|     Registado|   2378|        cela sculare|       Cela Sæculare|           bar|2022-03-04 12:37:...|  2022-03-05|  2022-03-06|         1|       2|      6|       0|    0|       218.025|           218.025|           36.3375|            109.0125|                            1|        13|                2|                     2|                      0|                   1|     Monção|          Monção|       4|                12|             36|2023-06-11 23:59:00|         27|         0|     null|                null|      null|      null|\n|     511|   1457653|Estados Unidos|     Registado|   2394|       duplo ou twin|Quarto Duplo ou Twin|      standard|2022-03-23 19:26:...|  2022-03-23|  2022-03-24|         1|       2|      2|       0|    0|          75.0|              75.0|              37.5|                37.5|                            0|         6|                3|                     3|                      1|                   1|     Sagres|           Lagos|       0|                12|             36|2023-06-11 20:00:00|         16|         0|     null|                null|      null|      null|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+---------+--------------------+----------+----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinEventos\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 36 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "event_count",
          "tpe": {
           "presentableName": "long"
          },
          "nullable": false
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinEventosGrouped = spark.sql(\n    \"\"\"\n        SELECT \n            hotel_ID,  Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros,preco_noite,preco_noite_adulto,preco_noite_ocupacao, dif_data_chegada_data_reserva, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, is_holiday, count(Event) AS event_count\n        FROM JoinEventos\n        GROUP BY hotel_ID, Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros,preco_noite,preco_noite_adulto,preco_noite_ocupacao, dif_data_chegada_data_reserva, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, is_holiday\n    \"\"\"\n)\n\njoinEventosGrouped.createOrReplaceTempView(\"JoinEventosGrouped\")\n\nprintln(joinEventosGrouped.count())\njoinEventosGrouped.show()",
   "id": "",
   "dateCreated": "2023-05-16 20:40:44.016",
   "config": {},
   "dateStarted": "2023-06-11 15:24:40.509",
   "dateUpdated": "2023-06-11 15:24:49.994",
   "dateFinished": "2023-06-11 15:24:49.993",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|     rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|   preco_euros|       preco_noite|preco_noite_adulto|preco_noite_ocupacao|dif_data_chegada_data_reserva|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|event_count|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+\n|     311|   1610542|       Espanha|  NãoRegistado|   1407|      duplo standard|DB - Quarto Duplo...|  main rate bb|2022-10-17 20:40:...|  2022-10-31|  2022-11-01|         1|       2|      2|       0|    0|          98.0|              98.0|              49.0|                49.0|                           14|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|          0|\n|     311|   1539749|        França|     Registado|   1407|      duplo standard|DB - Quarto Duplo...|non-refundable|2022-07-10 18:57:...|  2022-08-11|  2022-08-12|         1|       2|      2|       0|    0|          83.0|              83.0|              41.5|                41.5|                           32|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         0|          0|\n|     559|   1575104|      Portugal|     Registado|   2862|         apartamento|         Apartamento|           bar|2022-08-24 19:34:...|  2022-09-04|  2022-09-07|         3|       2|      2|       0|    0|         546.0|             182.0|              91.0|                91.0|                           11|         3|                3|                     2|                      1|                   1|    Benafim|       Albufeira|       0|                11|             36|2023-06-11 18:00:00|         15|         0|          0|\n|     311|   1464163|      Portugal|  NãoRegistado|   1407|      duplo standard|DB - Quarto Duplo...|         promo|2022-04-01 16:59:...|  2022-04-16|  2022-04-17|         1|       2|      2|       0|    0|          49.5|              49.5|             24.75|               24.75|                           15|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|          0|\n|     309|   1668585|      Portugal|     Cancelado|   1372|      duplo standard|Quarto Duplo Stan...|  mr main rate|2023-01-31 15:22:...|  2023-03-03|  2023-03-05|         2|       2|      2|       0|    0|          88.2|              44.1|             22.05|               22.05|                           31|        10|                2|                     2|                      1|                   0|    Valongo|           Porto|       3|                12|              4|2023-06-11 23:59:00|         41|         0|          1|\n|     310|   1573582|      Portugal|     Registado|   1674|            superior|Quarto Twin Superior|non-refundable|2022-08-22 18:21:...|  2022-08-27|  2022-08-29|         2|       1|      1|       0|    0|        138.15|            69.075|            69.075|              69.075|                            5|         8|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-06-11 23:59:00|        192|         0|          0|\n|     556|   1631879|      Portugal|     Registado|   2831|      duplo standard|Double Room Standard|       website|2022-11-26 19:51:...|  2022-11-27|  2022-11-28|         1|       2|      2|       0|    0|          57.0|              57.0|              28.5|                28.5|                            1|        45|                3|                     2|                      0|                   1|    Covilhã|  Castelo Branco|       3|                10|              3|2023-06-11 23:00:00|         84|         0|          0|\n|     494|   1441498|      Portugal|     Registado|   2383|twin com wc priva...|Quarto twin Com W...|           bar|2022-02-23 16:24:...|  2022-02-24|  2022-02-25|         1|       2|      2|       0|    0|          55.0|              55.0|              27.5|                27.5|                            1|         1|                2|                     2|                      1|                   1|     Lisboa|       Carnaxide|       0|                 0|              0|2023-06-11 12:00:00|          6|         0|          0|\n|     444|   1522331|       Espanha|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|        normal|2022-06-16 18:02:...|  2022-07-08|  2022-07-09|         1|       2|      2|       0|    0|         130.0|             130.0|              65.0|                65.0|                           22|         5|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|          0|\n|     482|   1610762|      Portugal|     Registado|   2285|                  t1|      Apartamento T1|       website|2022-10-18 08:21:...|  2022-10-18|  2022-10-19|         1|       2|      4|       0|    0|          96.9|              96.9|            24.225|               48.45|                            0|        90|                4|                     4|                      3|                   1|   Portimão|           Lagos|       4|                 3|             36|2023-06-11 23:59:00|        143|         0|          0|\n|     311|   1550994|       Holanda|     Registado|   1407|      duplo standard|DB - Quarto Duplo...|non-refundable|2022-07-24 10:52:...|  2022-08-01|  2022-08-02|         1|       2|      2|       0|    0|         80.75|             80.75|            40.375|              40.375|                            8|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         0|          0|\n|     328|   1718730|        França|     Registado|   2813|               other|Interior Double Room|       website|2023-04-12 14:11:...|  2023-08-15|  2023-08-18|         3|       2|      2|       0|    0|        189.24|63.080000000000005|31.540000000000003|  31.540000000000003|                          125|         3|                2|                     2|                      0|                   0|     Lisboa|       Carnaxide|       0|                 0|              0|2023-06-11 22:00:00|         56|         1|          0|\n|     392|   1489614|        França|     Registado|   1801|       duplo ou twin|QUARTO DUPLO OU T...|         promo|2022-05-06 14:29:...|  2022-09-04|  2022-09-08|         4|       2|      2|       0|    0|         505.4|            126.35|            63.175|              63.175|                          121|         6|                3|                     3|                      0|                   1|      Olhão|       Albufeira|       4|                11|             24|2023-06-11 23:30:00|         19|         0|          1|\n|     179|   1698235|      Portugal|     Registado|    630|       duplo confort|      Duplo  Comfort|non-refundable|2023-03-15 16:50:...|  2023-04-12|  2023-04-15|         3|       2|      2|       0|    0|        375.84|125.27999999999999| 62.63999999999999|   62.63999999999999|                           28|        27|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-06-11 23:59:00|        132|         0|          0|\n|     537|   1580996|       Espanha|     Cancelado|   2719|               other|    Alojamento Alter|non-refundable|2022-09-02 10:27:...|  2022-09-04|  2022-09-05|         1|       2|      2|       0|    0|129.4999999999|    129.4999999999|    64.74999999995|      64.74999999995|                            2|         1|                2|                     2|                      0|                   0|Campo Maior|     Campo Maior|       0|                12|             36|2023-06-11 14:00:00|         13|         0|          0|\n|     444|   1670868|Estados Unidos|     Registado|   2073|               duplo|              Duplo |        normal|2023-02-03 19:12:...|  2023-02-05|  2023-02-06|         1|       2|      4|       0|    0|         140.0|             140.0|              35.0|                70.0|                            2|        14|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|          0|\n|     310|   1624658|Estados Unidos|  NãoRegistado|   1395|      duplo standard|Quarto Duplo Stan...|  mr main rate|2022-11-12 19:42:...|  2022-11-24|  2022-11-26|         2|       2|      2|       0|    0|          98.0|              49.0|              24.5|                24.5|                           12|        10|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-06-11 23:59:00|        192|         0|          0|\n|     444|   1667749|      Portugal|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|        normal|2023-01-30 11:15:...|  2023-02-03|  2023-02-05|         2|       2|      2|       0|    0|         160.0|              80.0|              40.0|                40.0|                            4|         5|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|          0|\n|     504|   1446302|      Portugal|     Registado|   2378|        cela sculare|       Cela Sæculare|           bar|2022-03-04 12:37:...|  2022-03-05|  2022-03-06|         1|       2|      6|       0|    0|       218.025|           218.025|           36.3375|            109.0125|                            1|        13|                2|                     2|                      0|                   1|     Monção|          Monção|       4|                12|             36|2023-06-11 23:59:00|         27|         0|          0|\n|     511|   1457653|Estados Unidos|     Registado|   2394|       duplo ou twin|Quarto Duplo ou Twin|      standard|2022-03-23 19:26:...|  2022-03-23|  2022-03-24|         1|       2|      2|       0|    0|          75.0|              75.0|              37.5|                37.5|                            0|         6|                3|                     3|                      1|                   1|     Sagres|           Lagos|       0|                12|             36|2023-06-11 20:00:00|         16|         0|          0|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinEventosGrouped\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 33 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      },
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "event_count",
          "tpe": {
           "presentableName": "long"
          },
          "nullable": false
         },
         {
          "name": "city",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "tavg",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "tmax",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "tmin",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "prcp",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "val joinMeteoTemp = spark.sql(\n    \"\"\"\n        SELECT QR.*, M.city, M.tavg, M.tmax, M.tmin, M.prcp\n        FROM JoinEventosGrouped AS QR\n        LEFT JOIN Meteorologia AS M \n            ON QR.area_localizacao = M.city \n            AND M.date <= QR.data_partida AND M.date >= QR.data_chegada\n    \"\"\")\n\njoinMeteoTemp.createOrReplaceTempView(\"JoinMeteoTemp\")\n\nprintln(joinMeteoTemp.count())\njoinMeteoTemp.show()",
   "id": "",
   "dateCreated": "2023-05-01 15:31:17.385",
   "config": {
    "tableHide": true
   },
   "dateStarted": "2023-06-11 15:24:49.995",
   "dateUpdated": "2023-06-11 15:24:58.842",
   "dateFinished": "2023-06-11 15:24:58.842",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "69746\n+--------+----------+--------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+-----------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+--------------+----+----+----+----+\n|hotel_ID|Reserve_ID|    pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|     rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|preco_euros|preco_noite|preco_noite_adulto|preco_noite_ocupacao|dif_data_chegada_data_reserva|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|event_count|          city|tavg|tmax|tmin|prcp|\n+--------+----------+--------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+-----------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+--------------+----+----+----+----+\n|     311|   1610542| Espanha|  NãoRegistado|   1407|      duplo standard|DB - Quarto Duplo...|  main rate bb|2022-10-17 20:40:...|  2022-10-31|  2022-11-01|         1|       2|      2|       0|    0|       98.0|       98.0|              49.0|                49.0|                           14|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|          0|          Maia|13.3|18.0|10.0| 0.0|\n|     311|   1610542| Espanha|  NãoRegistado|   1407|      duplo standard|DB - Quarto Duplo...|  main rate bb|2022-10-17 20:40:...|  2022-10-31|  2022-11-01|         1|       2|      2|       0|    0|       98.0|       98.0|              49.0|                49.0|                           14|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|          0|          Maia|16.0|19.0|12.0|22.7|\n|     311|   1539749|  França|     Registado|   1407|      duplo standard|DB - Quarto Duplo...|non-refundable|2022-07-10 18:57:...|  2022-08-11|  2022-08-12|         1|       2|      2|       0|    0|       83.0|       83.0|              41.5|                41.5|                           32|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         0|          0|          Maia|19.8|23.7|15.6| 0.0|\n|     311|   1539749|  França|     Registado|   1407|      duplo standard|DB - Quarto Duplo...|non-refundable|2022-07-10 18:57:...|  2022-08-11|  2022-08-12|         1|       2|      2|       0|    0|       83.0|       83.0|              41.5|                41.5|                           32|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         0|          0|          Maia|19.9|24.1|17.0| 0.0|\n|     559|   1575104|Portugal|     Registado|   2862|         apartamento|         Apartamento|           bar|2022-08-24 19:34:...|  2022-09-04|  2022-09-07|         3|       2|      2|       0|    0|      546.0|      182.0|              91.0|                91.0|                           11|         3|                3|                     2|                      1|                   1|    Benafim|       Albufeira|       0|                11|             36|2023-06-11 18:00:00|         15|         0|          0|     Albufeira|21.9|27.8|18.9| 0.0|\n|     559|   1575104|Portugal|     Registado|   2862|         apartamento|         Apartamento|           bar|2022-08-24 19:34:...|  2022-09-04|  2022-09-07|         3|       2|      2|       0|    0|      546.0|      182.0|              91.0|                91.0|                           11|         3|                3|                     2|                      1|                   1|    Benafim|       Albufeira|       0|                11|             36|2023-06-11 18:00:00|         15|         0|          0|     Albufeira|21.8|26.9|18.1| 0.0|\n|     559|   1575104|Portugal|     Registado|   2862|         apartamento|         Apartamento|           bar|2022-08-24 19:34:...|  2022-09-04|  2022-09-07|         3|       2|      2|       0|    0|      546.0|      182.0|              91.0|                91.0|                           11|         3|                3|                     2|                      1|                   1|    Benafim|       Albufeira|       0|                11|             36|2023-06-11 18:00:00|         15|         0|          0|     Albufeira|20.5|24.2|17.0| 0.0|\n|     559|   1575104|Portugal|     Registado|   2862|         apartamento|         Apartamento|           bar|2022-08-24 19:34:...|  2022-09-04|  2022-09-07|         3|       2|      2|       0|    0|      546.0|      182.0|              91.0|                91.0|                           11|         3|                3|                     2|                      1|                   1|    Benafim|       Albufeira|       0|                11|             36|2023-06-11 18:00:00|         15|         0|          0|     Albufeira|20.1|25.6|16.8| 0.0|\n|     311|   1464163|Portugal|  NãoRegistado|   1407|      duplo standard|DB - Quarto Duplo...|         promo|2022-04-01 16:59:...|  2022-04-16|  2022-04-17|         1|       2|      2|       0|    0|       49.5|       49.5|             24.75|               24.75|                           15|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|          0|          Maia|14.7|18.6|12.2|null|\n|     311|   1464163|Portugal|  NãoRegistado|   1407|      duplo standard|DB - Quarto Duplo...|         promo|2022-04-01 16:59:...|  2022-04-16|  2022-04-17|         1|       2|      2|       0|    0|       49.5|       49.5|             24.75|               24.75|                           15|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|          0|          Maia|13.8|16.7|11.2|null|\n|     309|   1668585|Portugal|     Cancelado|   1372|      duplo standard|Quarto Duplo Stan...|  mr main rate|2023-01-31 15:22:...|  2023-03-03|  2023-03-05|         2|       2|      2|       0|    0|       88.2|       44.1|             22.05|               22.05|                           31|        10|                2|                     2|                      1|                   0|    Valongo|           Porto|       3|                12|              4|2023-06-11 23:59:00|         41|         0|          1|         Porto|10.3|12.3| 8.5| 9.0|\n|     309|   1668585|Portugal|     Cancelado|   1372|      duplo standard|Quarto Duplo Stan...|  mr main rate|2023-01-31 15:22:...|  2023-03-03|  2023-03-05|         2|       2|      2|       0|    0|       88.2|       44.1|             22.05|               22.05|                           31|        10|                2|                     2|                      1|                   0|    Valongo|           Porto|       3|                12|              4|2023-06-11 23:59:00|         41|         0|          1|         Porto| 9.8|16.0| 5.6| 0.0|\n|     309|   1668585|Portugal|     Cancelado|   1372|      duplo standard|Quarto Duplo Stan...|  mr main rate|2023-01-31 15:22:...|  2023-03-03|  2023-03-05|         2|       2|      2|       0|    0|       88.2|       44.1|             22.05|               22.05|                           31|        10|                2|                     2|                      1|                   0|    Valongo|           Porto|       3|                12|              4|2023-06-11 23:59:00|         41|         0|          1|         Porto| 8.2|13.8| 4.3| 0.0|\n|     310|   1573582|Portugal|     Registado|   1674|            superior|Quarto Twin Superior|non-refundable|2022-08-22 18:21:...|  2022-08-27|  2022-08-29|         2|       1|      1|       0|    0|     138.15|     69.075|            69.075|              69.075|                            5|         8|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-06-11 23:59:00|        192|         0|          0|         Porto|18.9|22.8|15.9| 0.0|\n|     310|   1573582|Portugal|     Registado|   1674|            superior|Quarto Twin Superior|non-refundable|2022-08-22 18:21:...|  2022-08-27|  2022-08-29|         2|       1|      1|       0|    0|     138.15|     69.075|            69.075|              69.075|                            5|         8|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-06-11 23:59:00|        192|         0|          0|         Porto|19.3|23.6|16.2| 0.0|\n|     310|   1573582|Portugal|     Registado|   1674|            superior|Quarto Twin Superior|non-refundable|2022-08-22 18:21:...|  2022-08-27|  2022-08-29|         2|       1|      1|       0|    0|     138.15|     69.075|            69.075|              69.075|                            5|         8|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-06-11 23:59:00|        192|         0|          0|         Porto|20.6|24.9|17.4| 0.0|\n|     556|   1631879|Portugal|     Registado|   2831|      duplo standard|Double Room Standard|       website|2022-11-26 19:51:...|  2022-11-27|  2022-11-28|         1|       2|      2|       0|    0|       57.0|       57.0|              28.5|                28.5|                            1|        45|                3|                     2|                      0|                   1|    Covilhã|  Castelo Branco|       3|                10|              3|2023-06-11 23:00:00|         84|         0|          0|Castelo Branco| 9.0|13.9| 4.8| 0.0|\n|     556|   1631879|Portugal|     Registado|   2831|      duplo standard|Double Room Standard|       website|2022-11-26 19:51:...|  2022-11-27|  2022-11-28|         1|       2|      2|       0|    0|       57.0|       57.0|              28.5|                28.5|                            1|        45|                3|                     2|                      0|                   1|    Covilhã|  Castelo Branco|       3|                10|              3|2023-06-11 23:00:00|         84|         0|          0|Castelo Branco| 9.5|15.5| 4.4| 2.0|\n|     494|   1441498|Portugal|     Registado|   2383|twin com wc priva...|Quarto twin Com W...|           bar|2022-02-23 16:24:...|  2022-02-24|  2022-02-25|         1|       2|      2|       0|    0|       55.0|       55.0|              27.5|                27.5|                            1|         1|                2|                     2|                      1|                   1|     Lisboa|       Carnaxide|       0|                 0|              0|2023-06-11 12:00:00|          6|         0|          0|     Carnaxide|15.3|20.5|11.8| 0.1|\n|     494|   1441498|Portugal|     Registado|   2383|twin com wc priva...|Quarto twin Com W...|           bar|2022-02-23 16:24:...|  2022-02-24|  2022-02-25|         1|       2|      2|       0|    0|       55.0|       55.0|              27.5|                27.5|                            1|         1|                2|                     2|                      1|                   1|     Lisboa|       Carnaxide|       0|                 0|              0|2023-06-11 12:00:00|          6|         0|          0|     Carnaxide|13.7|18.9|10.6|15.6|\n+--------+----------+--------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+-----------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+--------------+----+----+----+----+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinMeteoTemp\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 38 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "event_count",
          "tpe": {
           "presentableName": "long"
          },
          "nullable": false
         },
         {
          "name": "temperature_avg",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "temperature_max",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "temperature_min",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "precipitation_avg",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "precipitation_max",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "precipitation_min",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinMeteoGrouped = spark.sql(\n    \"\"\"\n        SELECT \n            hotel_ID,  Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros,preco_noite,preco_noite_adulto,preco_noite_ocupacao, dif_data_chegada_data_reserva, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, is_holiday, event_count,\n            avg(tavg) AS temperature_avg,\n            max(tmax) AS temperature_max,\n            min(tmin) AS temperature_min,\n            avg(prcp) AS precipitation_avg,\n            max(prcp) AS precipitation_max,\n            min(prcp) AS precipitation_min\n        FROM JoinMeteoTemp\n        GROUP BY hotel_ID, Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros,preco_noite,preco_noite_adulto,preco_noite_ocupacao, dif_data_chegada_data_reserva, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, is_holiday, event_count\n    \"\"\"\n)\n\njoinMeteoGrouped.createOrReplaceTempView(\"JoinMeteoGrouped\")\n\nprintln(joinMeteoGrouped.count())\njoinMeteoGrouped.show()",
   "id": "",
   "dateCreated": "2023-05-16 21:41:47.134",
   "config": {},
   "dateStarted": "2023-06-11 15:24:58.842",
   "dateUpdated": "2023-06-11 15:25:09.697",
   "dateFinished": "2023-06-11 15:25:09.697",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+------------------+-----------------+-----------------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|     rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|   preco_euros|       preco_noite|preco_noite_adulto|preco_noite_ocupacao|dif_data_chegada_data_reserva|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|event_count|   temperature_avg|temperature_max|temperature_min| precipitation_avg|precipitation_max|precipitation_min|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+------------------+-----------------+-----------------+\n|     311|   1610542|       Espanha|  NãoRegistado|   1407|      duplo standard|DB - Quarto Duplo...|  main rate bb|2022-10-17 20:40:...|  2022-10-31|  2022-11-01|         1|       2|      2|       0|    0|          98.0|              98.0|              49.0|                49.0|                           14|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|          0|             14.65|           19.0|           10.0|             11.35|             22.7|              0.0|\n|     311|   1539749|        França|     Registado|   1407|      duplo standard|DB - Quarto Duplo...|non-refundable|2022-07-10 18:57:...|  2022-08-11|  2022-08-12|         1|       2|      2|       0|    0|          83.0|              83.0|              41.5|                41.5|                           32|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         0|          0|             19.85|           24.1|           15.6|               0.0|              0.0|              0.0|\n|     559|   1575104|      Portugal|     Registado|   2862|         apartamento|         Apartamento|           bar|2022-08-24 19:34:...|  2022-09-04|  2022-09-07|         3|       2|      2|       0|    0|         546.0|             182.0|              91.0|                91.0|                           11|         3|                3|                     2|                      1|                   1|    Benafim|       Albufeira|       0|                11|             36|2023-06-11 18:00:00|         15|         0|          0|21.075000000000003|           27.8|           16.8|               0.0|              0.0|              0.0|\n|     311|   1464163|      Portugal|  NãoRegistado|   1407|      duplo standard|DB - Quarto Duplo...|         promo|2022-04-01 16:59:...|  2022-04-16|  2022-04-17|         1|       2|      2|       0|    0|          49.5|              49.5|             24.75|               24.75|                           15|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|          0|             14.25|           18.6|           11.2|              null|             null|             null|\n|     309|   1668585|      Portugal|     Cancelado|   1372|      duplo standard|Quarto Duplo Stan...|  mr main rate|2023-01-31 15:22:...|  2023-03-03|  2023-03-05|         2|       2|      2|       0|    0|          88.2|              44.1|             22.05|               22.05|                           31|        10|                2|                     2|                      1|                   0|    Valongo|           Porto|       3|                12|              4|2023-06-11 23:59:00|         41|         0|          1| 9.433333333333334|           16.0|            4.3|               3.0|              9.0|              0.0|\n|     310|   1573582|      Portugal|     Registado|   1674|            superior|Quarto Twin Superior|non-refundable|2022-08-22 18:21:...|  2022-08-27|  2022-08-29|         2|       1|      1|       0|    0|        138.15|            69.075|            69.075|              69.075|                            5|         8|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-06-11 23:59:00|        192|         0|          0|              19.6|           24.9|           15.9|               0.0|              0.0|              0.0|\n|     556|   1631879|      Portugal|     Registado|   2831|      duplo standard|Double Room Standard|       website|2022-11-26 19:51:...|  2022-11-27|  2022-11-28|         1|       2|      2|       0|    0|          57.0|              57.0|              28.5|                28.5|                            1|        45|                3|                     2|                      0|                   1|    Covilhã|  Castelo Branco|       3|                10|              3|2023-06-11 23:00:00|         84|         0|          0|              9.25|           15.5|            4.4|               1.0|              2.0|              0.0|\n|     494|   1441498|      Portugal|     Registado|   2383|twin com wc priva...|Quarto twin Com W...|           bar|2022-02-23 16:24:...|  2022-02-24|  2022-02-25|         1|       2|      2|       0|    0|          55.0|              55.0|              27.5|                27.5|                            1|         1|                2|                     2|                      1|                   1|     Lisboa|       Carnaxide|       0|                 0|              0|2023-06-11 12:00:00|          6|         0|          0|              14.5|           20.5|           10.6|              7.85|             15.6|              0.1|\n|     444|   1522331|       Espanha|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|        normal|2022-06-16 18:02:...|  2022-07-08|  2022-07-09|         1|       2|      2|       0|    0|         130.0|             130.0|              65.0|                65.0|                           22|         5|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|          0|             25.55|           37.0|           16.0|               0.0|              0.0|              0.0|\n|     482|   1610762|      Portugal|     Registado|   2285|                  t1|      Apartamento T1|       website|2022-10-18 08:21:...|  2022-10-18|  2022-10-19|         1|       2|      4|       0|    0|          96.9|              96.9|            24.225|               48.45|                            0|        90|                4|                     4|                      3|                   1|   Portimão|           Lagos|       4|                 3|             36|2023-06-11 23:59:00|        143|         0|          0|20.299999999999997|           22.4|           18.4|              null|             null|             null|\n|     311|   1550994|       Holanda|     Registado|   1407|      duplo standard|DB - Quarto Duplo...|non-refundable|2022-07-24 10:52:...|  2022-08-01|  2022-08-02|         1|       2|      2|       0|    0|         80.75|             80.75|            40.375|              40.375|                            8|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         0|          0|              20.7|           26.0|           17.8|               0.0|              0.0|              0.0|\n|     328|   1718730|        França|     Registado|   2813|               other|Interior Double Room|       website|2023-04-12 14:11:...|  2023-08-15|  2023-08-18|         3|       2|      2|       0|    0|        189.24|63.080000000000005|31.540000000000003|  31.540000000000003|                          125|         3|                2|                     2|                      0|                   0|     Lisboa|       Carnaxide|       0|                 0|              0|2023-06-11 22:00:00|         56|         1|          0|              null|           null|           null|              null|             null|             null|\n|     392|   1489614|        França|     Registado|   1801|       duplo ou twin|QUARTO DUPLO OU T...|         promo|2022-05-06 14:29:...|  2022-09-04|  2022-09-08|         4|       2|      2|       0|    0|         505.4|            126.35|            63.175|              63.175|                          121|         6|                3|                     3|                      0|                   1|      Olhão|       Albufeira|       4|                11|             24|2023-06-11 23:30:00|         19|         0|          1|              21.3|           27.8|           16.8|               0.0|              0.0|              0.0|\n|     179|   1698235|      Portugal|     Registado|    630|       duplo confort|      Duplo  Comfort|non-refundable|2023-03-15 16:50:...|  2023-04-12|  2023-04-15|         3|       2|      2|       0|    0|        375.84|125.27999999999999| 62.63999999999999|   62.63999999999999|                           28|        27|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-06-11 23:59:00|        132|         0|          0|             12.55|           19.1|            7.4|             2.675|              6.4|              0.0|\n|     537|   1580996|       Espanha|     Cancelado|   2719|               other|    Alojamento Alter|non-refundable|2022-09-02 10:27:...|  2022-09-04|  2022-09-05|         1|       2|      2|       0|    0|129.4999999999|    129.4999999999|    64.74999999995|      64.74999999995|                            2|         1|                2|                     2|                      0|                   0|Campo Maior|     Campo Maior|       0|                12|             36|2023-06-11 14:00:00|         13|         0|          0|             21.95|           29.9|           14.3|               0.0|              0.0|              0.0|\n|     444|   1670868|Estados Unidos|     Registado|   2073|               duplo|              Duplo |        normal|2023-02-03 19:12:...|  2023-02-05|  2023-02-06|         1|       2|      4|       0|    0|         140.0|             140.0|              35.0|                70.0|                            2|        14|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|          0|              8.45|           18.1|            0.8|               0.0|              0.0|              0.0|\n|     310|   1624658|Estados Unidos|  NãoRegistado|   1395|      duplo standard|Quarto Duplo Stan...|  mr main rate|2022-11-12 19:42:...|  2022-11-24|  2022-11-26|         2|       2|      2|       0|    0|          98.0|              49.0|              24.5|                24.5|                           12|        10|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-06-11 23:59:00|        192|         0|          0|12.733333333333334|           16.8|            8.4|10.566666666666666|             31.5|              0.0|\n|     444|   1667749|      Portugal|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|        normal|2023-01-30 11:15:...|  2023-02-03|  2023-02-05|         2|       2|      2|       0|    0|         160.0|              80.0|              40.0|                40.0|                            4|         5|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|          0| 8.466666666666667|           18.3|            0.0|               0.0|              0.0|              0.0|\n|     504|   1446302|      Portugal|     Registado|   2378|        cela sculare|       Cela Sæculare|           bar|2022-03-04 12:37:...|  2022-03-05|  2022-03-06|         1|       2|      6|       0|    0|       218.025|           218.025|           36.3375|            109.0125|                            1|        13|                2|                     2|                      0|                   1|     Monção|          Monção|       4|                12|             36|2023-06-11 23:59:00|         27|         0|          0|               7.9|           13.6|            3.2|               0.0|              0.0|              0.0|\n|     511|   1457653|Estados Unidos|     Registado|   2394|       duplo ou twin|Quarto Duplo ou Twin|      standard|2022-03-23 19:26:...|  2022-03-23|  2022-03-24|         1|       2|      2|       0|    0|          75.0|              75.0|              37.5|                37.5|                            0|         6|                3|                     3|                      1|                   1|     Sagres|           Lagos|       0|                12|             36|2023-06-11 20:00:00|         16|         0|          0|13.899999999999999|           15.8|           12.3|              null|             null|             null|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+------------------+-----------------+-----------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinMeteoGrouped\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 39 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "event_count",
          "tpe": {
           "presentableName": "long"
          },
          "nullable": false
         },
         {
          "name": "temperature_avg",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "temperature_max",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "temperature_min",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "precipitation_avg",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "precipitation_max",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "precipitation_min",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "joinMeteoGrouped.createOrReplaceTempView(\"FinalDataSet\")\n\nval FinalDataSet = spark.sql(\"select * from FinalDataSet\")\nprintln(FinalDataSet.count())\nFinalDataSet.show()\n\nsaveDataFrame(FinalDataSet, \"FinalDataSet\")",
   "id": "",
   "dateCreated": "2023-05-01 15:47:23.871",
   "config": {},
   "dateStarted": "2023-06-11 15:25:09.698",
   "dateUpdated": "2023-06-11 15:25:26.953",
   "dateFinished": "2023-06-11 15:25:26.953",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+------------------+-----------------+-----------------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|     rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|   preco_euros|       preco_noite|preco_noite_adulto|preco_noite_ocupacao|dif_data_chegada_data_reserva|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|event_count|   temperature_avg|temperature_max|temperature_min| precipitation_avg|precipitation_max|precipitation_min|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+------------------+-----------------+-----------------+\n|     311|   1610542|       Espanha|  NãoRegistado|   1407|      duplo standard|DB - Quarto Duplo...|  main rate bb|2022-10-17 20:40:...|  2022-10-31|  2022-11-01|         1|       2|      2|       0|    0|          98.0|              98.0|              49.0|                49.0|                           14|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|          0|             14.65|           19.0|           10.0|             11.35|             22.7|              0.0|\n|     311|   1539749|        França|     Registado|   1407|      duplo standard|DB - Quarto Duplo...|non-refundable|2022-07-10 18:57:...|  2022-08-11|  2022-08-12|         1|       2|      2|       0|    0|          83.0|              83.0|              41.5|                41.5|                           32|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         0|          0|             19.85|           24.1|           15.6|               0.0|              0.0|              0.0|\n|     559|   1575104|      Portugal|     Registado|   2862|         apartamento|         Apartamento|           bar|2022-08-24 19:34:...|  2022-09-04|  2022-09-07|         3|       2|      2|       0|    0|         546.0|             182.0|              91.0|                91.0|                           11|         3|                3|                     2|                      1|                   1|    Benafim|       Albufeira|       0|                11|             36|2023-06-11 18:00:00|         15|         0|          0|21.075000000000003|           27.8|           16.8|               0.0|              0.0|              0.0|\n|     311|   1464163|      Portugal|  NãoRegistado|   1407|      duplo standard|DB - Quarto Duplo...|         promo|2022-04-01 16:59:...|  2022-04-16|  2022-04-17|         1|       2|      2|       0|    0|          49.5|              49.5|             24.75|               24.75|                           15|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         1|          0|             14.25|           18.6|           11.2|              null|             null|             null|\n|     309|   1668585|      Portugal|     Cancelado|   1372|      duplo standard|Quarto Duplo Stan...|  mr main rate|2023-01-31 15:22:...|  2023-03-03|  2023-03-05|         2|       2|      2|       0|    0|          88.2|              44.1|             22.05|               22.05|                           31|        10|                2|                     2|                      1|                   0|    Valongo|           Porto|       3|                12|              4|2023-06-11 23:59:00|         41|         0|          1| 9.433333333333334|           16.0|            4.3|               3.0|              9.0|              0.0|\n|     310|   1573582|      Portugal|     Registado|   1674|            superior|Quarto Twin Superior|non-refundable|2022-08-22 18:21:...|  2022-08-27|  2022-08-29|         2|       1|      1|       0|    0|        138.15|            69.075|            69.075|              69.075|                            5|         8|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-06-11 23:59:00|        192|         0|          0|              19.6|           24.9|           15.9|               0.0|              0.0|              0.0|\n|     556|   1631879|      Portugal|     Registado|   2831|      duplo standard|Double Room Standard|       website|2022-11-26 19:51:...|  2022-11-27|  2022-11-28|         1|       2|      2|       0|    0|          57.0|              57.0|              28.5|                28.5|                            1|        45|                3|                     2|                      0|                   1|    Covilhã|  Castelo Branco|       3|                10|              3|2023-06-11 23:00:00|         84|         0|          0|              9.25|           15.5|            4.4|               1.0|              2.0|              0.0|\n|     494|   1441498|      Portugal|     Registado|   2383|twin com wc priva...|Quarto twin Com W...|           bar|2022-02-23 16:24:...|  2022-02-24|  2022-02-25|         1|       2|      2|       0|    0|          55.0|              55.0|              27.5|                27.5|                            1|         1|                2|                     2|                      1|                   1|     Lisboa|       Carnaxide|       0|                 0|              0|2023-06-11 12:00:00|          6|         0|          0|              14.5|           20.5|           10.6|              7.85|             15.6|              0.1|\n|     444|   1522331|       Espanha|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|        normal|2022-06-16 18:02:...|  2022-07-08|  2022-07-09|         1|       2|      2|       0|    0|         130.0|             130.0|              65.0|                65.0|                           22|         5|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|          0|             25.55|           37.0|           16.0|               0.0|              0.0|              0.0|\n|     482|   1610762|      Portugal|     Registado|   2285|                  t1|      Apartamento T1|       website|2022-10-18 08:21:...|  2022-10-18|  2022-10-19|         1|       2|      4|       0|    0|          96.9|              96.9|            24.225|               48.45|                            0|        90|                4|                     4|                      3|                   1|   Portimão|           Lagos|       4|                 3|             36|2023-06-11 23:59:00|        143|         0|          0|20.299999999999997|           22.4|           18.4|              null|             null|             null|\n|     311|   1550994|       Holanda|     Registado|   1407|      duplo standard|DB - Quarto Duplo...|non-refundable|2022-07-24 10:52:...|  2022-08-01|  2022-08-02|         1|       2|      2|       0|    0|         80.75|             80.75|            40.375|              40.375|                            8|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-06-11 23:59:00|         30|         0|          0|              20.7|           26.0|           17.8|               0.0|              0.0|              0.0|\n|     328|   1718730|        França|     Registado|   2813|               other|Interior Double Room|       website|2023-04-12 14:11:...|  2023-08-15|  2023-08-18|         3|       2|      2|       0|    0|        189.24|63.080000000000005|31.540000000000003|  31.540000000000003|                          125|         3|                2|                     2|                      0|                   0|     Lisboa|       Carnaxide|       0|                 0|              0|2023-06-11 22:00:00|         56|         1|          0|              null|           null|           null|              null|             null|             null|\n|     392|   1489614|        França|     Registado|   1801|       duplo ou twin|QUARTO DUPLO OU T...|         promo|2022-05-06 14:29:...|  2022-09-04|  2022-09-08|         4|       2|      2|       0|    0|         505.4|            126.35|            63.175|              63.175|                          121|         6|                3|                     3|                      0|                   1|      Olhão|       Albufeira|       4|                11|             24|2023-06-11 23:30:00|         19|         0|          1|              21.3|           27.8|           16.8|               0.0|              0.0|              0.0|\n|     179|   1698235|      Portugal|     Registado|    630|       duplo confort|      Duplo  Comfort|non-refundable|2023-03-15 16:50:...|  2023-04-12|  2023-04-15|         3|       2|      2|       0|    0|        375.84|125.27999999999999| 62.63999999999999|   62.63999999999999|                           28|        27|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-06-11 23:59:00|        132|         0|          0|             12.55|           19.1|            7.4|             2.675|              6.4|              0.0|\n|     537|   1580996|       Espanha|     Cancelado|   2719|               other|    Alojamento Alter|non-refundable|2022-09-02 10:27:...|  2022-09-04|  2022-09-05|         1|       2|      2|       0|    0|129.4999999999|    129.4999999999|    64.74999999995|      64.74999999995|                            2|         1|                2|                     2|                      0|                   0|Campo Maior|     Campo Maior|       0|                12|             36|2023-06-11 14:00:00|         13|         0|          0|             21.95|           29.9|           14.3|               0.0|              0.0|              0.0|\n|     444|   1670868|Estados Unidos|     Registado|   2073|               duplo|              Duplo |        normal|2023-02-03 19:12:...|  2023-02-05|  2023-02-06|         1|       2|      4|       0|    0|         140.0|             140.0|              35.0|                70.0|                            2|        14|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|          0|              8.45|           18.1|            0.8|               0.0|              0.0|              0.0|\n|     310|   1624658|Estados Unidos|  NãoRegistado|   1395|      duplo standard|Quarto Duplo Stan...|  mr main rate|2022-11-12 19:42:...|  2022-11-24|  2022-11-26|         2|       2|      2|       0|    0|          98.0|              49.0|              24.5|                24.5|                           12|        10|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-06-11 23:59:00|        192|         0|          0|12.733333333333334|           16.8|            8.4|10.566666666666666|             31.5|              0.0|\n|     444|   1667749|      Portugal|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|        normal|2023-01-30 11:15:...|  2023-02-03|  2023-02-05|         2|       2|      2|       0|    0|         160.0|              80.0|              40.0|                40.0|                            4|         5|                2|                     2|                      1|                   1|     Nazaré|         Batalha|       4|                12|             24|2023-06-11 23:59:00|         77|         0|          0| 8.466666666666667|           18.3|            0.0|               0.0|              0.0|              0.0|\n|     504|   1446302|      Portugal|     Registado|   2378|        cela sculare|       Cela Sæculare|           bar|2022-03-04 12:37:...|  2022-03-05|  2022-03-06|         1|       2|      6|       0|    0|       218.025|           218.025|           36.3375|            109.0125|                            1|        13|                2|                     2|                      0|                   1|     Monção|          Monção|       4|                12|             36|2023-06-11 23:59:00|         27|         0|          0|               7.9|           13.6|            3.2|               0.0|              0.0|              0.0|\n|     511|   1457653|Estados Unidos|     Registado|   2394|       duplo ou twin|Quarto Duplo ou Twin|      standard|2022-03-23 19:26:...|  2022-03-23|  2022-03-24|         1|       2|      2|       0|    0|          75.0|              75.0|              37.5|                37.5|                            0|         6|                3|                     3|                      1|                   1|     Sagres|           Lagos|       0|                12|             36|2023-06-11 20:00:00|         16|         0|          0|13.899999999999999|           15.8|           12.3|              null|             null|             null|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+------------------+------------------+--------------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+------------------+-----------------+-----------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mFinalDataSet\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 39 more fields]\n"
     }
    ]
   }
  }
 ],
 "name": "Zeppelin Notebook",
 "id": "",
 "noteParams": {},
 "noteForms": {},
 "angularObjects": {},
 "config": {
  "isZeppelinNotebookCronEnable": false,
  "looknfeel": "default",
  "personalizedMode": "false"
 },
 "info": {}
}