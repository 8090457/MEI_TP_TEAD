{
 "paragraphs": [
  {
   "settings": {
    "params": {
     "bdtMeta": {}
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "// FILE #2",
   "id": "",
   "dateCreated": "2023-05-08 15:40:50.806",
   "config": {},
   "dateStarted": "2023-05-16 21:59:24.169",
   "dateUpdated": "2023-05-16 21:59:24.481",
   "dateFinished": "2023-05-16 21:59:24.481",
   "results": {
    "code": "SUCCESS",
    "msg": []
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": []
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "import org.apache.spark.sql.DataFrame\nimport org.apache.spark.sql.functions._\nimport spark.implicits._\n\nval joinFolder = \"/data/joins\"\nval saveJoins = false\n\ndef saveDataFrame(df: DataFrame, name: String): Unit = {\n    df.coalesce(1) // Print into a single file\n            .write\n            .mode(\"overwrite\")\n            .option(\"delimiter\", \";\")\n            .option(\"header\", true) // Maintain Headers\n            .csv(s\"$joinFolder/$name\") // Write to csv\n}\nval initialCount = spark.sql(\"SELECT DISTINCT * FROM QuartosReservados\")\ninitialCount.show(100)\nprintln(initialCount.count())",
   "id": "",
   "dateCreated": "2023-04-30 19:59:44.804",
   "config": {
    "editorHide": false
   },
   "dateStarted": "2023-05-17 00:54:06.561",
   "dateUpdated": "2023-05-17 00:54:18.796",
   "dateFinished": "2023-05-17 00:54:18.795",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+--------------------+--------+----------+---------------+--------------+-------+--------------------+--------------------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+------------------+------------------+--------------------+-----------------------------+\n|rate_plan_normalized|hotel_ID|Reserve_ID|           pais|estado_reserva|room_ID|         tipo_quarto|           rate_plan|        data_reserva|num_noites|Quantidade de quartos|ocupacao|adultos|criancas|bebes|   preco_euros|data_chegada|data_partida|       preco_noite|preco_noite_adulto|preco_noite_ocupacao|dif_data_chegada_data_reserva|\n+--------------------+--------+----------+---------------+--------------+-------+--------------------+--------------------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+------------------+------------------+--------------------+-----------------------------+\n|                 bar|     539|   1566469|       Portugal|    Confirmado|   2546|            Villa T2|                 bar|2022-08-11 14:23:...|         2|                    1|       1|      1|       0|    0|         220.0|  2022-08-20|  2022-08-22|             110.0|             110.0|               110.0|                            9|\n|                twin|     311|   1446305|    Reino Unido|  NãoRegistado|   1429|TW - Quarto Twin ...|               tw bb|2022-03-04 12:46:...|         1|                    1|       2|      2|       0|    0|          89.0|  2022-04-06|  2022-04-07|              89.0|              44.5|                44.5|                           33|\n| best available rate|     399|   1428427|        Holanda|     Registado|   1858| 1 Bedroom Pool View| best available rate|2022-01-30 13:37:...|         9|                    1|       2|      2|       0|    0|        1077.0|  2022-08-30|  2022-09-08|119.66666666666667|59.833333333333336|  59.833333333333336|                          212|\n|             website|     556|   1650347|         França|     Registado|   2831|Double Room Standard|web best availabl...|2023-01-04 21:09:...|         1|                    1|       2|      2|       0|    0|          61.2|  2023-01-05|  2023-01-06|              61.2|              30.6|                30.6|                            1|\n|      non-refundable|     482|   1538930|       Portugal|     Registado|   2285|      Apartamento T1|web nonrefundable...|2022-07-09 16:27:...|         6|                    1|       2|      2|       0|    0|        1312.0|  2022-08-15|  2022-08-21|218.66666666666666|109.33333333333333|  109.33333333333333|                           37|\n|      non-refundable|     311|   1480709|       Portugal|     Registado|   2034|DBS - Quarto Dupl...|          dbs ro nrf|2022-04-24 15:34:...|         1|                    1|       1|      1|       0|    0|          78.0|  2022-04-24|  2022-04-25|              78.0|              78.0|                78.0|                            0|\n|   premium room only|     311|   1500742| Estados Unidos|  NãoRegistado|   2159|SUT - Quarto Premium|   premium room only|2022-05-20 09:28:...|         1|                    1|       2|      2|       0|    0|         104.0|  2022-05-22|  2022-05-23|             104.0|              52.0|                52.0|                            2|\n|      non-refundable|     310|   1528982|         França|     Registado|   1673|Quarto Duplo Supe...|                 nrf|2022-06-26 08:08:...|         5|                    1|       2|      2|       0|    0|         340.0|  2022-08-01|  2022-08-06|              68.0|              34.0|                34.0|                           36|\n|      non-refundable|     514|   1456791|        Áustria|     Registado|   2425|     Eco Garden Room|       no refundable|2022-03-22 16:53:...|         3|                    1|       2|      2|       0|    0|         364.5|  2022-09-23|  2022-09-26|             121.5|             60.75|               60.75|                          185|\n|      non-refundable|     482|   1530183|        Holanda|     Registado|   2285|      Apartamento T1|web nonrefundable...|2022-06-27 18:28:...|         1|                    1|       2|      2|       0|    0|114.8599999999|  2022-07-15|  2022-07-16|    114.8599999999|    57.42999999995|      57.42999999995|                           18|\n|      non-refundable|     310|   1472256|       Portugal|  NãoRegistado|   1424|Quarto Twin Standard|                 nrf|2022-04-11 15:17:...|         1|                    1|       2|      2|       0|    0|          48.0|  2022-04-11|  2022-04-12|              48.0|              24.0|                24.0|                            0|\n|              normal|     444|   1439687|       Portugal|     Registado|   2073|              Duplo |              normal|2022-02-20 17:35:...|         1|                    1|       2|      2|       0|    0|          70.0|  2022-03-05|  2022-03-06|              70.0|              35.0|                35.0|                           13|\n|      reembolsvel ap|     322|   1511349|Ilha da Reunião|     Registado|   2259|                Twin|      reembolsvel ap|2022-06-02 16:28:...|         1|                    1|       2|      2|       0|    0|          69.0|  2022-06-05|  2022-06-06|              69.0|              34.5|                34.5|                            3|\n|                 bar|     426|   1675082| Estados Unidos|     Registado|   1991|Duplo Premium - C...|                 bar|2023-02-09 17:03:...|         1|                    1|       2|      2|       0|    0|         110.0|  2023-09-11|  2023-09-12|             110.0|              55.0|                55.0|                          214|\n|             website|     556|   1690680|       Portugal|      Pendente|   2831|Double Room Standard|web best availabl...|2023-03-04 23:16:...|         2|                    1|       2|      2|       0|    0|         125.8|  2023-05-13|  2023-05-15|              62.9|             31.45|               31.45|                           70|\n|                 bar|     514|   1682069|        Espanha|     Registado|   2494|           Pool Room|                 bar|2023-02-20 14:40:...|         3|                    1|       3|      3|       0|    0|         540.0|  2023-04-06|  2023-04-09|             180.0|              60.0|                60.0|                           45|\n|      non-refundable|     556|   1556314|         Canadá|      Pendente|   2831|Double Room Standard|web nrf  non refu...|2022-07-28 19:56:...|         5|                    1|       1|      1|       0|    0|        188.76|  2022-07-28|  2022-08-02|37.751999999999995|37.751999999999995|  37.751999999999995|                            0|\n|melhor preo garan...|      49|   1661522|     Luxemburgo|     Registado|    211|\"Quarto Duplo \"\"T...|melhor preo garan...|2023-01-22 08:46:...|         6|                    1|       2|      2|       0|    0|        1320.0|  2023-08-09|  2023-08-15|             220.0|             110.0|               110.0|                          199|\n|                 bar|      44|   1571267| Estados Unidos|    Modificada|     85| Quarto Vista Pinhão|                 bar|2022-08-18 19:12:...|         3|                    1|       2|      2|       0|    0|         375.0|  2022-10-30|  2022-11-02|             125.0|              62.5|                62.5|                           73|\n|             website|     535|   1447182|       Portugal|      Pendente|   2526|     Quarto Familiar|             website|2022-03-06 11:48:...|         1|                    1|       2|      2|       0|    0|          90.0|  2022-06-10|  2022-06-11|              90.0|              45.0|                45.0|                           96|\n|      non-refundable|     259|   1442080|       Portugal|     Registado|   1103|            Standard|non refundable  s...|2022-02-24 17:42:...|         2|                    2|       2|      4|       0|    0|         450.0|  2022-02-25|  2022-02-27|             225.0|             56.25|               112.5|                            1|\n|             website|     556|   1688358|         França|     Registado|   2831|Double Room Standard|web best availabl...|2023-03-01 16:10:...|         1|                    1|       2|      2|       0|    0|         55.25|  2023-03-05|  2023-03-06|             55.25|            27.625|              27.625|                            4|\n|        mr main rate|     309|   1615469|       Portugal|      Pendente|   2254|Quarto Duplo Supe...|       mr  main rate|2022-10-26 12:56:...|         2|                    2|       2|      4|       0|    0|         264.6|  2022-10-28|  2022-10-30|             132.3|            33.075|               66.15|                            2|\n|        mr main rate|     311|   1658372|       Portugal|     Registado|   1946|DBT - Quarto Dupl...|       mr  main rate|2023-01-17 11:59:...|         1|                    1|       3|      3|       0|    0|          88.2|  2023-03-15|  2023-03-16|              88.2|29.400000000000002|  29.400000000000002|                           57|\n|        main rate bb|     310|   1671139|       Portugal|    Modificada|   1395|Quarto Duplo Stan...|        main rate bb|2023-02-04 11:09:...|         1|                    1|       1|      1|       0|    0|        52.479|  2023-02-07|  2023-02-08|            52.479|            52.479|              52.479|                            3|\n|                twin|     311|   1419070|    Reino Unido|     Registado|   1429|TW - Quarto Twin ...|               tw bb|2022-01-04 16:06:...|         1|                    1|       2|      2|       0|    0|          79.0|  2022-01-14|  2022-01-15|              79.0|              39.5|                39.5|                           10|\n|             website|     535|   1633203|       Portugal|    Modificada|   2524|         Quarto Twin|             website|2022-11-29 11:58:...|         1|                    1|       2|      2|       0|    0|          81.0|  2023-01-28|  2023-01-29|              81.0|              40.5|                40.5|                           60|\n|             website|     556|   1718435|       Portugal|      Pendente|   2831|Double Room Standard|web best availabl...|2023-04-12 08:15:...|         1|                    2|       1|      2|       0|    0|          95.2|  2023-04-17|  2023-04-18|              95.2|              47.6|                95.2|                            5|\n|             website|     535|   1687507|       Portugal|     Registado|   2523|        Quarto Duplo|             website|2023-02-28 13:02:...|         1|                    1|       2|      2|       0|    0|          63.0|  2023-03-01|  2023-03-02|              63.0|              31.5|                31.5|                            1|\n|              normal|     319|   1587563|        Espanha|     Registado|   2890|          City Duplo|           normal bb|2022-09-12 14:50:...|         1|                    1|       2|      2|       0|    0|          85.0|  2022-09-12|  2022-09-13|              85.0|              42.5|                42.5|                            0|\n|             website|     482|   1503518|       Portugal|     Registado|   2286|      Apartamento T2|web best availabl...|2022-05-23 21:34:...|         2|                    1|       5|      5|       0|    0|         209.0|  2022-06-03|  2022-06-05|             104.5|              20.9|                20.9|                           11|\n|                 bar|     358|   1509277|      Hong Kong|     Registado|   1767|Suite Twin com Vi...|                 bar|2022-05-31 03:44:...|         2|                    1|       1|      1|       0|    0|         456.0|  2022-08-19|  2022-08-21|             228.0|             228.0|               228.0|                           80|\n|            duplo bb|     311|   1472723|       Alemanha|    Modificada|   1407|DB - Quarto Duplo...|            duplo bb|2022-04-12 08:53:...|         2|                    1|       2|      2|       0|    0|         178.0|  2022-05-09|  2022-05-11|              89.0|              44.5|                44.5|                           27|\n|             website|     482|   1595332|       Portugal|     Registado|   2285|      Apartamento T1|web best availabl...|2022-09-24 15:41:...|         5|                    1|       2|      2|       0|    0|         332.5|  2022-09-26|  2022-10-01|              66.5|             33.25|               33.25|                            2|\n|                 bar|     426|   1540707|       Portugal|     Registado|   1990|       Twin Standard|                 bar|2022-07-11 21:38:...|         2|                    1|       2|      2|       0|    0|         200.0|  2022-08-23|  2022-08-25|             100.0|              50.0|                50.0|                           43|\n|              normal|     287|   1518555|         Itália|     Registado|   1232|              STUDIO|            standard|2022-06-12 12:00:...|         2|                    1|       4|      4|       0|    0|         225.0|  2022-06-18|  2022-06-20|             112.5|            28.125|              28.125|                            6|\n|             website|     535|   1711019|     Luxemburgo|     Registado|   2527|               Suite|             website|2023-04-02 12:30:...|         1|                    1|       2|      2|       2|    0|         129.0|  2023-04-28|  2023-04-29|             129.0|              64.5|                64.5|                           26|\n|        main rate bb|     310|   1691445|       Portugal|     Cancelado|   1395|Quarto Duplo Stan...|        main rate bb|2023-03-06 01:15:...|         1|                    2|       2|      4|       0|    0|       127.167|  2023-04-24|  2023-04-25|           127.167|          31.79175|             63.5835|                           49|\n|                 bar|     413|   1646964|       Portugal|     Registado|   1914|Quarto Duplo Supe...|                 bar|2022-12-29 11:32:...|         1|                    1|       2|      2|       0|    0|         140.0|  2023-01-14|  2023-01-15|             140.0|              70.0|                70.0|                           16|\n|              normal|     314|   1515432| Estados Unidos|     Registado|   1387|                Twin|            standard|2022-06-07 22:54:...|         1|                    1|       2|      2|       0|    0|          90.0|  2022-06-08|  2022-06-09|              90.0|              45.0|                45.0|                            1|\n|                 bar|     426|   1516815| Estados Unidos|     Registado|   1991|Duplo Premium - C...|                 bar|2022-06-09 17:22:...|         4|                    1|       2|      2|       0|    0|         400.0|  2022-06-27|  2022-07-01|             100.0|              50.0|                50.0|                           18|\n|melhor preo garan...|      49|   1679415|      Singapura|    Modificada|    211|\"Quarto Duplo \"\"T...|melhor preo garan...|2023-02-16 09:31:...|         2|                    1|       2|      2|       0|    0|         320.0|  2023-04-22|  2023-04-24|             160.0|              80.0|                80.0|                           65|\n|              normal|     444|   1591435|        Espanha|     Cancelado|   2073|              Duplo |              normal|2022-09-18 14:58:...|         2|                    1|       2|      2|       0|    0|         160.0|  2022-10-10|  2022-10-12|              80.0|              40.0|                40.0|                           22|\n|      non-refundable|     179|   1716373|          Suiça|     Registado|   1766|  Suite Comfort Plus|  no reembolsable 13|2023-04-09 16:51:...|         7|                    1|       2|      2|       0|    0|       1652.13|  2023-05-20|  2023-05-27|236.01857142857145|118.00928571428572|  118.00928571428572|                           41|\n|         tarifa site|     304|   1618986|       Alemanha|    Modificada|   1357|203 - Quarto Dupl...|         tarifa site|2022-11-02 08:06:...|         1|                    1|       1|      2|       0|    0|         62.56|  2022-11-08|  2022-11-09|             62.56|             31.28|               62.56|                            6|\n|      non-refundable|     415|   1557259|       Portugal|     Registado|   1940|               Duplo|      non refundable|2022-07-30 08:33:...|         1|                    1|       2|      2|       1|    0|         126.0|  2022-08-02|  2022-08-03|             126.0|              63.0|                63.0|                            3|\n|              normal|     444|   1676254| Estados Unidos|     Cancelado|   2076|               Suite|              normal|2023-02-11 16:00:...|         3|                    1|       2|      2|       2|    0|         540.0|  2023-07-19|  2023-07-22|             180.0|              90.0|                90.0|                          158|\n|             website|     535|   1460035|       Portugal|      Pendente|   2523|        Quarto Duplo|             website|2022-03-27 14:26:...|         2|                    1|       2|      2|       0|    0|         117.0|  2022-04-06|  2022-04-08|              58.5|             29.25|               29.25|                           10|\n|                 bar|     504|   1449596|        Espanha|     Registado|   2378|       Cela Sæculare|                 bar|2022-03-10 15:14:...|         1|                    1|       1|      1|       0|    0|        58.995|  2022-03-16|  2022-03-17|            58.995|            58.995|              58.995|                            6|\n|              normal|     319|   1634159|       Portugal|     Cancelado|   2877|     Quarto Familiar|           normal bb|2022-11-30 19:35:...|         1|                    1|       2|      2|       0|    0|         102.5|  2022-12-10|  2022-12-11|             102.5|             51.25|               51.25|                           10|\n|      non-refundable|     310|   1575975|       Portugal|  NãoRegistado|   1673|Quarto Duplo Supe...| early booking 30 nr|2022-08-25 21:33:...|         1|                    2|       2|      4|       0|    0|        110.88|  2022-09-24|  2022-09-25|            110.88|             27.72|               55.44|                           30|\n|                 bar|     483|   1455453|       Portugal|     Registado|   2288|Tryp Double Stand...|bp1  bar prepayme...|2022-03-20 19:39:...|         1|                    1|       2|      2|       0|    0|149.8199999999|  2022-03-26|  2022-03-27|    149.8199999999|    74.90999999995|      74.90999999995|                            6|\n|              normal|     179|   1686742|         França|     Registado|    630|      Duplo  Comfort|         tarifa base|2023-02-27 14:56:...|         1|                    1|       2|      2|       0|    0|         184.9|  2023-04-13|  2023-04-14|             184.9|             92.45|               92.45|                           45|\n|        mr main rate|     311|   1647071|     Luxemburgo|     Registado|   1407|DB - Quarto Duplo...|       mr  main rate|2022-12-29 14:46:...|         1|                    1|       2|      2|       0|    0|         57.33|  2023-01-06|  2023-01-07|             57.33|            28.665|              28.665|                            8|\n|             website|     556|   1599385|       Portugal|      Pendente|   2831|Double Room Standard|web best availabl...|2022-09-30 14:03:...|         1|                    2|       2|      4|       0|    0|         115.6|  2022-09-30|  2022-10-01|             115.6|              28.9|                57.8|                            0|\n|                 bar|     358|   1718787| Estados Unidos|     Registado|   1745|Suite Deluxe com ...|                 bar|2023-04-12 15:03:...|         6|                    1|       2|      2|       0|    0|        2022.0|  2023-09-15|  2023-09-21|             337.0|             168.5|               168.5|                          156|\n|                 bar|     426|   1565600|        Espanha|     Registado|   1990|       Twin Standard|                 bar|2022-08-10 10:29:...|         1|                    1|       2|      2|       0|    0|         115.0|  2022-08-16|  2022-08-17|             115.0|              57.5|                57.5|                            6|\n|             website|     556|   1424809|       Portugal|      Pendente|   2847|Double Room w/ext...|web best availabl...|2022-01-21 10:54:...|         2|                    1|       2|      2|       1|    0|         144.5|  2022-02-06|  2022-02-08|             72.25|            36.125|              36.125|                           16|\n|              normal|     314|   1555453|       Portugal|     Registado|   1380|               Duplo|            standard|2022-07-27 18:05:...|         3|                    1|       2|      2|       0|    0|         270.0|  2022-08-21|  2022-08-24|              90.0|              45.0|                45.0|                           25|\n|             website|     328|   1479341|         França|     Registado|   1450|6 Bed Mixed Dormi...|             website|2022-04-22 14:27:...|         6|                    1|       1|      1|       0|    0|        111.72|  2022-06-03|  2022-06-09|             18.62|             18.62|               18.62|                           42|\n|        mr main rate|     311|   1616974|       Portugal|     Registado|   2034|DBS - Quarto Dupl...|       mr  main rate|2022-10-29 09:17:...|         1|                    2|       2|      4|       0|    0|         147.0|  2022-11-11|  2022-11-12|             147.0|             36.75|                73.5|                           13|\n|             website|     556|   1714127|       Portugal|     Registado|   2832|  Twin Room Standard|web best availabl...|2023-04-05 20:41:...|         2|                    1|       2|      2|       0|    0|         158.1|  2023-04-07|  2023-04-09|             79.05|            39.525|              39.525|                            2|\n|              normal|     179|   1682714|       Alemanha|     Registado|    632|        King Comfort|         tarifa base|2023-02-21 14:09:...|         6|                    1|       1|      1|       0|    0|       608.193|  2023-03-16|  2023-03-22|          101.3655|          101.3655|            101.3655|                           23|\n|      non-refundable|     311|   1558712|       Alemanha|     Registado|   1407|DB - Quarto Duplo...|               nr bb|2022-08-01 09:42:...|         1|                    1|       1|      1|       0|    0| 87.8799999999|  2022-08-15|  2022-08-16|     87.8799999999|     87.8799999999|       87.8799999999|                           14|\n|              dbs bb|     311|   1523895|      Austrália|  NãoRegistado|   2034|DBS - Quarto Dupl...|              dbs bb|2022-06-19 04:38:...|         1|                    1|       1|      1|       0|    0|          86.5|  2022-06-24|  2022-06-25|              86.5|              86.5|                86.5|                            5|\n|      non-refundable|     514|   1422614|       Portugal|     Registado|   2425|     Eco Garden Room|       no refundable|2022-01-15 09:56:...|         2|                    1|       2|      2|       0|    0|         207.0|  2022-01-16|  2022-01-18|             103.5|             51.75|               51.75|                            1|\n|        mr main rate|     310|   1709808|       Portugal|    Modificada|   1674|Quarto Twin Superior|       mr  main rate|2023-03-31 13:53:...|         1|                    1|       2|      2|       0|    0|         52.25|  2023-04-13|  2023-04-14|             52.25|            26.125|              26.125|                           13|\n|             website|     482|   1703743|       Portugal|     Cancelado|   2285|      Apartamento T1|web best availabl...|2023-03-23 11:44:...|         2|                    1|       2|      2|       0|    0|         161.5|  2023-04-07|  2023-04-09|             80.75|            40.375|              40.375|                           15|\n|        mr main rate|     310|   1690961|         Brasil|  NãoRegistado|   1424|Quarto Twin Standard|       mr  main rate|2023-03-05 14:59:...|         4|                    1|       2|      2|       0|    0|        239.59|  2023-05-13|  2023-05-17|           59.8975|          29.94875|            29.94875|                           69|\n|        mr main rate|     309|   1640273|         França|  NãoRegistado|   1372|Quarto Duplo Stan...|       mr  main rate|2022-12-13 15:31:...|         5|                    1|       2|      2|       0|    0|         245.0|  2023-01-09|  2023-01-14|              49.0|              24.5|                24.5|                           27|\n|            duplo bb|     311|   1505402|         França|  NãoRegistado|   1407|DB - Quarto Duplo...|            duplo bb|2022-05-26 12:07:...|         1|                    1|       2|      2|       0|    0|          99.0|  2022-07-24|  2022-07-25|              99.0|              49.5|                49.5|                           59|\n|              normal|     444|   1703498|       Portugal|     Registado|   2073|              Duplo |              normal|2023-03-22 22:48:...|         1|                    1|       2|      2|       0|    0|          80.0|  2023-03-25|  2023-03-26|              80.0|              40.0|                40.0|                            3|\n|                 bar|     349|   1559537|       Portugal|     Registado|   1552|        Quarto Duplo|                 bar|2022-08-02 08:47:...|         1|                    1|       1|      1|       0|    0|          89.0|  2022-08-05|  2022-08-06|              89.0|              89.0|                89.0|                            3|\n|             website|     535|   1597863|       Portugal|     Registado|   2523|        Quarto Duplo|             website|2022-09-28 10:09:...|         3|                    1|       2|      2|       0|    0|         175.5|  2022-10-11|  2022-10-14|              58.5|             29.25|               29.25|                           13|\n|             website|     535|   1491988|       Portugal|     Cancelado|   2523|        Quarto Duplo|             website|2022-05-09 19:42:...|         2|                    1|       2|      2|       0|    0|         135.0|  2022-05-22|  2022-05-24|              67.5|             33.75|               33.75|                           13|\n|              normal|     444|   1638259|       Portugal|    Modificada|   2074|Duplo   Vista Mar...|              normal|2022-12-09 09:04:...|         1|                    1|       2|      2|       0|    0|          90.0|  2022-12-10|  2022-12-11|              90.0|              45.0|                45.0|                            1|\n|      non-refundable|     514|   1568806|       Portugal|     Cancelado|   2425|     Eco Garden Room|       no refundable|2022-08-15 13:03:...|         2|                    1|       1|      1|       0|    0|         243.0|  2022-08-20|  2022-08-22|             121.5|             121.5|               121.5|                            5|\n|              normal|     560|   1486912|       Alemanha|     Registado|   2866|         Estúdio 2+1|            standard|2022-05-03 07:35:...|         3|                    1|       2|      2|       0|    0|         345.0|  2022-09-01|  2022-09-04|             115.0|              57.5|                57.5|                          121|\n|                 bar|     426|   1690284|       Portugal|     Registado|   1991|Duplo Premium - C...|                 bar|2023-03-04 13:20:...|         1|                    1|       2|      2|       1|    0|         110.0|  2023-04-09|  2023-04-10|             110.0|              55.0|                55.0|                           36|\n|                 bar|     539|   1680097|       Portugal|     Registado|   2542|Quarto Dpl. Standard|                 bar|2023-02-17 10:57:...|         1|                    1|       1|      1|       0|    0|          90.0|  2023-02-19|  2023-02-20|              90.0|              90.0|                90.0|                            2|\n|                 bar|     503|   1497323|        Holanda|     Registado|   2784|Individual Econom...|              bar ro|2022-05-16 07:35:...|         1|                    1|       1|      1|       0|    0|          45.0|  2022-05-16|  2022-05-17|              45.0|              45.0|                45.0|                            0|\n|        main rate bb|     311|   1608611|         Itália|  NãoRegistado|   1407|DB - Quarto Duplo...|        main rate bb|2022-10-14 15:32:...|         1|                    1|       1|      1|       0|    0|        63.945|  2022-11-01|  2022-11-02|            63.945|            63.945|              63.945|                           18|\n|      non-refundable|     311|   1523938|        Holanda|     Registado|   2159|SUT - Quarto Premium|      premium bb nrf|2022-06-19 08:40:...|         1|                    1|       1|      1|       0|    0|         110.5|  2022-06-24|  2022-06-25|             110.5|             110.5|               110.5|                            5|\n|              normal|     259|   1514237|        Espanha|     Registado|   1103|            Standard|              normal|2022-06-06 16:58:...|         1|                    2|       2|      4|       0|    0|         250.0|  2022-09-23|  2022-09-24|             250.0|              62.5|               125.0|                          109|\n|      non-refundable|     321|   1497199|       Portugal|     Registado|   1410|         Quarto Twin|bar no refundable...|2022-05-15 22:39:...|         2|                    1|       2|      2|       0|    0|         155.0|  2022-06-10|  2022-06-12|              77.5|             38.75|               38.75|                           26|\n|                  4n|     560|   1659621|        Holanda|     Registado|   2869|    Estudio Familiar|                  4n|2023-01-19 08:44:...|         4|                    1|       3|      3|       0|    0|         441.0|  2023-09-27|  2023-10-01|            110.25|             36.75|               36.75|                          251|\n|        mr main rate|     310|   1656419|       Portugal|  NãoRegistado|   1395|Quarto Duplo Stan...|       mr  main rate|2023-01-14 12:34:...|         1|                    1|       2|      2|       0|    0|          44.1|  2023-01-28|  2023-01-29|              44.1|             22.05|               22.05|                           14|\n|        main rate bb|     311|   1599923|       Portugal|     Registado|   1429|TW - Quarto Twin ...|        main rate bb|2022-10-01 14:05:...|         1|                    1|       1|      1|       0|    0|        85.995|  2022-10-02|  2022-10-03|            85.995|            85.995|              85.995|                            1|\n|                 bar|     426|   1606408|       Portugal|     Registado|   1995|Duplo Standard - ...|                 bar|2022-10-11 15:29:...|         1|                    2|       2|      4|       0|    0|         119.0|  2022-10-14|  2022-10-15|             119.0|             29.75|                59.5|                            3|\n|                 bar|     539|   1631480|       Portugal|     Registado|   2542|Quarto Dpl. Standard|                 bar|2022-11-25 23:06:...|         1|                    1|       1|      1|       0|    0|          55.0|  2022-12-08|  2022-12-09|              55.0|              55.0|                55.0|                           13|\n|reembolsvel suple...|     322|   1529106|       Portugal|     Registado|   2259|                Twin|reembolsvel suple...|2022-06-26 12:28:...|         1|                    2|       2|      4|       0|    0|         170.0|  2022-06-26|  2022-06-27|             170.0|              42.5|                85.0|                            0|\n|      non-refundable|     311|   1603868|       Portugal|  NãoRegistado|   1429|TW - Quarto Twin ...|                  nr|2022-10-07 11:48:...|         1|                    1|       2|      2|       0|    0|         85.75|  2022-10-10|  2022-10-11|             85.75|            42.875|              42.875|                            3|\n|                 bar|     413|   1475867|       Portugal|     Registado|   1913|Quarto Twin / Dup...|                 bar|2022-04-17 14:39:...|         1|                    1|       2|      2|       1|    1|         112.0|  2022-04-18|  2022-04-19|             112.0|              56.0|                56.0|                            1|\n|                 bar|     426|   1448952|       Portugal|     Registado|   1991|Duplo Premium - C...|                 bar|2022-03-09 11:36:...|         3|                    1|       2|      2|       0|    1|         280.0|  2022-04-14|  2022-04-17| 93.33333333333333|46.666666666666664|  46.666666666666664|                           36|\n|        mr main rate|     311|   1677094|       Portugal|    Modificada|   1407|DB - Quarto Duplo...|       mr  main rate|2023-02-12 21:47:...|         1|                    1|       2|      2|       0|    0|          63.7|  2023-02-13|  2023-02-14|              63.7|             31.85|               31.85|                            1|\n|        mr main rate|     311|   1660614|       Portugal|     Registado|   1407|DB - Quarto Duplo...|       mr  main rate|2023-01-20 15:14:...|         1|                    2|       1|      2|       0|    0|        114.66|  2023-02-02|  2023-02-03|            114.66|             57.33|              114.66|                           13|\n|              normal|     319|   1622362|         Itália|     Registado|   2890|          City Duplo|           normal bb|2022-11-08 10:05:...|         2|                    2|       1|      2|       0|    0|         308.0|  2022-11-16|  2022-11-18|             154.0|              77.0|               154.0|                            8|\n|        mr main rate|     311|   1652411|    Reino Unido|     Cancelado|   1407|DB - Quarto Duplo...|       mr  main rate|2023-01-08 12:44:...|         1|                    1|       2|      2|       0|    0|          63.7|  2023-01-08|  2023-01-09|              63.7|             31.85|               31.85|                            0|\n|               promo|     490|   1510225|       Portugal|     Registado|   2799| Apartamento estúdio|    promoo dia da me|2022-06-01 09:38:...|         2|                    1|       2|      2|       0|    0|         190.0|  2022-06-16|  2022-06-18|              95.0|              47.5|                47.5|                           15|\n|             website|     556|   1684485|       Portugal|      Pendente|   2833|Triple Room Standard|web best availabl...|2023-02-24 10:15:...|         1|                    1|       3|      3|       0|    0|         102.0|  2023-04-01|  2023-04-02|             102.0|              34.0|                34.0|                           36|\n+--------------------+--------+----------+---------------+--------------+-------+--------------------+--------------------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+------------------+------------------+--------------------+-----------------------------+\nonly showing top 100 rows\n\n24955\nimport org.apache.spark.sql.DataFrame\nimport org.apache.spark.sql.functions._\nimport spark.implicits._\n\u001b[1m\u001b[34mjoinFolder\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /data/joins\n\u001b[1m\u001b[34msaveJoins\u001b[0m: \u001b[1m\u001b[32mBoolean\u001b[0m = false\n\u001b[1m\u001b[34msaveDataFrame\u001b[0m: \u001b[1m\u001b[32m(df: org.apache.spark.sql.DataFrame, name: String)Unit\u001b[0m\n\u001b[1m\u001b[34minitialCount\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [rate_plan_normalized: string, hotel_ID: int ... 20 more fields]\n"
     }
    ]
   }
  },
  {
   "user": "anonymous",
   "config": {
    "colWidth": 12,
    "fontSize": 9,
    "enabled": true,
    "results": {},
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "editorMode": "ace/mode/scala"
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": []
       },
       {
        "columns": []
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "jobName": "paragraph_1563110258183_1613653816",
   "id": "20190714-161738_1950435706",
   "dateCreated": "2019-07-14T16:17:38+0300",
   "status": "FINISHED",
   "progressUpdateIntervalMs": 500,
   "focus": true,
   "$$hashKey": "object:394",
   "text": "val joinTipologia = spark.sql(\n    \"\"\"\n       SELECT DISTINCT \n           Q.hotel_ID, \n           Q.Reserve_ID,\n           Q.pais,\n           Q.estado_reserva,\n           Q.room_ID,\n           Q.tipo_quarto AS Q_tipo_quarto,\n           Q.rate_plan,\n           Q.data_reserva,\n           Q.data_chegada,\n           Q.data_partida,\n           Q.num_noites,\n           Q.ocupacao,\n           Q.adultos,\n           Q.criancas,\n           Q.bebes,\n           Q.preco_euros,\n           T.tipo_quarto as T_tipo_quarto, \n           T.quantidade,\n           T.capacidade_maxima,\n           T.capacidade_max_adultos,\n           T.capacidade_max_criancas,\n           T.capacidade_max_bebes\n       FROM QuartosReservados as Q\n       Inner JOIN Tipologias as T\n           ON Q.hotel_ID = T.hotel_ID AND T.room_ID = Q.room_ID\n      \"\"\")\n\nval joinTipologiaNotExists = spark.sql(\n    \"\"\"\n        SELECT *\n        FROM QuartosReservados\n        WHERE NOT EXISTS (\n           SELECT *\n           FROM Tipologias\n           WHERE QuartosReservados.hotel_ID = Tipologias.hotel_ID AND \n           QuartosReservados.room_ID = Tipologias.room_ID\n        )\n      \"\"\")\njoinTipologiaNotExists.show();\n\n\njoinTipologia.createOrReplaceTempView(\"JoinTipologia\")\njoinTipologia.cache()\n\nif (saveJoins)\n    saveDataFrame(joinTipologia, \"joinTipologia\")\n\nprintln(joinTipologia.count())\njoinTipologia.printSchema()",
   "dateStarted": "2023-05-16 21:59:31.498",
   "dateUpdated": "2023-05-16 21:59:32.923",
   "dateFinished": "2023-05-16 21:59:32.923",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+--------+----------+--------+--------------+-------+--------------------+---------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+----+----+----+----+----+----+----+----+----+----+----+----+----+------------+------------+-----------------+------------------+--------------------+\n|hotel_ID|Reserve_ID|    pais|estado_reserva|room_ID|         tipo_quarto|rate_plan|        data_reserva|num_noites|Quantidade de quartos|ocupacao|adultos|criancas|bebes|   preco_euros|_c17|_c18|_c19|_c20|_c21|_c22|_c23|_c24|_c25|_c26|_c27|_c28|_c29|data_chegada|data_partida|      preco_noite|preco_noite_adulto|preco_noite_ocupacao|\n+--------+----------+--------+--------------+-------+--------------------+---------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+----+----+----+----+----+----+----+----+----+----+----+----+----+------------+------------+-----------------+------------------+--------------------+\n|     309|   1444879|Portugal|     Registado|   2802|Quarto Twin Standard|    PROMO|2022-03-01 21:17:...|         2|                    1|       2|      2|       0|    0| 77.3999999999|null|null|null|null|null|null|null|null|null|null|null|null|null|  2022-03-11|  2022-03-13|   38.69999999995|   19.349999999975|     19.349999999975|\n|     309|   1442562|Portugal|     Cancelado|   2802|Quarto Twin Standard|    PROMO|2022-02-25 16:06:...|         1|                    1|       2|      2|       0|    0|          43.0|null|null|null|null|null|null|null|null|null|null|null|null|null|  2022-02-25|  2022-02-26|             43.0|              21.5|                21.5|\n|     309|   1441490|Portugal|     Cancelado|   2802|Quarto Twin Standard|    PROMO|2022-02-23 16:10:...|         1|                    1|       2|      2|       0|    0|          43.0|null|null|null|null|null|null|null|null|null|null|null|null|null|  2022-02-23|  2022-02-24|             43.0|              21.5|                21.5|\n|     309|   1441490|Portugal|     Cancelado|   2802|Quarto Twin Standard|    PROMO|2022-02-23 16:10:...|         1|                    1|       2|      2|       0|    0|          43.0|null|null|null|null|null|null|null|null|null|null|null|null|null|  2022-03-19|  2022-03-20|             43.0|              21.5|                21.5|\n|     309|   1441186|Portugal|     Registado|   2802|Quarto Twin Standard|    PROMO|2022-02-22 22:43:...|         1|                    1|       2|      2|       0|    0|          43.0|null|null|null|null|null|null|null|null|null|null|null|null|null|  2022-02-26|  2022-02-27|             43.0|              21.5|                21.5|\n|     309|   1440314| Espanha|  NãoRegistado|   2802|Quarto Twin Standard|    PROMO|2022-02-21 16:44:...|         3|                    1|       2|      2|       0|    0|128.9999999999|null|null|null|null|null|null|null|null|null|null|null|null|null|  2022-02-22|  2022-02-25|42.99999999996667|21.499999999983334|  21.499999999983334|\n|     309|   1438484|Portugal|    Modificada|   2802|Quarto Twin Standard|    PROMO|2022-02-18 12:14:...|         3|                    1|       2|      2|       0|    0|128.9999999999|null|null|null|null|null|null|null|null|null|null|null|null|null|  2022-02-18|  2022-02-21|42.99999999996667|21.499999999983334|  21.499999999983334|\n|     309|   1438425|Portugal|    Modificada|   2802|Quarto Twin Standard|    PROMO|2022-02-18 10:48:...|         1|                    1|       2|      2|       0|    0|          38.7|null|null|null|null|null|null|null|null|null|null|null|null|null|  2022-02-19|  2022-02-20|             38.7|             19.35|               19.35|\n+--------+----------+--------+--------------+-------+--------------------+---------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+----+----+----+----+----+----+----+----+----+----+----+----+----+------------+------------+-----------------+------------------+--------------------+\n\n24947\nroot\n |-- hotel_ID: integer (nullable = true)\n |-- Reserve_ID: integer (nullable = true)\n |-- pais: string (nullable = true)\n |-- estado_reserva: string (nullable = true)\n |-- room_ID: integer (nullable = true)\n |-- Q_tipo_quarto: string (nullable = true)\n |-- rate_plan: string (nullable = true)\n |-- data_reserva: timestamp (nullable = true)\n |-- data_chegada: date (nullable = true)\n |-- data_partida: date (nullable = true)\n |-- num_noites: integer (nullable = true)\n |-- ocupacao: integer (nullable = true)\n |-- adultos: integer (nullable = true)\n |-- criancas: integer (nullable = true)\n |-- bebes: integer (nullable = true)\n |-- preco_euros: double (nullable = true)\n |-- T_tipo_quarto: string (nullable = true)\n |-- quantidade: integer (nullable = true)\n |-- capacidade_maxima: integer (nullable = true)\n |-- capacidade_max_adultos: integer (nullable = true)\n |-- capacidade_max_criancas: integer (nullable = true)\n |-- capacidade_max_bebes: integer (nullable = true)\n\n\u001b[1m\u001b[34mjoinTipologia\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 20 more fields]\n\u001b[1m\u001b[34mjoinTipologiaNotExists\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 31 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {},
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": []
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinTipologiaAndHotel = spark.sql(\n    \"\"\"\n       SELECT \n           J.*,\n           H.localizacao,\n           H.area_localizacao,\n           H.estrelas,\n           H.idade_max_criancas,\n           H.idade_max_bebes,\n           H.hora_max_checkin,\n           H.qtd_quartos\n       FROM joinTipologia as J\n       INNER JOIN Hotel as H\n           ON J.hotel_ID = H.hotel_ID\n    \"\"\")\n\njoinTipologiaAndHotel.createOrReplaceTempView(\"JoinTipologiaAndHotel\")\n\nprintln(joinTipologiaAndHotel.count())\n//joinTipologiaAndHotel.printSchema()\nif (saveJoins)\n    saveDataFrame(joinTipologiaAndHotel, \"joinTipologiaAndHotel\")",
   "id": "",
   "dateCreated": "2023-04-30 20:01:48.781",
   "config": {
    "tableHide": false
   },
   "dateStarted": "2023-05-16 21:59:32.924",
   "dateUpdated": "2023-05-16 21:59:35.708",
   "dateFinished": "2023-05-16 21:59:35.708",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n\u001b[1m\u001b[34mjoinTipologiaAndHotel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 27 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {},
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": []
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinFeriados = spark.sql(\n    \"\"\"\n        SELECT J.*, F.is_holiday\n        FROM JoinTipologiaAndHotel AS J\n        LEFT JOIN (SELECT * FROM Feriados WHERE is_holiday=1) AS F\n            ON F.date <= J.data_partida AND f.date >= data_chegada\n    \"\"\"\n)\njoinFeriados = joinFeriados.na.fill(0, Seq(\"is_holiday\"))\n\njoinFeriados.createOrReplaceTempView(\"JoinFeriados\")\n\nprintln(joinFeriados.count())\n\njoinFeriados.show()",
   "id": "",
   "dateCreated": "2023-04-30 20:12:14.191",
   "config": {
    "tableHide": false
   },
   "dateStarted": "2023-05-16 21:59:35.709",
   "dateUpdated": "2023-05-16 21:59:37.619",
   "dateFinished": "2023-05-16 21:59:37.619",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "25213\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|preco_euros|       T_tipo_quarto|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\n|     503|   1722075|        Brasil|     Registado|   2785|Duplo Economico T...|             BAR APA|2023-04-16 22:43:...|  2023-06-12|  2023-06-16|         4|       2|      2|       0|    0|      340.0|Duplo Economico T...|        64|                2|                     2|                      0|                   0|              Aveiro|          Aveiro|       3|                10|             36|2023-05-16 23:00:00|        187|         0|\n|     482|   1720759|      Portugal|     Registado|   2285|      Apartamento T1|(WEB) Non-refunda...|2023-04-15 07:48:...|  2023-04-15|  2023-04-16|         1|       3|      3|       0|    0|      70.68|      Apartamento T1|        90|                4|                     4|                      3|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-16 23:59:00|        143|         0|\n|     311|   1720055|        Itália|     Registado|   2034|DBS - Quarto Dupl...|      MR - Main Rate|2023-04-14 07:06:...|  2023-04-17|  2023-04-18|         1|       2|      2|       0|    0|      90.25|DBS - Quarto Dupl...|         5|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|\n|     514|   1715174|   Reino Unido|     Cancelado|   2425|     Eco Garden Room|   Non-Refundable >5|2023-04-07 11:59:...|  2023-06-17|  2023-06-22|         5|       2|      2|       0|    0|      580.0|     Eco Garden Room|         4|                2|                     2|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-16 18:00:00|         13|         0|\n|     556|   1715161|      Portugal|      Pendente|   2831|Double Room Standard|WEB (Best Availab...|2023-04-07 11:45:...|  2023-04-22|  2023-04-23|         1|       2|      2|       0|    1|      72.25|Double Room Standard|        45|                3|                     2|                      0|                   1|             Covilhã|  Castelo Branco|       3|                10|              3|2023-05-16 23:00:00|         84|         0|\n|     556|   1711558|      Portugal|      Pendente|   2831|Double Room Standard|WEB (Best Availab...|2023-04-02 21:17:...|  2023-04-06|  2023-04-09|         3|       2|      2|       0|    0|      215.9|Double Room Standard|        45|                3|                     2|                      0|                   1|             Covilhã|  Castelo Branco|       3|                10|              3|2023-05-16 23:00:00|         84|         1|\n|     556|   1711558|      Portugal|      Pendente|   2831|Double Room Standard|WEB (Best Availab...|2023-04-02 21:17:...|  2023-04-06|  2023-04-09|         3|       2|      2|       0|    0|      215.9|Double Room Standard|        45|                3|                     2|                      0|                   1|             Covilhã|  Castelo Branco|       3|                10|              3|2023-05-16 23:00:00|         84|         1|\n|     319|   1711236|       Bélgica|     Registado|   1416|               Suite|         Normal (RO)|2023-04-02 16:20:...|  2023-08-20|  2023-08-23|         3|       2|      2|       0|    0|      352.5|               Suite|         2|                2|                     2|                      0|                   0|              Aveiro|          Aveiro|       3|                12|             24|2023-05-16 23:59:00|         96|         0|\n|     311|   1709937|        Itália|      Pendente|   2034|DBS - Quarto Dupl...|      MR - Main Rate|2023-03-31 16:43:...|  2023-04-14|  2023-04-15|         1|       2|      4|       0|    0|      171.0|DBS - Quarto Dupl...|         5|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|\n|     310|   1709380|      Portugal|    Modificada|   1673|Quarto Duplo Supe...|      MR - Main Rate|2023-03-30 21:08:...|  2023-04-01|  2023-04-02|         1|       2|      2|       0|    0|    50.6825|Quarto Duplo Supe...|        63|                2|                     2|                      1|                   0|                Gaia|           Porto|       3|                 0|              0|2023-05-16 23:59:00|        192|         0|\n|     539|   1708305|      Portugal|    Confirmado|   2542|Quarto Dpl. Standard|                 Bar|2023-03-29 15:13:...|  2023-04-07|  2023-04-09|         2|       1|      1|       0|    0|      170.0|Quarto Dpl. Standard|         5|                2|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-16 18:00:00|         58|         1|\n|     539|   1708305|      Portugal|    Confirmado|   2542|Quarto Dpl. Standard|                 Bar|2023-03-29 15:13:...|  2023-04-07|  2023-04-09|         2|       1|      1|       0|    0|      170.0|Quarto Dpl. Standard|         5|                2|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-16 18:00:00|         58|         1|\n|     309|   1707106|    Luxemburgo|     Registado|   1372|Quarto Duplo Stan...|      MR - Main Rate|2023-03-27 22:34:...|  2023-03-27|  2023-03-28|         1|       2|      2|       0|    0|       47.5|Quarto Duplo Stan...|        10|                2|                     2|                      1|                   0|             Valongo|           Porto|       3|                12|              4|2023-05-16 23:59:00|         41|         0|\n|     319|   1705435|       Espanha|     Registado|   2890|          City Duplo|         Normal (RO)|2023-03-25 20:05:...|  2023-04-08|  2023-04-09|         1|       2|      2|       0|    0|       73.5|          City Duplo|        13|                2|                     2|                      0|                   0|              Aveiro|          Aveiro|       3|                12|             24|2023-05-16 23:59:00|         96|         1|\n|     273|   1704694|       Espanha|     Registado|   1235|           Rosmarine|              Normal|2023-03-24 16:59:...|  2023-07-14|  2023-07-16|         2|       2|      2|       0|    0|      450.0|           Rosmarine|         1|                2|                     2|                      0|                   0|    Seixas - Caminha|Viana do Castelo|       0|                 0|              0|2023-05-16 12:00:00|         14|         0|\n|     309|   1697270|      Portugal|     Registado|   2254|Quarto Duplo Supe...|      MR - Main Rate|2023-03-14 12:18:...|  2023-06-01|  2023-06-04|         3|       2|      2|       0|    0|    189.829|Quarto Duplo Supe...|         8|                2|                     2|                      1|                   0|             Valongo|           Porto|       3|                12|              4|2023-05-16 23:59:00|         41|         0|\n|     310|   1693127|      Portugal|     Registado|   1673|Quarto Duplo Supe...|      MR - Main Rate|2023-03-08 10:54:...|  2023-03-29|  2023-04-02|         4|       1|      1|       0|    0|   216.5525|Quarto Duplo Supe...|        63|                2|                     2|                      1|                   0|                Gaia|           Porto|       3|                 0|              0|2023-05-16 23:59:00|        192|         0|\n|     358|   1692359|Estados Unidos|     Registado|   1745|Suite Deluxe com ...|                 BAR|2023-03-07 09:15:...|  2023-04-21|  2023-04-28|         7|       2|      2|       0|    0|     2329.0|Suite Deluxe com ...|         1|                2|                     2|                      0|                   0|               Porto|           Porto|       0|                12|              2|2023-05-16 23:59:00|         10|         1|\n|     366|   1692243|      Portugal|     Registado|   1652|     QUARTO FAMILIAR|      Non Refundable|2023-03-06 23:15:...|  2023-03-11|  2023-03-12|         1|       2|      2|       2|    0|       95.4|     QUARTO FAMILIAR|         4|                4|                     2|                      2|                   1|      Castelo Branco|  Castelo Branco|       4|                12|              2|2023-05-16 23:59:00|         71|         0|\n|     185|   1687655|        Israel|    Modificada|    721|               Suite|                 BAR|2023-02-28 16:35:...|  2023-06-02|  2023-06-05|         3|       2|      2|       0|    0|      675.0|               Suite|         1|                4|                     4|                      2|                   1|   Valdigem - Lamego|          Chaves|       4|                12|             36|2023-05-16 23:00:00|         20|         0|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinFeriados\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 28 more fields]\njoinFeriados: org.apache.spark.sql.DataFrame = [hotel_ID: int, Reserve_ID: int ... 28 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {}
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinFeriadosGrouped = spark.sql(\n    \"\"\"\n        SELECT \n            hotel_ID,  Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, max(is_holiday) AS is_holiday\n        FROM JoinFeriados\n        GROUP BY hotel_ID, Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos\n    \"\"\"\n)\n\njoinFeriadosGrouped.createOrReplaceTempView(\"JoinFeriadosGrouped\")\n\nprintln(joinFeriadosGrouped.count())\njoinFeriadosGrouped.show()",
   "id": "",
   "dateCreated": "2023-05-16 20:45:38.018",
   "config": {},
   "dateStarted": "2023-05-16 21:59:37.620",
   "dateUpdated": "2023-05-16 21:59:49.120",
   "dateFinished": "2023-05-16 21:59:49.120",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|   preco_euros|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\n|     504|   1679437|        França|    Modificada|   2378|       Cela Sæculare|       Cela Sæculare|                 Bar|2023-02-16 09:56:...|  2023-03-08|  2023-03-14|         6|       1|      1|       0|    0|         387.6|        13|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-16 23:59:00|         27|         0|\n|     311|   1424074|      Portugal|    Modificada|   1407|DB - Quarto Duplo...|DB - Quarto Duplo...|           DB BB NRF|2022-01-19 11:54:...|  2022-01-19|  2022-01-20|         1|       1|      2|       0|    0|         126.9|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|\n|     378|   1539793|   Reino Unido|     Registado|   1738|Duplo ou Twin Sta...|Duplo ou Twin Sta...|Tarifa Não Reembo...|2022-07-10 19:44:...|  2022-09-16|  2022-09-18|         2|       2|      2|       0|    0|         153.4|         7|                2|                     2|                      1|                   1|             Batalha|         Batalha|       3|                12|             24|2023-05-16 23:30:00|         23|         0|\n|     514|   1718489|       Holanda|    Modificada|   2494|           Pool Room|           Pool Room|   Non-Refundable >5|2023-04-12 09:36:...|  2023-07-08|  2023-07-22|        14|       2|      2|       0|    0|        2296.0|         5|                3|                     3|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-16 18:00:00|         13|         0|\n|     311|   1704628|   Reino Unido|  NãoRegistado|   1429|TW - Quarto Twin ...|TW - Quarto Twin ...|      MR - Main Rate|2023-03-24 15:08:...|  2023-03-27|  2023-03-28|         1|       2|      2|       0|    0|        64.505|         4|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|\n|     304|   1517353|        França|     Registado|   1360|204 - Duplo Superior|204 - Duplo Superior|         Tarifa Site|2022-06-10 13:43:...|  2022-07-03|  2022-07-04|         1|       2|      2|       0|    0|          87.4|         1|                2|                     2|                      0|                   0|             Coimbra|         Coimbra|       0|                11|             23|2023-05-16 22:30:00|         28|         0|\n|     444|   1588542|Estados Unidos|     Registado|   2386| Twin vista  mar ...| Twin vista  mar ...|              Normal|2022-09-13 20:10:...|  2022-09-19|  2022-09-22|         3|       2|      2|       0|    0|         280.0|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|\n|     535|   1682395|      Portugal|     Cancelado|   2523|        Quarto Duplo|        Quarto Duplo|             WebSite|2023-02-20 21:39:...|  2023-03-31|  2023-04-02|         2|       2|      2|       0|    0|         144.0|         5|                3|                     2|                      1|                   1| Travanca do Mondego|         Coimbra|       4|                12|             24|2023-05-16 23:55:00|         11|         0|\n|     559|   1442334|      Alemanha|     Registado|   2860|Quarto Duplo ou Twin|Quarto Duplo ou Twin|                 BAR|2022-02-25 08:37:...|  2022-04-12|  2022-04-18|         6|       2|      2|       0|    0|         570.0|         9|                3|                     2|                      1|                   1|             Benafim|       Albufeira|       0|                11|             36|2023-05-16 18:00:00|         15|         1|\n|     379|   1431327|   Reino Unido|     Cancelado|   1742|T3 Vista Marina o...|T3 Vista Marina o...|                 BAR|2022-02-05 16:50:...|  2022-08-21|  2022-08-28|         7|       5|      5|       0|    0|        2683.8|         1|                6|                     6|                      3|                   2|               Lagos|           Lagos|       4|                10|             36|2023-05-16 18:00:00|         26|         0|\n|     319|   1693035|       Espanha|     Registado|   2890|          City Duplo|          City Duplo|         Normal (BB)|2023-03-08 07:59:...|  2023-04-21|  2023-04-23|         2|       2|      2|       0|    0|         159.5|        13|                2|                     2|                      0|                   0|              Aveiro|          Aveiro|       3|                12|             24|2023-05-16 23:59:00|         96|         0|\n|     328|   1622491|      Portugal|     Registado|   1450|6 Bed Mixed Dormi...|6 Bed Mixed Dormi...|             WebSite|2022-11-08 13:39:...|  2022-11-14|  2022-11-16|         2|       1|      1|       0|    0|         41.46|        18|                1|                     1|                      0|                   0|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-16 22:00:00|         56|         0|\n|     179|   1679618|        França|     Registado|    630|      Duplo  Comfort|      Duplo  Comfort|         Tarifa Base|2023-02-16 14:45:...|  2023-07-02|  2023-07-04|         2|       2|      2|       0|    0|         350.4|        27|                2|                     2|                      0|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         0|\n|     482|   1499529|         Suiça|     Registado|   2286|      Apartamento T2|      Apartamento T2|(WEB) Non-refunda...|2022-05-18 18:30:...|  2022-07-19|  2022-07-24|         5|       4|      4|       0|    0|839.3499999996|        43|                6|                     6|                      5|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-16 23:59:00|        143|         0|\n|     179|   1699349|Estados Unidos|     Registado|   1766|  Suite Comfort Plus|  Suite Comfort Plus|         Tarifa Base|2023-03-17 02:06:...|  2023-04-02|  2023-04-10|         8|       3|      3|       0|    0|       2209.95|         7|                3|                     3|                      2|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         1|\n|     443|   1462547|   Reino Unido|     Registado|   2061|   Clássico Standard|   Clássico Standard|              Normal|2022-03-30 17:01:...|  2022-04-01|  2022-04-04|         3|       2|      2|       0|    0|         489.0|        18|                2|                     2|                      0|                   0|             Cascais|      Carcavelos|       5|                12|             24|2023-05-16 23:59:00|         42|         0|\n|     516|   1543279|        França|     Registado|   2468|       Quarto Single|       Quarto Single|     Bar | ROOM ONLY|2022-07-15 11:01:...|  2022-07-26|  2022-07-27|         1|       1|      1|       0|    0|          65.0|         3|                1|                     1|                      0|                   0|            Portimão|           Lagos|       2|                12|             36|2023-05-16 23:00:00|         32|         0|\n|     444|   1682182|        Brasil|     Registado|   2073|              Duplo |              Duplo |              Normal|2023-02-20 17:15:...|  2023-04-21|  2023-04-23|         2|       1|      1|       1|    0|         220.0|        14|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|\n|     444|   1603917|      Portugal|    Modificada|   2074|Duplo   Vista Mar...|Duplo   Vista Mar...|              Normal|2022-10-07 13:00:...|  2022-11-05|  2022-11-06|         1|       2|      2|       0|    0|          80.0|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|\n|     179|   1530764|       Espanha|     Registado|    631|        Twin Comfort|        Twin Comfort|           Room Only|2022-06-28 14:07:...|  2022-07-05|  2022-07-07|         2|       2|      2|       0|    0|       251.424|         8|                2|                     2|                      0|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         0|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinFeriadosGrouped\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 28 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {},
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": []
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "val joinEventos = spark.sql(\n    \"\"\"\n        SELECT QR.*, E.*\n        FROM JoinFeriadosGrouped QR\n        LEFT JOIN Eventos E\n            ON QR.data_partida >= E.start_Date AND QR.data_chegada <= E.end_date\n            AND QR.area_localizacao = E.Location\n    \"\"\")\n\njoinEventos.createOrReplaceTempView(\"JoinEventos\")\n\nprintln(joinEventos.count())\njoinEventos.show()",
   "id": "",
   "dateCreated": "2023-04-30 20:16:51.675",
   "config": {},
   "dateStarted": "2023-05-16 21:59:49.121",
   "dateUpdated": "2023-05-16 21:59:59.466",
   "dateFinished": "2023-05-16 21:59:59.466",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24961\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------+-----+----------+--------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|   preco_euros|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|Location|Event|start_Date|end_date|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------+-----+----------+--------+\n|     504|   1679437|        França|    Modificada|   2378|       Cela Sæculare|       Cela Sæculare|                 Bar|2023-02-16 09:56:...|  2023-03-08|  2023-03-14|         6|       1|      1|       0|    0|         387.6|        13|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-16 23:59:00|         27|         0|    null| null|      null|    null|\n|     311|   1424074|      Portugal|    Modificada|   1407|DB - Quarto Duplo...|DB - Quarto Duplo...|           DB BB NRF|2022-01-19 11:54:...|  2022-01-19|  2022-01-20|         1|       1|      2|       0|    0|         126.9|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|    null| null|      null|    null|\n|     378|   1539793|   Reino Unido|     Registado|   1738|Duplo ou Twin Sta...|Duplo ou Twin Sta...|Tarifa Não Reembo...|2022-07-10 19:44:...|  2022-09-16|  2022-09-18|         2|       2|      2|       0|    0|         153.4|         7|                2|                     2|                      1|                   1|             Batalha|         Batalha|       3|                12|             24|2023-05-16 23:30:00|         23|         0|    null| null|      null|    null|\n|     514|   1718489|       Holanda|    Modificada|   2494|           Pool Room|           Pool Room|   Non-Refundable >5|2023-04-12 09:36:...|  2023-07-08|  2023-07-22|        14|       2|      2|       0|    0|        2296.0|         5|                3|                     3|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-16 18:00:00|         13|         0|    null| null|      null|    null|\n|     311|   1704628|   Reino Unido|  NãoRegistado|   1429|TW - Quarto Twin ...|TW - Quarto Twin ...|      MR - Main Rate|2023-03-24 15:08:...|  2023-03-27|  2023-03-28|         1|       2|      2|       0|    0|        64.505|         4|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|    null| null|      null|    null|\n|     304|   1517353|        França|     Registado|   1360|204 - Duplo Superior|204 - Duplo Superior|         Tarifa Site|2022-06-10 13:43:...|  2022-07-03|  2022-07-04|         1|       2|      2|       0|    0|          87.4|         1|                2|                     2|                      0|                   0|             Coimbra|         Coimbra|       0|                11|             23|2023-05-16 22:30:00|         28|         0|    null| null|      null|    null|\n|     444|   1588542|Estados Unidos|     Registado|   2386| Twin vista  mar ...| Twin vista  mar ...|              Normal|2022-09-13 20:10:...|  2022-09-19|  2022-09-22|         3|       2|      2|       0|    0|         280.0|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|    null| null|      null|    null|\n|     535|   1682395|      Portugal|     Cancelado|   2523|        Quarto Duplo|        Quarto Duplo|             WebSite|2023-02-20 21:39:...|  2023-03-31|  2023-04-02|         2|       2|      2|       0|    0|         144.0|         5|                3|                     2|                      1|                   1| Travanca do Mondego|         Coimbra|       4|                12|             24|2023-05-16 23:55:00|         11|         0|    null| null|      null|    null|\n|     559|   1442334|      Alemanha|     Registado|   2860|Quarto Duplo ou Twin|Quarto Duplo ou Twin|                 BAR|2022-02-25 08:37:...|  2022-04-12|  2022-04-18|         6|       2|      2|       0|    0|         570.0|         9|                3|                     2|                      1|                   1|             Benafim|       Albufeira|       0|                11|             36|2023-05-16 18:00:00|         15|         1|    null| null|      null|    null|\n|     379|   1431327|   Reino Unido|     Cancelado|   1742|T3 Vista Marina o...|T3 Vista Marina o...|                 BAR|2022-02-05 16:50:...|  2022-08-21|  2022-08-28|         7|       5|      5|       0|    0|        2683.8|         1|                6|                     6|                      3|                   2|               Lagos|           Lagos|       4|                10|             36|2023-05-16 18:00:00|         26|         0|    null| null|      null|    null|\n|     319|   1693035|       Espanha|     Registado|   2890|          City Duplo|          City Duplo|         Normal (BB)|2023-03-08 07:59:...|  2023-04-21|  2023-04-23|         2|       2|      2|       0|    0|         159.5|        13|                2|                     2|                      0|                   0|              Aveiro|          Aveiro|       3|                12|             24|2023-05-16 23:59:00|         96|         0|    null| null|      null|    null|\n|     328|   1622491|      Portugal|     Registado|   1450|6 Bed Mixed Dormi...|6 Bed Mixed Dormi...|             WebSite|2022-11-08 13:39:...|  2022-11-14|  2022-11-16|         2|       1|      1|       0|    0|         41.46|        18|                1|                     1|                      0|                   0|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-16 22:00:00|         56|         0|    null| null|      null|    null|\n|     179|   1679618|        França|     Registado|    630|      Duplo  Comfort|      Duplo  Comfort|         Tarifa Base|2023-02-16 14:45:...|  2023-07-02|  2023-07-04|         2|       2|      2|       0|    0|         350.4|        27|                2|                     2|                      0|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         0|    null| null|      null|    null|\n|     482|   1499529|         Suiça|     Registado|   2286|      Apartamento T2|      Apartamento T2|(WEB) Non-refunda...|2022-05-18 18:30:...|  2022-07-19|  2022-07-24|         5|       4|      4|       0|    0|839.3499999996|        43|                6|                     6|                      5|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-16 23:59:00|        143|         0|    null| null|      null|    null|\n|     179|   1699349|Estados Unidos|     Registado|   1766|  Suite Comfort Plus|  Suite Comfort Plus|         Tarifa Base|2023-03-17 02:06:...|  2023-04-02|  2023-04-10|         8|       3|      3|       0|    0|       2209.95|         7|                3|                     3|                      2|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         1|    null| null|      null|    null|\n|     443|   1462547|   Reino Unido|     Registado|   2061|   Clássico Standard|   Clássico Standard|              Normal|2022-03-30 17:01:...|  2022-04-01|  2022-04-04|         3|       2|      2|       0|    0|         489.0|        18|                2|                     2|                      0|                   0|             Cascais|      Carcavelos|       5|                12|             24|2023-05-16 23:59:00|         42|         0|    null| null|      null|    null|\n|     516|   1543279|        França|     Registado|   2468|       Quarto Single|       Quarto Single|     Bar | ROOM ONLY|2022-07-15 11:01:...|  2022-07-26|  2022-07-27|         1|       1|      1|       0|    0|          65.0|         3|                1|                     1|                      0|                   0|            Portimão|           Lagos|       2|                12|             36|2023-05-16 23:00:00|         32|         0|    null| null|      null|    null|\n|     444|   1682182|        Brasil|     Registado|   2073|              Duplo |              Duplo |              Normal|2023-02-20 17:15:...|  2023-04-21|  2023-04-23|         2|       1|      1|       1|    0|         220.0|        14|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|    null| null|      null|    null|\n|     444|   1603917|      Portugal|    Modificada|   2074|Duplo   Vista Mar...|Duplo   Vista Mar...|              Normal|2022-10-07 13:00:...|  2022-11-05|  2022-11-06|         1|       2|      2|       0|    0|          80.0|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|    null| null|      null|    null|\n|     179|   1530764|       Espanha|     Registado|    631|        Twin Comfort|        Twin Comfort|           Room Only|2022-06-28 14:07:...|  2022-07-05|  2022-07-07|         2|       2|      2|       0|    0|       251.424|         8|                2|                     2|                      0|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         0|    null| null|      null|    null|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------+-----+----------+--------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinEventos\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 32 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {}
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinEventosGrouped = spark.sql(\n    \"\"\"\n        SELECT \n            hotel_ID,  Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, is_holiday, count(Event) AS event_count\n        FROM JoinEventos\n        GROUP BY hotel_ID, Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, is_holiday\n    \"\"\"\n)\n\njoinEventosGrouped.createOrReplaceTempView(\"JoinEventosGrouped\")\n\nprintln(joinEventosGrouped.count())\njoinEventosGrouped.show()",
   "id": "",
   "dateCreated": "2023-05-16 20:40:44.016",
   "config": {},
   "dateStarted": "2023-05-16 21:59:59.467",
   "dateUpdated": "2023-05-16 22:00:10.667",
   "dateFinished": "2023-05-16 22:00:10.667",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|   preco_euros|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|event_count|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+\n|     504|   1679437|        França|    Modificada|   2378|       Cela Sæculare|       Cela Sæculare|                 Bar|2023-02-16 09:56:...|  2023-03-08|  2023-03-14|         6|       1|      1|       0|    0|         387.6|        13|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-16 23:59:00|         27|         0|          0|\n|     311|   1424074|      Portugal|    Modificada|   1407|DB - Quarto Duplo...|DB - Quarto Duplo...|           DB BB NRF|2022-01-19 11:54:...|  2022-01-19|  2022-01-20|         1|       1|      2|       0|    0|         126.9|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|          0|\n|     378|   1539793|   Reino Unido|     Registado|   1738|Duplo ou Twin Sta...|Duplo ou Twin Sta...|Tarifa Não Reembo...|2022-07-10 19:44:...|  2022-09-16|  2022-09-18|         2|       2|      2|       0|    0|         153.4|         7|                2|                     2|                      1|                   1|             Batalha|         Batalha|       3|                12|             24|2023-05-16 23:30:00|         23|         0|          0|\n|     514|   1718489|       Holanda|    Modificada|   2494|           Pool Room|           Pool Room|   Non-Refundable >5|2023-04-12 09:36:...|  2023-07-08|  2023-07-22|        14|       2|      2|       0|    0|        2296.0|         5|                3|                     3|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-16 18:00:00|         13|         0|          0|\n|     311|   1704628|   Reino Unido|  NãoRegistado|   1429|TW - Quarto Twin ...|TW - Quarto Twin ...|      MR - Main Rate|2023-03-24 15:08:...|  2023-03-27|  2023-03-28|         1|       2|      2|       0|    0|        64.505|         4|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|          0|\n|     304|   1517353|        França|     Registado|   1360|204 - Duplo Superior|204 - Duplo Superior|         Tarifa Site|2022-06-10 13:43:...|  2022-07-03|  2022-07-04|         1|       2|      2|       0|    0|          87.4|         1|                2|                     2|                      0|                   0|             Coimbra|         Coimbra|       0|                11|             23|2023-05-16 22:30:00|         28|         0|          0|\n|     444|   1588542|Estados Unidos|     Registado|   2386| Twin vista  mar ...| Twin vista  mar ...|              Normal|2022-09-13 20:10:...|  2022-09-19|  2022-09-22|         3|       2|      2|       0|    0|         280.0|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|          0|\n|     535|   1682395|      Portugal|     Cancelado|   2523|        Quarto Duplo|        Quarto Duplo|             WebSite|2023-02-20 21:39:...|  2023-03-31|  2023-04-02|         2|       2|      2|       0|    0|         144.0|         5|                3|                     2|                      1|                   1| Travanca do Mondego|         Coimbra|       4|                12|             24|2023-05-16 23:55:00|         11|         0|          0|\n|     559|   1442334|      Alemanha|     Registado|   2860|Quarto Duplo ou Twin|Quarto Duplo ou Twin|                 BAR|2022-02-25 08:37:...|  2022-04-12|  2022-04-18|         6|       2|      2|       0|    0|         570.0|         9|                3|                     2|                      1|                   1|             Benafim|       Albufeira|       0|                11|             36|2023-05-16 18:00:00|         15|         1|          0|\n|     379|   1431327|   Reino Unido|     Cancelado|   1742|T3 Vista Marina o...|T3 Vista Marina o...|                 BAR|2022-02-05 16:50:...|  2022-08-21|  2022-08-28|         7|       5|      5|       0|    0|        2683.8|         1|                6|                     6|                      3|                   2|               Lagos|           Lagos|       4|                10|             36|2023-05-16 18:00:00|         26|         0|          0|\n|     319|   1693035|       Espanha|     Registado|   2890|          City Duplo|          City Duplo|         Normal (BB)|2023-03-08 07:59:...|  2023-04-21|  2023-04-23|         2|       2|      2|       0|    0|         159.5|        13|                2|                     2|                      0|                   0|              Aveiro|          Aveiro|       3|                12|             24|2023-05-16 23:59:00|         96|         0|          0|\n|     328|   1622491|      Portugal|     Registado|   1450|6 Bed Mixed Dormi...|6 Bed Mixed Dormi...|             WebSite|2022-11-08 13:39:...|  2022-11-14|  2022-11-16|         2|       1|      1|       0|    0|         41.46|        18|                1|                     1|                      0|                   0|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-16 22:00:00|         56|         0|          0|\n|     179|   1679618|        França|     Registado|    630|      Duplo  Comfort|      Duplo  Comfort|         Tarifa Base|2023-02-16 14:45:...|  2023-07-02|  2023-07-04|         2|       2|      2|       0|    0|         350.4|        27|                2|                     2|                      0|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         0|          0|\n|     482|   1499529|         Suiça|     Registado|   2286|      Apartamento T2|      Apartamento T2|(WEB) Non-refunda...|2022-05-18 18:30:...|  2022-07-19|  2022-07-24|         5|       4|      4|       0|    0|839.3499999996|        43|                6|                     6|                      5|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-16 23:59:00|        143|         0|          0|\n|     179|   1699349|Estados Unidos|     Registado|   1766|  Suite Comfort Plus|  Suite Comfort Plus|         Tarifa Base|2023-03-17 02:06:...|  2023-04-02|  2023-04-10|         8|       3|      3|       0|    0|       2209.95|         7|                3|                     3|                      2|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         1|          0|\n|     443|   1462547|   Reino Unido|     Registado|   2061|   Clássico Standard|   Clássico Standard|              Normal|2022-03-30 17:01:...|  2022-04-01|  2022-04-04|         3|       2|      2|       0|    0|         489.0|        18|                2|                     2|                      0|                   0|             Cascais|      Carcavelos|       5|                12|             24|2023-05-16 23:59:00|         42|         0|          0|\n|     516|   1543279|        França|     Registado|   2468|       Quarto Single|       Quarto Single|     Bar | ROOM ONLY|2022-07-15 11:01:...|  2022-07-26|  2022-07-27|         1|       1|      1|       0|    0|          65.0|         3|                1|                     1|                      0|                   0|            Portimão|           Lagos|       2|                12|             36|2023-05-16 23:00:00|         32|         0|          0|\n|     444|   1682182|        Brasil|     Registado|   2073|              Duplo |              Duplo |              Normal|2023-02-20 17:15:...|  2023-04-21|  2023-04-23|         2|       1|      1|       1|    0|         220.0|        14|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|          0|\n|     444|   1603917|      Portugal|    Modificada|   2074|Duplo   Vista Mar...|Duplo   Vista Mar...|              Normal|2022-10-07 13:00:...|  2022-11-05|  2022-11-06|         1|       2|      2|       0|    0|          80.0|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|          0|\n|     179|   1530764|       Espanha|     Registado|    631|        Twin Comfort|        Twin Comfort|           Room Only|2022-06-28 14:07:...|  2022-07-05|  2022-07-07|         2|       2|      2|       0|    0|       251.424|         8|                2|                     2|                      0|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         0|          0|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinEventosGrouped\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 29 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      },
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": []
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "val joinMeteoTemp = spark.sql(\n    \"\"\"\n        SELECT QR.*, M.city, M.tavg, M.tmax, M.tmin, M.prcp\n        FROM JoinEventosGrouped AS QR\n        LEFT JOIN Meteorologia AS M \n            ON QR.area_localizacao = M.city \n            AND M.date <= QR.data_partida AND M.date >= QR.data_chegada\n    \"\"\")\n\njoinMeteoTemp.createOrReplaceTempView(\"JoinMeteoTemp\")\n\nprintln(joinMeteoTemp.count())\njoinMeteoTemp.show()",
   "id": "",
   "dateCreated": "2023-05-01 15:31:17.385",
   "config": {
    "tableHide": true
   },
   "dateStarted": "2023-05-16 22:00:10.668",
   "dateUpdated": "2023-05-16 22:00:22.540",
   "dateFinished": "2023-05-16 22:00:22.540",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "69746\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+-------+----+----+----+----+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|preco_euros|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|event_count|   city|tavg|tmax|tmin|prcp|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+-------+----+----+----+----+\n|     504|   1679437|        França|    Modificada|   2378|       Cela Sæculare|       Cela Sæculare|                 Bar|2023-02-16 09:56:...|  2023-03-08|  2023-03-14|         6|       1|      1|       0|    0|      387.6|        13|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-16 23:59:00|         27|         0|          0| Monção|11.2|14.9| 8.7| 5.3|\n|     504|   1679437|        França|    Modificada|   2378|       Cela Sæculare|       Cela Sæculare|                 Bar|2023-02-16 09:56:...|  2023-03-08|  2023-03-14|         6|       1|      1|       0|    0|      387.6|        13|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-16 23:59:00|         27|         0|          0| Monção|12.5|14.4|10.4| 7.6|\n|     504|   1679437|        França|    Modificada|   2378|       Cela Sæculare|       Cela Sæculare|                 Bar|2023-02-16 09:56:...|  2023-03-08|  2023-03-14|         6|       1|      1|       0|    0|      387.6|        13|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-16 23:59:00|         27|         0|          0| Monção|14.2|17.8|12.5| 9.1|\n|     504|   1679437|        França|    Modificada|   2378|       Cela Sæculare|       Cela Sæculare|                 Bar|2023-02-16 09:56:...|  2023-03-08|  2023-03-14|         6|       1|      1|       0|    0|      387.6|        13|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-16 23:59:00|         27|         0|          0| Monção|13.9|14.7|12.7| 3.8|\n|     504|   1679437|        França|    Modificada|   2378|       Cela Sæculare|       Cela Sæculare|                 Bar|2023-02-16 09:56:...|  2023-03-08|  2023-03-14|         6|       1|      1|       0|    0|      387.6|        13|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-16 23:59:00|         27|         0|          0| Monção|13.0|16.2|11.5|10.2|\n|     504|   1679437|        França|    Modificada|   2378|       Cela Sæculare|       Cela Sæculare|                 Bar|2023-02-16 09:56:...|  2023-03-08|  2023-03-14|         6|       1|      1|       0|    0|      387.6|        13|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-16 23:59:00|         27|         0|          0| Monção|12.8|15.1|10.2|18.8|\n|     504|   1679437|        França|    Modificada|   2378|       Cela Sæculare|       Cela Sæculare|                 Bar|2023-02-16 09:56:...|  2023-03-08|  2023-03-14|         6|       1|      1|       0|    0|      387.6|        13|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-16 23:59:00|         27|         0|          0| Monção|13.8|15.2|11.7| 7.4|\n|     311|   1424074|      Portugal|    Modificada|   1407|DB - Quarto Duplo...|DB - Quarto Duplo...|           DB BB NRF|2022-01-19 11:54:...|  2022-01-19|  2022-01-20|         1|       1|      2|       0|    0|      126.9|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|          0|   Maia|11.2|18.1| 6.4|null|\n|     311|   1424074|      Portugal|    Modificada|   1407|DB - Quarto Duplo...|DB - Quarto Duplo...|           DB BB NRF|2022-01-19 11:54:...|  2022-01-19|  2022-01-20|         1|       1|      2|       0|    0|      126.9|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|          0|   Maia| 8.9|14.5| 4.9|null|\n|     378|   1539793|   Reino Unido|     Registado|   1738|Duplo ou Twin Sta...|Duplo ou Twin Sta...|Tarifa Não Reembo...|2022-07-10 19:44:...|  2022-09-16|  2022-09-18|         2|       2|      2|       0|    0|      153.4|         7|                2|                     2|                      1|                   1|             Batalha|         Batalha|       3|                12|             24|2023-05-16 23:30:00|         23|         0|          0|Batalha|22.4|29.5|16.5| 0.0|\n|     378|   1539793|   Reino Unido|     Registado|   1738|Duplo ou Twin Sta...|Duplo ou Twin Sta...|Tarifa Não Reembo...|2022-07-10 19:44:...|  2022-09-16|  2022-09-18|         2|       2|      2|       0|    0|      153.4|         7|                2|                     2|                      1|                   1|             Batalha|         Batalha|       3|                12|             24|2023-05-16 23:30:00|         23|         0|          0|Batalha|20.9|25.5|18.3| 0.0|\n|     378|   1539793|   Reino Unido|     Registado|   1738|Duplo ou Twin Sta...|Duplo ou Twin Sta...|Tarifa Não Reembo...|2022-07-10 19:44:...|  2022-09-16|  2022-09-18|         2|       2|      2|       0|    0|      153.4|         7|                2|                     2|                      1|                   1|             Batalha|         Batalha|       3|                12|             24|2023-05-16 23:30:00|         23|         0|          0|Batalha|19.6|24.0|15.4| 0.2|\n|     514|   1718489|       Holanda|    Modificada|   2494|           Pool Room|           Pool Room|   Non-Refundable >5|2023-04-12 09:36:...|  2023-07-08|  2023-07-22|        14|       2|      2|       0|    0|     2296.0|         5|                3|                     3|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-16 18:00:00|         13|         0|          0|   null|null|null|null|null|\n|     311|   1704628|   Reino Unido|  NãoRegistado|   1429|TW - Quarto Twin ...|TW - Quarto Twin ...|      MR - Main Rate|2023-03-24 15:08:...|  2023-03-27|  2023-03-28|         1|       2|      2|       0|    0|     64.505|         4|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|          0|   Maia|16.4|22.0|12.0| 0.0|\n|     311|   1704628|   Reino Unido|  NãoRegistado|   1429|TW - Quarto Twin ...|TW - Quarto Twin ...|      MR - Main Rate|2023-03-24 15:08:...|  2023-03-27|  2023-03-28|         1|       2|      2|       0|    0|     64.505|         4|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|          0|   Maia|12.7|19.0| 7.0| 0.0|\n|     304|   1517353|        França|     Registado|   1360|204 - Duplo Superior|204 - Duplo Superior|         Tarifa Site|2022-06-10 13:43:...|  2022-07-03|  2022-07-04|         1|       2|      2|       0|    0|       87.4|         1|                2|                     2|                      0|                   0|             Coimbra|         Coimbra|       0|                11|             23|2023-05-16 22:30:00|         28|         0|          0|Coimbra|19.8|26.0|15.1| 0.3|\n|     304|   1517353|        França|     Registado|   1360|204 - Duplo Superior|204 - Duplo Superior|         Tarifa Site|2022-06-10 13:43:...|  2022-07-03|  2022-07-04|         1|       2|      2|       0|    0|       87.4|         1|                2|                     2|                      0|                   0|             Coimbra|         Coimbra|       0|                11|             23|2023-05-16 22:30:00|         28|         0|          0|Coimbra|20.1|27.8|14.9| 5.4|\n|     444|   1588542|Estados Unidos|     Registado|   2386| Twin vista  mar ...| Twin vista  mar ...|              Normal|2022-09-13 20:10:...|  2022-09-19|  2022-09-22|         3|       2|      2|       0|    0|      280.0|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|          0|Batalha|20.4|25.0|18.0| 0.0|\n|     444|   1588542|Estados Unidos|     Registado|   2386| Twin vista  mar ...| Twin vista  mar ...|              Normal|2022-09-13 20:10:...|  2022-09-19|  2022-09-22|         3|       2|      2|       0|    0|      280.0|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|          0|Batalha|21.4|26.0|19.0| 0.0|\n|     444|   1588542|Estados Unidos|     Registado|   2386| Twin vista  mar ...| Twin vista  mar ...|              Normal|2022-09-13 20:10:...|  2022-09-19|  2022-09-22|         3|       2|      2|       0|    0|      280.0|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|          0|Batalha|21.4|28.0|16.8| 0.0|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+-------+----+----+----+----+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinMeteoTemp\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 34 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {}
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinMeteoGrouped = spark.sql(\n    \"\"\"\n        SELECT \n            hotel_ID,  Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, is_holiday, event_count,\n            avg(tavg) AS temperature_avg,\n            max(tmax) AS temperature_max,\n            min(tmin) AS temperature_min,\n            avg(prcp) AS precipitation_avg,\n            max(prcp) AS precipitation_max,\n            min(prcp) AS precipitation_min\n        FROM JoinMeteoTemp\n        GROUP BY hotel_ID, Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, is_holiday, event_count\n    \"\"\"\n)\n\njoinMeteoGrouped.createOrReplaceTempView(\"JoinMeteoGrouped\")\n\nprintln(joinMeteoGrouped.count())\njoinMeteoGrouped.show()",
   "id": "",
   "dateCreated": "2023-05-16 21:41:47.134",
   "config": {},
   "dateStarted": "2023-05-16 22:00:28.922",
   "dateUpdated": "2023-05-16 22:00:40.441",
   "dateFinished": "2023-05-16 22:00:40.441",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+--------------------+-----------------+-----------------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|   preco_euros|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|event_count|   temperature_avg|temperature_max|temperature_min|   precipitation_avg|precipitation_max|precipitation_min|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+--------------------+-----------------+-----------------+\n|     504|   1679437|        França|    Modificada|   2378|       Cela Sæculare|       Cela Sæculare|                 Bar|2023-02-16 09:56:...|  2023-03-08|  2023-03-14|         6|       1|      1|       0|    0|         387.6|        13|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-16 23:59:00|         27|         0|          0|13.057142857142855|           17.8|            8.7|   8.885714285714284|             18.8|              3.8|\n|     311|   1424074|      Portugal|    Modificada|   1407|DB - Quarto Duplo...|DB - Quarto Duplo...|           DB BB NRF|2022-01-19 11:54:...|  2022-01-19|  2022-01-20|         1|       1|      2|       0|    0|         126.9|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|          0|             10.05|           18.1|            4.9|                null|             null|             null|\n|     378|   1539793|   Reino Unido|     Registado|   1738|Duplo ou Twin Sta...|Duplo ou Twin Sta...|Tarifa Não Reembo...|2022-07-10 19:44:...|  2022-09-16|  2022-09-18|         2|       2|      2|       0|    0|         153.4|         7|                2|                     2|                      1|                   1|             Batalha|         Batalha|       3|                12|             24|2023-05-16 23:30:00|         23|         0|          0|20.966666666666665|           29.5|           15.4| 0.06666666666666667|              0.2|              0.0|\n|     514|   1718489|       Holanda|    Modificada|   2494|           Pool Room|           Pool Room|   Non-Refundable >5|2023-04-12 09:36:...|  2023-07-08|  2023-07-22|        14|       2|      2|       0|    0|        2296.0|         5|                3|                     3|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-16 18:00:00|         13|         0|          0|              null|           null|           null|                null|             null|             null|\n|     311|   1704628|   Reino Unido|  NãoRegistado|   1429|TW - Quarto Twin ...|TW - Quarto Twin ...|      MR - Main Rate|2023-03-24 15:08:...|  2023-03-27|  2023-03-28|         1|       2|      2|       0|    0|        64.505|         4|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|          0|14.549999999999999|           22.0|            7.0|                 0.0|              0.0|              0.0|\n|     304|   1517353|        França|     Registado|   1360|204 - Duplo Superior|204 - Duplo Superior|         Tarifa Site|2022-06-10 13:43:...|  2022-07-03|  2022-07-04|         1|       2|      2|       0|    0|          87.4|         1|                2|                     2|                      0|                   0|             Coimbra|         Coimbra|       0|                11|             23|2023-05-16 22:30:00|         28|         0|          0|19.950000000000003|           27.8|           14.9|                2.85|              5.4|              0.3|\n|     444|   1588542|Estados Unidos|     Registado|   2386| Twin vista  mar ...| Twin vista  mar ...|              Normal|2022-09-13 20:10:...|  2022-09-19|  2022-09-22|         3|       2|      2|       0|    0|         280.0|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|          0|            21.275|           28.0|           16.8|               0.575|              2.3|              0.0|\n|     535|   1682395|      Portugal|     Cancelado|   2523|        Quarto Duplo|        Quarto Duplo|             WebSite|2023-02-20 21:39:...|  2023-03-31|  2023-04-02|         2|       2|      2|       0|    0|         144.0|         5|                3|                     2|                      1|                   1| Travanca do Mondego|         Coimbra|       4|                12|             24|2023-05-16 23:55:00|         11|         0|          0|14.200000000000001|           20.1|            8.9|                 1.0|              1.8|              0.0|\n|     559|   1442334|      Alemanha|     Registado|   2860|Quarto Duplo ou Twin|Quarto Duplo ou Twin|                 BAR|2022-02-25 08:37:...|  2022-04-12|  2022-04-18|         6|       2|      2|       0|    0|         570.0|         9|                3|                     2|                      1|                   1|             Benafim|       Albufeira|       0|                11|             36|2023-05-16 18:00:00|         15|         1|          0|18.428571428571427|           25.0|           11.2|                0.85|              5.1|              0.0|\n|     379|   1431327|   Reino Unido|     Cancelado|   1742|T3 Vista Marina o...|T3 Vista Marina o...|                 BAR|2022-02-05 16:50:...|  2022-08-21|  2022-08-28|         7|       5|      5|       0|    0|        2683.8|         1|                6|                     6|                      3|                   2|               Lagos|           Lagos|       4|                10|             36|2023-05-16 18:00:00|         26|         0|          0|21.474999999999998|           30.7|           16.2|                null|             null|             null|\n|     319|   1693035|       Espanha|     Registado|   2890|          City Duplo|          City Duplo|         Normal (BB)|2023-03-08 07:59:...|  2023-04-21|  2023-04-23|         2|       2|      2|       0|    0|         159.5|        13|                2|                     2|                      0|                   0|              Aveiro|          Aveiro|       3|                12|             24|2023-05-16 23:59:00|         96|         0|          0|              15.0|           18.3|           11.3|                null|             null|             null|\n|     328|   1622491|      Portugal|     Registado|   1450|6 Bed Mixed Dormi...|6 Bed Mixed Dormi...|             WebSite|2022-11-08 13:39:...|  2022-11-14|  2022-11-16|         2|       1|      1|       0|    0|         41.46|        18|                1|                     1|                      0|                   0|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-16 22:00:00|         56|         0|          0|              17.7|           19.5|           15.8|   5.733333333333333|             13.4|              1.5|\n|     179|   1679618|        França|     Registado|    630|      Duplo  Comfort|      Duplo  Comfort|         Tarifa Base|2023-02-16 14:45:...|  2023-07-02|  2023-07-04|         2|       2|      2|       0|    0|         350.4|        27|                2|                     2|                      0|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         0|          0|              null|           null|           null|                null|             null|             null|\n|     482|   1499529|         Suiça|     Registado|   2286|      Apartamento T2|      Apartamento T2|(WEB) Non-refunda...|2022-05-18 18:30:...|  2022-07-19|  2022-07-24|         5|       4|      4|       0|    0|839.3499999996|        43|                6|                     6|                      5|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-16 23:59:00|        143|         0|          0|24.433333333333334|           34.8|           17.9|                null|             null|             null|\n|     179|   1699349|Estados Unidos|     Registado|   1766|  Suite Comfort Plus|  Suite Comfort Plus|         Tarifa Base|2023-03-17 02:06:...|  2023-04-02|  2023-04-10|         8|       3|      3|       0|    0|       2209.95|         7|                3|                     3|                      2|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         1|          0|15.022222222222224|           24.3|            7.9|0.011111111111111112|              0.1|              0.0|\n|     443|   1462547|   Reino Unido|     Registado|   2061|   Clássico Standard|   Clássico Standard|              Normal|2022-03-30 17:01:...|  2022-04-01|  2022-04-04|         3|       2|      2|       0|    0|         489.0|        18|                2|                     2|                      0|                   0|             Cascais|      Carcavelos|       5|                12|             24|2023-05-16 23:59:00|         42|         0|          0|             12.45|           17.0|            8.0|                 0.0|              0.0|              0.0|\n|     516|   1543279|        França|     Registado|   2468|       Quarto Single|       Quarto Single|     Bar | ROOM ONLY|2022-07-15 11:01:...|  2022-07-26|  2022-07-27|         1|       1|      1|       0|    0|          65.0|         3|                1|                     1|                      0|                   0|            Portimão|           Lagos|       2|                12|             36|2023-05-16 23:00:00|         32|         0|          0|              22.6|           28.8|           17.2|                null|             null|             null|\n|     444|   1682182|        Brasil|     Registado|   2073|              Duplo |              Duplo |              Normal|2023-02-20 17:15:...|  2023-04-21|  2023-04-23|         2|       1|      1|       1|    0|         220.0|        14|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|          0|14.466666666666667|           19.6|            9.0|   5.900000000000001|             17.6|              0.0|\n|     444|   1603917|      Portugal|    Modificada|   2074|Duplo   Vista Mar...|Duplo   Vista Mar...|              Normal|2022-10-07 13:00:...|  2022-11-05|  2022-11-06|         1|       2|      2|       0|    0|          80.0|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|          0|             12.45|           19.0|            5.5|                0.15|              0.3|              0.0|\n|     179|   1530764|       Espanha|     Registado|    631|        Twin Comfort|        Twin Comfort|           Room Only|2022-06-28 14:07:...|  2022-07-05|  2022-07-07|         2|       2|      2|       0|    0|       251.424|         8|                2|                     2|                      0|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         0|          0|23.933333333333337|           33.7|           17.1|                 0.0|              0.0|              0.0|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+--------------------+-----------------+-----------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinMeteoGrouped\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 35 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {}
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "joinMeteoGrouped.createOrReplaceTempView(\"FinalDataSet\")\n\nval FinalDataSet = spark.sql(\"select * from FinalDataSet\")\nprintln(FinalDataSet.count())\nFinalDataSet.show()\n\n//saveDataFrame(joinMeteoTemp, \"FinalDataSet\")",
   "id": "",
   "dateCreated": "2023-05-01 15:47:23.871",
   "config": {},
   "dateStarted": "2023-05-16 22:07:16.092",
   "dateUpdated": "2023-05-16 22:07:25.332",
   "dateFinished": "2023-05-16 22:07:25.332",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+--------------------+-----------------+-----------------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|   preco_euros|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|event_count|   temperature_avg|temperature_max|temperature_min|   precipitation_avg|precipitation_max|precipitation_min|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+--------------------+-----------------+-----------------+\n|     504|   1679437|        França|    Modificada|   2378|       Cela Sæculare|       Cela Sæculare|                 Bar|2023-02-16 09:56:...|  2023-03-08|  2023-03-14|         6|       1|      1|       0|    0|         387.6|        13|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-16 23:59:00|         27|         0|          0|13.057142857142855|           17.8|            8.7|   8.885714285714284|             18.8|              3.8|\n|     311|   1424074|      Portugal|    Modificada|   1407|DB - Quarto Duplo...|DB - Quarto Duplo...|           DB BB NRF|2022-01-19 11:54:...|  2022-01-19|  2022-01-20|         1|       1|      2|       0|    0|         126.9|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|          0|             10.05|           18.1|            4.9|                null|             null|             null|\n|     378|   1539793|   Reino Unido|     Registado|   1738|Duplo ou Twin Sta...|Duplo ou Twin Sta...|Tarifa Não Reembo...|2022-07-10 19:44:...|  2022-09-16|  2022-09-18|         2|       2|      2|       0|    0|         153.4|         7|                2|                     2|                      1|                   1|             Batalha|         Batalha|       3|                12|             24|2023-05-16 23:30:00|         23|         0|          0|20.966666666666665|           29.5|           15.4| 0.06666666666666667|              0.2|              0.0|\n|     514|   1718489|       Holanda|    Modificada|   2494|           Pool Room|           Pool Room|   Non-Refundable >5|2023-04-12 09:36:...|  2023-07-08|  2023-07-22|        14|       2|      2|       0|    0|        2296.0|         5|                3|                     3|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-16 18:00:00|         13|         0|          0|              null|           null|           null|                null|             null|             null|\n|     311|   1704628|   Reino Unido|  NãoRegistado|   1429|TW - Quarto Twin ...|TW - Quarto Twin ...|      MR - Main Rate|2023-03-24 15:08:...|  2023-03-27|  2023-03-28|         1|       2|      2|       0|    0|        64.505|         4|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-16 23:59:00|         30|         0|          0|14.549999999999999|           22.0|            7.0|                 0.0|              0.0|              0.0|\n|     304|   1517353|        França|     Registado|   1360|204 - Duplo Superior|204 - Duplo Superior|         Tarifa Site|2022-06-10 13:43:...|  2022-07-03|  2022-07-04|         1|       2|      2|       0|    0|          87.4|         1|                2|                     2|                      0|                   0|             Coimbra|         Coimbra|       0|                11|             23|2023-05-16 22:30:00|         28|         0|          0|19.950000000000003|           27.8|           14.9|                2.85|              5.4|              0.3|\n|     444|   1588542|Estados Unidos|     Registado|   2386| Twin vista  mar ...| Twin vista  mar ...|              Normal|2022-09-13 20:10:...|  2022-09-19|  2022-09-22|         3|       2|      2|       0|    0|         280.0|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|          0|            21.275|           28.0|           16.8|               0.575|              2.3|              0.0|\n|     535|   1682395|      Portugal|     Cancelado|   2523|        Quarto Duplo|        Quarto Duplo|             WebSite|2023-02-20 21:39:...|  2023-03-31|  2023-04-02|         2|       2|      2|       0|    0|         144.0|         5|                3|                     2|                      1|                   1| Travanca do Mondego|         Coimbra|       4|                12|             24|2023-05-16 23:55:00|         11|         0|          0|14.200000000000001|           20.1|            8.9|                 1.0|              1.8|              0.0|\n|     559|   1442334|      Alemanha|     Registado|   2860|Quarto Duplo ou Twin|Quarto Duplo ou Twin|                 BAR|2022-02-25 08:37:...|  2022-04-12|  2022-04-18|         6|       2|      2|       0|    0|         570.0|         9|                3|                     2|                      1|                   1|             Benafim|       Albufeira|       0|                11|             36|2023-05-16 18:00:00|         15|         1|          0|18.428571428571427|           25.0|           11.2|                0.85|              5.1|              0.0|\n|     379|   1431327|   Reino Unido|     Cancelado|   1742|T3 Vista Marina o...|T3 Vista Marina o...|                 BAR|2022-02-05 16:50:...|  2022-08-21|  2022-08-28|         7|       5|      5|       0|    0|        2683.8|         1|                6|                     6|                      3|                   2|               Lagos|           Lagos|       4|                10|             36|2023-05-16 18:00:00|         26|         0|          0|21.474999999999998|           30.7|           16.2|                null|             null|             null|\n|     319|   1693035|       Espanha|     Registado|   2890|          City Duplo|          City Duplo|         Normal (BB)|2023-03-08 07:59:...|  2023-04-21|  2023-04-23|         2|       2|      2|       0|    0|         159.5|        13|                2|                     2|                      0|                   0|              Aveiro|          Aveiro|       3|                12|             24|2023-05-16 23:59:00|         96|         0|          0|              15.0|           18.3|           11.3|                null|             null|             null|\n|     328|   1622491|      Portugal|     Registado|   1450|6 Bed Mixed Dormi...|6 Bed Mixed Dormi...|             WebSite|2022-11-08 13:39:...|  2022-11-14|  2022-11-16|         2|       1|      1|       0|    0|         41.46|        18|                1|                     1|                      0|                   0|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-16 22:00:00|         56|         0|          0|              17.7|           19.5|           15.8|   5.733333333333333|             13.4|              1.5|\n|     179|   1679618|        França|     Registado|    630|      Duplo  Comfort|      Duplo  Comfort|         Tarifa Base|2023-02-16 14:45:...|  2023-07-02|  2023-07-04|         2|       2|      2|       0|    0|         350.4|        27|                2|                     2|                      0|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         0|          0|              null|           null|           null|                null|             null|             null|\n|     482|   1499529|         Suiça|     Registado|   2286|      Apartamento T2|      Apartamento T2|(WEB) Non-refunda...|2022-05-18 18:30:...|  2022-07-19|  2022-07-24|         5|       4|      4|       0|    0|839.3499999996|        43|                6|                     6|                      5|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-16 23:59:00|        143|         0|          0|24.433333333333334|           34.8|           17.9|                null|             null|             null|\n|     179|   1699349|Estados Unidos|     Registado|   1766|  Suite Comfort Plus|  Suite Comfort Plus|         Tarifa Base|2023-03-17 02:06:...|  2023-04-02|  2023-04-10|         8|       3|      3|       0|    0|       2209.95|         7|                3|                     3|                      2|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         1|          0|15.022222222222224|           24.3|            7.9|0.011111111111111112|              0.1|              0.0|\n|     443|   1462547|   Reino Unido|     Registado|   2061|   Clássico Standard|   Clássico Standard|              Normal|2022-03-30 17:01:...|  2022-04-01|  2022-04-04|         3|       2|      2|       0|    0|         489.0|        18|                2|                     2|                      0|                   0|             Cascais|      Carcavelos|       5|                12|             24|2023-05-16 23:59:00|         42|         0|          0|             12.45|           17.0|            8.0|                 0.0|              0.0|              0.0|\n|     516|   1543279|        França|     Registado|   2468|       Quarto Single|       Quarto Single|     Bar | ROOM ONLY|2022-07-15 11:01:...|  2022-07-26|  2022-07-27|         1|       1|      1|       0|    0|          65.0|         3|                1|                     1|                      0|                   0|            Portimão|           Lagos|       2|                12|             36|2023-05-16 23:00:00|         32|         0|          0|              22.6|           28.8|           17.2|                null|             null|             null|\n|     444|   1682182|        Brasil|     Registado|   2073|              Duplo |              Duplo |              Normal|2023-02-20 17:15:...|  2023-04-21|  2023-04-23|         2|       1|      1|       1|    0|         220.0|        14|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|          0|14.466666666666667|           19.6|            9.0|   5.900000000000001|             17.6|              0.0|\n|     444|   1603917|      Portugal|    Modificada|   2074|Duplo   Vista Mar...|Duplo   Vista Mar...|              Normal|2022-10-07 13:00:...|  2022-11-05|  2022-11-06|         1|       2|      2|       0|    0|          80.0|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-16 23:59:00|         77|         0|          0|             12.45|           19.0|            5.5|                0.15|              0.3|              0.0|\n|     179|   1530764|       Espanha|     Registado|    631|        Twin Comfort|        Twin Comfort|           Room Only|2022-06-28 14:07:...|  2022-07-05|  2022-07-07|         2|       2|      2|       0|    0|       251.424|         8|                2|                     2|                      0|                   0|               Porto|           Porto|       4|                12|             24|2023-05-16 23:59:00|        132|         0|          0|23.933333333333337|           33.7|           17.1|                 0.0|              0.0|              0.0|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+--------------------+-----------------+-----------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mFinalDataSet\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 35 more fields]\n"
     }
    ]
   }
  }
 ],
 "name": "Zeppelin Notebook",
 "id": "",
 "noteParams": {},
 "noteForms": {},
 "angularObjects": {},
 "config": {
  "isZeppelinNotebookCronEnable": false,
  "looknfeel": "default",
  "personalizedMode": "false"
 },
 "info": {}
}