{
 "paragraphs": [
  {
   "settings": {
    "params": {
     "bdtMeta": {}
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "// FILE #2",
   "id": "",
   "dateCreated": "2023-05-08 15:40:50.806",
   "config": {},
   "dateStarted": "2023-05-10 00:10:19.912",
   "dateUpdated": "2023-05-10 00:10:20.038",
   "dateFinished": "2023-05-10 00:10:20.037",
   "results": {
    "code": "SUCCESS",
    "msg": []
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Quantidade de quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "_c17",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "_c18",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "_c19",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "_c20",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "_c21",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "_c22",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "_c23",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "_c24",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "_c25",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "_c26",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "_c27",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "_c28",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "_c29",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "import org.apache.spark.sql.DataFrame\n\nval joinFolder = \"/data/joins\"\nval saveJoins = false\n\ndef saveDataFrame(df: DataFrame, name: String): Unit = {\n    df.coalesce(1) // Print into a single file\n            .write\n            .mode(\"overwrite\")\n            .option(\"delimiter\", \";\")\n            .option(\"header\", true) // Maintain Headers\n            .csv(s\"$joinFolder/$name\") // Write to csv\n}\nval initialCount = spark.sql(\n    \"\"\"\n      SELECT DISTINCT * FROM QuartosReservados\n      \"\"\")\nprintln(initialCount.count())",
   "id": "",
   "dateCreated": "2023-04-30 19:59:44.804",
   "config": {
    "editorHide": false
   },
   "dateStarted": "2023-05-10 00:10:20.040",
   "dateUpdated": "2023-05-10 00:10:24.881",
   "dateFinished": "2023-05-10 00:10:24.881",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24955\nimport org.apache.spark.sql.DataFrame\n\u001b[1m\u001b[34mjoinFolder\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /data/joins\n\u001b[1m\u001b[34msaveJoins\u001b[0m: \u001b[1m\u001b[32mBoolean\u001b[0m = false\n\u001b[1m\u001b[34msaveDataFrame\u001b[0m: \u001b[1m\u001b[32m(df: org.apache.spark.sql.DataFrame, name: String)Unit\u001b[0m\n\u001b[1m\u001b[34minitialCount\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 29 more fields]\n"
     }
    ]
   }
  },
  {
   "user": "anonymous",
   "config": {
    "colWidth": 12,
    "fontSize": 9,
    "enabled": true,
    "results": {},
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "editorMode": "ace/mode/scala"
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "jobName": "paragraph_1563110258183_1613653816",
   "id": "20190714-161738_1950435706",
   "dateCreated": "2019-07-14T16:17:38+0300",
   "status": "FINISHED",
   "progressUpdateIntervalMs": 500,
   "focus": true,
   "$$hashKey": "object:394",
   "text": "val joinTipologia = spark.sql(\n    \"\"\"\n       SELECT DISTINCT \n           Q.hotel_ID, \n           Q.Reserve_ID,\n           Q.pais,\n           Q.estado_reserva,\n           Q.room_ID,\n           Q.tipo_quarto AS Q_tipo_quarto,\n           Q.rate_plan,\n           Q.data_reserva,\n           Q.data_chegada,\n           Q.data_partida,\n           Q.num_noites,\n           Q.ocupacao,\n           Q.adultos,\n           Q.criancas,\n           Q.bebes,\n           Q.preco_euros,\n           T.tipo_quarto as T_tipo_quarto, \n           T.quantidade,\n           T.capacidade_maxima,\n           T.capacidade_max_adultos,\n           T.capacidade_max_criancas,\n           T.capacidade_max_bebes\n       FROM QuartosReservados as Q\n       INNER JOIN Tipologias as T\n           ON Q.hotel_ID = T.hotel_ID AND T.room_ID = Q.room_ID\n      \"\"\")\n\njoinTipologia.createOrReplaceTempView(\"JoinTipologia\")\njoinTipologia.cache()\n\nif (saveJoins)\n    saveDataFrame(joinTipologia, \"joinTipologia\")\n\nprintln(joinTipologia.count())\njoinTipologia.printSchema()",
   "dateStarted": "2023-05-10 00:10:24.892",
   "dateUpdated": "2023-05-10 00:10:29.827",
   "dateFinished": "2023-05-10 00:10:29.826",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\nroot\n |-- hotel_ID: integer (nullable = true)\n |-- Reserve_ID: integer (nullable = true)\n |-- pais: string (nullable = true)\n |-- estado_reserva: string (nullable = true)\n |-- room_ID: integer (nullable = true)\n |-- Q_tipo_quarto: string (nullable = true)\n |-- rate_plan: string (nullable = true)\n |-- data_reserva: timestamp (nullable = true)\n |-- data_chegada: date (nullable = true)\n |-- data_partida: date (nullable = true)\n |-- num_noites: integer (nullable = true)\n |-- ocupacao: integer (nullable = true)\n |-- adultos: integer (nullable = true)\n |-- criancas: integer (nullable = true)\n |-- bebes: integer (nullable = true)\n |-- preco_euros: double (nullable = true)\n |-- T_tipo_quarto: string (nullable = true)\n |-- quantidade: integer (nullable = true)\n |-- capacidade_maxima: integer (nullable = true)\n |-- capacidade_max_adultos: integer (nullable = true)\n |-- capacidade_max_criancas: integer (nullable = true)\n |-- capacidade_max_bebes: integer (nullable = true)\n\n\u001b[1m\u001b[34mjoinTipologia\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 20 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {},
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinTipologiaAndHotel = spark.sql(\n    \"\"\"\n       SELECT \n           J.*,\n           H.localizacao,\n           H.area_localizacao,\n           H.estrelas,\n           H.idade_max_criancas,\n           H.idade_max_bebes,\n           H.hora_max_checkin,\n           H.qtd_quartos\n       FROM joinTipologia as J\n       INNER JOIN Hotel as H\n           ON J.hotel_ID = H.hotel_ID\n    \"\"\")\n\njoinTipologiaAndHotel.createOrReplaceTempView(\"JoinTipologiaAndHotel\")\n\nprintln(joinTipologiaAndHotel.count())\n//joinTipologiaAndHotel.printSchema()\nif (saveJoins)\n    saveDataFrame(joinTipologiaAndHotel, \"joinTipologiaAndHotel\")",
   "id": "",
   "dateCreated": "2023-04-30 20:01:48.781",
   "config": {
    "tableHide": false
   },
   "dateStarted": "2023-05-10 00:10:29.841",
   "dateUpdated": "2023-05-10 00:10:31.923",
   "dateFinished": "2023-05-10 00:10:31.923",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n\u001b[1m\u001b[34mjoinTipologiaAndHotel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 27 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {},
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": false
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinFeriados = spark.sql(\n    \"\"\"\n        SELECT J.*, F.is_holiday\n        FROM JoinTipologiaAndHotel AS J\n        LEFT JOIN (SELECT * FROM Feriados WHERE is_holiday=1) AS F\n            ON F.date <= J.data_partida AND f.date >= data_chegada\n    \"\"\"\n)\njoinFeriados = joinFeriados.na.fill(0, Seq(\"is_holiday\"))\n\njoinFeriados.createOrReplaceTempView(\"JoinFeriados\")\n\n// Substituição de valores nullos por 0\n//val updatedFeriados = joinFeriados.na.fill(0, Seq(\"is_holiday\"))\n\nprintln(joinFeriados.count())\n\njoinFeriados.show()",
   "id": "",
   "dateCreated": "2023-04-30 20:12:14.191",
   "config": {
    "tableHide": false
   },
   "dateStarted": "2023-05-10 00:10:31.938",
   "dateUpdated": "2023-05-10 00:10:35.794",
   "dateFinished": "2023-05-10 00:10:35.794",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "25213\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|preco_euros|       T_tipo_quarto|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\n|     503|   1722075|        Brasil|     Registado|   2785|Duplo Economico T...|             BAR APA|2023-04-16 22:43:...|  2023-06-12|  2023-06-16|         4|       2|      2|       0|    0|      340.0|Duplo Economico T...|        64|                2|                     2|                      0|                   0|              Aveiro|          Aveiro|       3|                10|             36|2023-05-09 23:00:00|        187|         0|\n|     482|   1720759|      Portugal|     Registado|   2285|      Apartamento T1|(WEB) Non-refunda...|2023-04-15 07:48:...|  2023-04-15|  2023-04-16|         1|       3|      3|       0|    0|      70.68|      Apartamento T1|        90|                4|                     4|                      3|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-09 23:59:00|        143|         0|\n|     311|   1720055|        Itália|     Registado|   2034|DBS - Quarto Dupl...|      MR - Main Rate|2023-04-14 07:06:...|  2023-04-17|  2023-04-18|         1|       2|      2|       0|    0|      90.25|DBS - Quarto Dupl...|         5|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-09 23:59:00|         30|         0|\n|     514|   1715174|   Reino Unido|     Cancelado|   2425|     Eco Garden Room|   Non-Refundable >5|2023-04-07 11:59:...|  2023-06-17|  2023-06-22|         5|       2|      2|       0|    0|      580.0|     Eco Garden Room|         4|                2|                     2|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-09 18:00:00|         13|         0|\n|     556|   1715161|      Portugal|      Pendente|   2831|Double Room Standard|WEB (Best Availab...|2023-04-07 11:45:...|  2023-04-22|  2023-04-23|         1|       2|      2|       0|    1|      72.25|Double Room Standard|        45|                3|                     2|                      0|                   1|             Covilhã|  Castelo Branco|       3|                10|              3|2023-05-09 23:00:00|         84|         0|\n|     556|   1711558|      Portugal|      Pendente|   2831|Double Room Standard|WEB (Best Availab...|2023-04-02 21:17:...|  2023-04-06|  2023-04-09|         3|       2|      2|       0|    0|      215.9|Double Room Standard|        45|                3|                     2|                      0|                   1|             Covilhã|  Castelo Branco|       3|                10|              3|2023-05-09 23:00:00|         84|         1|\n|     556|   1711558|      Portugal|      Pendente|   2831|Double Room Standard|WEB (Best Availab...|2023-04-02 21:17:...|  2023-04-06|  2023-04-09|         3|       2|      2|       0|    0|      215.9|Double Room Standard|        45|                3|                     2|                      0|                   1|             Covilhã|  Castelo Branco|       3|                10|              3|2023-05-09 23:00:00|         84|         1|\n|     319|   1711236|       Bélgica|     Registado|   1416|               Suite|         Normal (RO)|2023-04-02 16:20:...|  2023-08-20|  2023-08-23|         3|       2|      2|       0|    0|      352.5|               Suite|         2|                2|                     2|                      0|                   0|              Aveiro|          Aveiro|       3|                12|             24|2023-05-09 23:59:00|         96|         0|\n|     311|   1709937|        Itália|      Pendente|   2034|DBS - Quarto Dupl...|      MR - Main Rate|2023-03-31 16:43:...|  2023-04-14|  2023-04-15|         1|       2|      4|       0|    0|      171.0|DBS - Quarto Dupl...|         5|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-09 23:59:00|         30|         0|\n|     310|   1709380|      Portugal|    Modificada|   1673|Quarto Duplo Supe...|      MR - Main Rate|2023-03-30 21:08:...|  2023-04-01|  2023-04-02|         1|       2|      2|       0|    0|    50.6825|Quarto Duplo Supe...|        63|                2|                     2|                      1|                   0|                Gaia|           Porto|       3|                 0|              0|2023-05-09 23:59:00|        192|         0|\n|     539|   1708305|      Portugal|    Confirmado|   2542|Quarto Dpl. Standard|                 Bar|2023-03-29 15:13:...|  2023-04-07|  2023-04-09|         2|       1|      1|       0|    0|      170.0|Quarto Dpl. Standard|         5|                2|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-09 18:00:00|         58|         1|\n|     539|   1708305|      Portugal|    Confirmado|   2542|Quarto Dpl. Standard|                 Bar|2023-03-29 15:13:...|  2023-04-07|  2023-04-09|         2|       1|      1|       0|    0|      170.0|Quarto Dpl. Standard|         5|                2|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-09 18:00:00|         58|         1|\n|     309|   1707106|    Luxemburgo|     Registado|   1372|Quarto Duplo Stan...|      MR - Main Rate|2023-03-27 22:34:...|  2023-03-27|  2023-03-28|         1|       2|      2|       0|    0|       47.5|Quarto Duplo Stan...|        10|                2|                     2|                      1|                   0|             Valongo|           Porto|       3|                12|              4|2023-05-09 23:59:00|         41|         0|\n|     319|   1705435|       Espanha|     Registado|   2890|          City Duplo|         Normal (RO)|2023-03-25 20:05:...|  2023-04-08|  2023-04-09|         1|       2|      2|       0|    0|       73.5|          City Duplo|        13|                2|                     2|                      0|                   0|              Aveiro|          Aveiro|       3|                12|             24|2023-05-09 23:59:00|         96|         1|\n|     273|   1704694|       Espanha|     Registado|   1235|           Rosmarine|              Normal|2023-03-24 16:59:...|  2023-07-14|  2023-07-16|         2|       2|      2|       0|    0|      450.0|           Rosmarine|         1|                2|                     2|                      0|                   0|    Seixas - Caminha|Viana do Castelo|       0|                 0|              0|2023-05-09 12:00:00|         14|         0|\n|     309|   1697270|      Portugal|     Registado|   2254|Quarto Duplo Supe...|      MR - Main Rate|2023-03-14 12:18:...|  2023-06-01|  2023-06-04|         3|       2|      2|       0|    0|    189.829|Quarto Duplo Supe...|         8|                2|                     2|                      1|                   0|             Valongo|           Porto|       3|                12|              4|2023-05-09 23:59:00|         41|         0|\n|     310|   1693127|      Portugal|     Registado|   1673|Quarto Duplo Supe...|      MR - Main Rate|2023-03-08 10:54:...|  2023-03-29|  2023-04-02|         4|       1|      1|       0|    0|   216.5525|Quarto Duplo Supe...|        63|                2|                     2|                      1|                   0|                Gaia|           Porto|       3|                 0|              0|2023-05-09 23:59:00|        192|         0|\n|     358|   1692359|Estados Unidos|     Registado|   1745|Suite Deluxe com ...|                 BAR|2023-03-07 09:15:...|  2023-04-21|  2023-04-28|         7|       2|      2|       0|    0|     2329.0|Suite Deluxe com ...|         1|                2|                     2|                      0|                   0|               Porto|           Porto|       0|                12|              2|2023-05-09 23:59:00|         10|         1|\n|     366|   1692243|      Portugal|     Registado|   1652|     QUARTO FAMILIAR|      Non Refundable|2023-03-06 23:15:...|  2023-03-11|  2023-03-12|         1|       2|      2|       2|    0|       95.4|     QUARTO FAMILIAR|         4|                4|                     2|                      2|                   1|      Castelo Branco|  Castelo Branco|       4|                12|              2|2023-05-09 23:59:00|         71|         0|\n|     185|   1687655|        Israel|    Modificada|    721|               Suite|                 BAR|2023-02-28 16:35:...|  2023-06-02|  2023-06-05|         3|       2|      2|       0|    0|      675.0|               Suite|         1|                4|                     4|                      2|                   1|   Valdigem - Lamego|          Chaves|       4|                12|             36|2023-05-09 23:00:00|         20|         0|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinFeriados\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 28 more fields]\njoinFeriados: org.apache.spark.sql.DataFrame = [hotel_ID: int, Reserve_ID: int ... 28 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {},
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": false
         },
         {
          "name": "Location",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "Event",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "start_Date",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "end_date",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "val joinEventos = spark.sql(\n    \"\"\"\n        SELECT DISTINCT QR.*, E.*\n        FROM JoinFeriados QR\n        LEFT JOIN Eventos E\n            ON QR.data_partida >= E.start_Date AND QR.data_chegada <= E.end_date\n            AND QR.area_localizacao = E.Location\n    \"\"\")\n\njoinEventos.createOrReplaceTempView(\"JoinEventos\")\n\nprintln(joinEventos.count())\n//joinEventos.show()",
   "id": "",
   "dateCreated": "2023-04-30 20:16:51.675",
   "config": {},
   "dateStarted": "2023-05-10 00:10:35.817",
   "dateUpdated": "2023-05-10 00:10:42.438",
   "dateFinished": "2023-05-10 00:10:42.438",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24961\n\u001b[1m\u001b[34mjoinEventos\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 32 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      },
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": false
         },
         {
          "name": "Location",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "Event",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "start_Date",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "end_date",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "city",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "tavg",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "tmax",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "tmin",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "prcp",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "val joinMeteoTemp = spark.sql(\n    \"\"\"\n        SELECT QR.*, M.city, M.tavg, M.tmax, M.tmin, M.prcp\n        FROM JoinEventos AS QR\n        JOIN Meteorologia AS M \n            ON QR.area_localizacao = M.city \n            AND M.date <= QR.data_partida AND M.date >= QR.data_chegada\n    \"\"\")\n\njoinMeteoTemp.createOrReplaceTempView(\"JoinMeteoTemp\")\n\nprintln(joinMeteoTemp.count())\njoinMeteoTemp.show()",
   "id": "",
   "dateCreated": "2023-05-01 15:31:17.385",
   "config": {
    "tableHide": true
   },
   "dateStarted": "2023-05-10 00:10:42.446",
   "dateUpdated": "2023-05-10 00:10:50.261",
   "dateFinished": "2023-05-10 00:10:50.261",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "67109\n+--------+----------+--------+--------------+-------+--------------------+-------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------+-----+----------+--------+---------+----+----+----+----+\n|hotel_ID|Reserve_ID|    pais|estado_reserva|room_ID|       Q_tipo_quarto|          rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|   preco_euros|       T_tipo_quarto|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|Location|Event|start_Date|end_date|     city|tavg|tmax|tmin|prcp|\n+--------+----------+--------+--------------+-------+--------------------+-------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------+-----+----------+--------+---------+----+----+----+----+\n|     225|   1617407|  França|     Registado|    846|Apartamento Vista...|                 OR|2022-10-30 11:11:...|  2022-11-09|  2022-11-14|         5|       3|      3|       0|    0|        1075.0|Apartamento Vista...|         3|                5|                     5|                      4|                   2|      Porto|           Porto|       0|                 2|             24|2023-05-09 17:00:00|          5|         0|    null| null|      null|    null|    Porto|14.5|16.2|13.1| 3.2|\n|     225|   1617407|  França|     Registado|    846|Apartamento Vista...|                 OR|2022-10-30 11:11:...|  2022-11-09|  2022-11-14|         5|       3|      3|       0|    0|        1075.0|Apartamento Vista...|         3|                5|                     5|                      4|                   2|      Porto|           Porto|       0|                 2|             24|2023-05-09 17:00:00|          5|         0|    null| null|      null|    null|    Porto|15.7|18.6|13.7|17.4|\n|     225|   1617407|  França|     Registado|    846|Apartamento Vista...|                 OR|2022-10-30 11:11:...|  2022-11-09|  2022-11-14|         5|       3|      3|       0|    0|        1075.0|Apartamento Vista...|         3|                5|                     5|                      4|                   2|      Porto|           Porto|       0|                 2|             24|2023-05-09 17:00:00|          5|         0|    null| null|      null|    null|    Porto|15.5|20.0|12.0| 0.0|\n|     225|   1617407|  França|     Registado|    846|Apartamento Vista...|                 OR|2022-10-30 11:11:...|  2022-11-09|  2022-11-14|         5|       3|      3|       0|    0|        1075.0|Apartamento Vista...|         3|                5|                     5|                      4|                   2|      Porto|           Porto|       0|                 2|             24|2023-05-09 17:00:00|          5|         0|    null| null|      null|    null|    Porto|15.5|20.5|12.0| 0.0|\n|     225|   1617407|  França|     Registado|    846|Apartamento Vista...|                 OR|2022-10-30 11:11:...|  2022-11-09|  2022-11-14|         5|       3|      3|       0|    0|        1075.0|Apartamento Vista...|         3|                5|                     5|                      4|                   2|      Porto|           Porto|       0|                 2|             24|2023-05-09 17:00:00|          5|         0|    null| null|      null|    null|    Porto|15.9|19.7|13.9| 0.0|\n|     225|   1617407|  França|     Registado|    846|Apartamento Vista...|                 OR|2022-10-30 11:11:...|  2022-11-09|  2022-11-14|         5|       3|      3|       0|    0|        1075.0|Apartamento Vista...|         3|                5|                     5|                      4|                   2|      Porto|           Porto|       0|                 2|             24|2023-05-09 17:00:00|          5|         0|    null| null|      null|    null|    Porto|14.7|16.7|13.3|20.6|\n|     311|   1491643|  França|     Registado|   1407|DB - Quarto Duplo...|       DB Room Only|2022-05-09 12:41:...|  2022-06-09|  2022-06-10|         1|       1|      1|       0|    0|          74.0|DB - Quarto Duplo...|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-05-09 23:59:00|         30|         1|    null| null|      null|    null|     Maia|20.5|24.1|16.6| 0.0|\n|     311|   1491643|  França|     Registado|   1407|DB - Quarto Duplo...|       DB Room Only|2022-05-09 12:41:...|  2022-06-09|  2022-06-10|         1|       1|      1|       0|    0|          74.0|DB - Quarto Duplo...|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-05-09 23:59:00|         30|         1|    null| null|      null|    null|     Maia|19.6|22.9|17.4| 0.0|\n|     179|   1490275|   Suiça|     Registado|    631|        Twin Comfort|No Reembolsable 13%|2022-05-07 13:42:...|  2022-05-09|  2022-05-13|         4|       2|      2|       0|    0|460.0799999999|        Twin Comfort|         8|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-05-09 23:59:00|        132|         0|    null| null|      null|    null|    Porto|18.5|24.3|14.0|null|\n|     179|   1490275|   Suiça|     Registado|    631|        Twin Comfort|No Reembolsable 13%|2022-05-07 13:42:...|  2022-05-09|  2022-05-13|         4|       2|      2|       0|    0|460.0799999999|        Twin Comfort|         8|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-05-09 23:59:00|        132|         0|    null| null|      null|    null|    Porto|16.8|21.7|12.6|null|\n|     179|   1490275|   Suiça|     Registado|    631|        Twin Comfort|No Reembolsable 13%|2022-05-07 13:42:...|  2022-05-09|  2022-05-13|         4|       2|      2|       0|    0|460.0799999999|        Twin Comfort|         8|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-05-09 23:59:00|        132|         0|    null| null|      null|    null|    Porto|15.1|19.7|11.2|null|\n|     179|   1490275|   Suiça|     Registado|    631|        Twin Comfort|No Reembolsable 13%|2022-05-07 13:42:...|  2022-05-09|  2022-05-13|         4|       2|      2|       0|    0|460.0799999999|        Twin Comfort|         8|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-05-09 23:59:00|        132|         0|    null| null|      null|    null|    Porto|16.5|21.7|12.8|null|\n|     179|   1490275|   Suiça|     Registado|    631|        Twin Comfort|No Reembolsable 13%|2022-05-07 13:42:...|  2022-05-09|  2022-05-13|         4|       2|      2|       0|    0|460.0799999999|        Twin Comfort|         8|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-05-09 23:59:00|        132|         0|    null| null|      null|    null|    Porto|18.5|23.9|14.2|null|\n|     310|   1444650|Portugal|    Modificada|   1424|Quarto Twin Standard|              PROMO|2022-03-01 16:27:...|  2022-03-02|  2022-03-04|         2|       2|      2|       0|    0|          88.0|Quarto Twin Standard|        25|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-05-09 23:59:00|        192|         0|    null| null|      null|    null|    Porto| 9.7|14.6| 5.6| 0.0|\n|     310|   1444650|Portugal|    Modificada|   1424|Quarto Twin Standard|              PROMO|2022-03-01 16:27:...|  2022-03-02|  2022-03-04|         2|       2|      2|       0|    0|          88.0|Quarto Twin Standard|        25|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-05-09 23:59:00|        192|         0|    null| null|      null|    null|    Porto|11.6|14.6| 8.9|11.9|\n|     310|   1444650|Portugal|    Modificada|   1424|Quarto Twin Standard|              PROMO|2022-03-01 16:27:...|  2022-03-02|  2022-03-04|         2|       2|      2|       0|    0|          88.0|Quarto Twin Standard|        25|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-05-09 23:59:00|        192|         0|    null| null|      null|    null|    Porto|10.7|16.2| 7.3| 0.5|\n|     493|   1684542|Portugal|     Registado|   2323|  Apartamento T1 R/C|                Bar|2023-02-24 11:50:...|  2023-02-27|  2023-03-03|         4|       2|      2|       0|    0|         420.0|  Apartamento T1 R/C|         1|                4|                     4|                      3|                   1|  Carnaxide|       Carnaxide|       0|                 0|              0|2023-05-09 12:00:00|          5|         0|    null| null|      null|    null|Carnaxide|10.7|15.3| 7.1| 0.0|\n|     493|   1684542|Portugal|     Registado|   2323|  Apartamento T1 R/C|                Bar|2023-02-24 11:50:...|  2023-02-27|  2023-03-03|         4|       2|      2|       0|    0|         420.0|  Apartamento T1 R/C|         1|                4|                     4|                      3|                   1|  Carnaxide|       Carnaxide|       0|                 0|              0|2023-05-09 12:00:00|          5|         0|    null| null|      null|    null|Carnaxide|10.0|14.3| 6.6| 0.0|\n|     493|   1684542|Portugal|     Registado|   2323|  Apartamento T1 R/C|                Bar|2023-02-24 11:50:...|  2023-02-27|  2023-03-03|         4|       2|      2|       0|    0|         420.0|  Apartamento T1 R/C|         1|                4|                     4|                      3|                   1|  Carnaxide|       Carnaxide|       0|                 0|              0|2023-05-09 12:00:00|          5|         0|    null| null|      null|    null|Carnaxide| 9.5|12.9| 6.5| 0.0|\n|     493|   1684542|Portugal|     Registado|   2323|  Apartamento T1 R/C|                Bar|2023-02-24 11:50:...|  2023-02-27|  2023-03-03|         4|       2|      2|       0|    0|         420.0|  Apartamento T1 R/C|         1|                4|                     4|                      3|                   1|  Carnaxide|       Carnaxide|       0|                 0|              0|2023-05-09 12:00:00|          5|         0|    null| null|      null|    null|Carnaxide|10.0|13.1| 6.9| 0.0|\n+--------+----------+--------+--------------+-------+--------------------+-------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------+-----+----------+--------+---------+----+----+----+----+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinMeteoTemp\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 37 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": false
         },
         {
          "name": "Location",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "Event",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "start_Date",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "end_date",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "city",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "tavg",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "tmax",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "tmin",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "prcp",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "val joinMeteoTemp = spark.sql(\"select * from JoinMeteoTemp\")\n//joinMeteoTemp.show(100000)\n\njoinMeteoTemp.createOrReplaceTempView(\"JoinedDataset\")\n\n//saveDataFrame(joinMeteoTemp, \"FinalDataSet\")",
   "id": "",
   "dateCreated": "2023-05-01 15:47:23.871",
   "config": {},
   "dateStarted": "2023-05-10 00:10:50.279",
   "dateUpdated": "2023-05-10 00:10:50.479",
   "dateFinished": "2023-05-10 00:10:50.479",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[1m\u001b[34mjoinMeteoTemp\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 37 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {}
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "/* \n-----------------------------------------------------------------------------------------\n                                After Join Transformations\n-----------------------------------------------------------------------------------------\n*/",
   "id": "",
   "dateCreated": "2023-05-08 17:09:23.435",
   "config": {
    "editorHide": false
   },
   "dateStarted": "2023-05-10 00:10:50.487",
   "dateUpdated": "2023-05-10 00:10:50.593",
   "dateFinished": "2023-05-10 00:10:50.593",
   "results": {
    "code": "SUCCESS",
    "msg": []
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {}
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "val duplicateReservations = spark.sql(\"SELECT Reserve_ID, count(*) as count FROM JoinTipologiaAndHotel GROUP BY Reserve_ID\").filter($\"count\" > 1)\nprintln(duplicateReservations.count())\nduplicateReservations.show()",
   "id": "",
   "dateCreated": "2023-05-08 17:50:08.525",
   "config": {},
   "dateStarted": "2023-05-10 00:10:50.594",
   "dateUpdated": "2023-05-10 00:10:56.372",
   "dateFinished": "2023-05-10 00:10:56.371",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "1060\n+----------+-----+\n|Reserve_ID|count|\n+----------+-----+\n|   1496883|    2|\n|   1696164|    2|\n|   1482093|    2|\n|   1649924|    4|\n|   1630633|    2|\n|   1683856|    2|\n|   1467564|    4|\n|   1694268|    2|\n|   1493490|    2|\n|   1522179|    2|\n|   1507650|    2|\n|   1600427|    2|\n|   1688117|    2|\n|   1630293|    4|\n|   1530600|    3|\n|   1644433|    2|\n|   1702047|    2|\n|   1649048|    2|\n|   1721754|    2|\n|   1624186|    2|\n+----------+-----+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mduplicateReservations\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [Reserve_ID: int, count: bigint]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {}
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "spark.sql(\"SELECT * FROM JoinedDataset\").show()",
   "id": "",
   "dateCreated": "2023-05-08 17:09:27.489",
   "config": {},
   "dateStarted": "2023-05-10 00:10:56.381",
   "dateUpdated": "2023-05-10 00:11:00.126",
   "dateFinished": "2023-05-10 00:11:00.126",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+--------+----------+--------+--------------+-------+--------------------+-------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------+-----+----------+--------+---------+----+----+----+----+\n|hotel_ID|Reserve_ID|    pais|estado_reserva|room_ID|       Q_tipo_quarto|          rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|   preco_euros|       T_tipo_quarto|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|Location|Event|start_Date|end_date|     city|tavg|tmax|tmin|prcp|\n+--------+----------+--------+--------------+-------+--------------------+-------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------+-----+----------+--------+---------+----+----+----+----+\n|     225|   1617407|  França|     Registado|    846|Apartamento Vista...|                 OR|2022-10-30 11:11:...|  2022-11-09|  2022-11-14|         5|       3|      3|       0|    0|        1075.0|Apartamento Vista...|         3|                5|                     5|                      4|                   2|      Porto|           Porto|       0|                 2|             24|2023-05-09 17:00:00|          5|         0|    null| null|      null|    null|    Porto|14.5|16.2|13.1| 3.2|\n|     225|   1617407|  França|     Registado|    846|Apartamento Vista...|                 OR|2022-10-30 11:11:...|  2022-11-09|  2022-11-14|         5|       3|      3|       0|    0|        1075.0|Apartamento Vista...|         3|                5|                     5|                      4|                   2|      Porto|           Porto|       0|                 2|             24|2023-05-09 17:00:00|          5|         0|    null| null|      null|    null|    Porto|15.7|18.6|13.7|17.4|\n|     225|   1617407|  França|     Registado|    846|Apartamento Vista...|                 OR|2022-10-30 11:11:...|  2022-11-09|  2022-11-14|         5|       3|      3|       0|    0|        1075.0|Apartamento Vista...|         3|                5|                     5|                      4|                   2|      Porto|           Porto|       0|                 2|             24|2023-05-09 17:00:00|          5|         0|    null| null|      null|    null|    Porto|15.5|20.0|12.0| 0.0|\n|     225|   1617407|  França|     Registado|    846|Apartamento Vista...|                 OR|2022-10-30 11:11:...|  2022-11-09|  2022-11-14|         5|       3|      3|       0|    0|        1075.0|Apartamento Vista...|         3|                5|                     5|                      4|                   2|      Porto|           Porto|       0|                 2|             24|2023-05-09 17:00:00|          5|         0|    null| null|      null|    null|    Porto|15.5|20.5|12.0| 0.0|\n|     225|   1617407|  França|     Registado|    846|Apartamento Vista...|                 OR|2022-10-30 11:11:...|  2022-11-09|  2022-11-14|         5|       3|      3|       0|    0|        1075.0|Apartamento Vista...|         3|                5|                     5|                      4|                   2|      Porto|           Porto|       0|                 2|             24|2023-05-09 17:00:00|          5|         0|    null| null|      null|    null|    Porto|15.9|19.7|13.9| 0.0|\n|     225|   1617407|  França|     Registado|    846|Apartamento Vista...|                 OR|2022-10-30 11:11:...|  2022-11-09|  2022-11-14|         5|       3|      3|       0|    0|        1075.0|Apartamento Vista...|         3|                5|                     5|                      4|                   2|      Porto|           Porto|       0|                 2|             24|2023-05-09 17:00:00|          5|         0|    null| null|      null|    null|    Porto|14.7|16.7|13.3|20.6|\n|     311|   1491643|  França|     Registado|   1407|DB - Quarto Duplo...|       DB Room Only|2022-05-09 12:41:...|  2022-06-09|  2022-06-10|         1|       1|      1|       0|    0|          74.0|DB - Quarto Duplo...|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-05-09 23:59:00|         30|         1|    null| null|      null|    null|     Maia|20.5|24.1|16.6| 0.0|\n|     311|   1491643|  França|     Registado|   1407|DB - Quarto Duplo...|       DB Room Only|2022-05-09 12:41:...|  2022-06-09|  2022-06-10|         1|       1|      1|       0|    0|          74.0|DB - Quarto Duplo...|         8|                2|                     2|                      2|                   0|       Maia|            Maia|       3|                12|             36|2023-05-09 23:59:00|         30|         1|    null| null|      null|    null|     Maia|19.6|22.9|17.4| 0.0|\n|     179|   1490275|   Suiça|     Registado|    631|        Twin Comfort|No Reembolsable 13%|2022-05-07 13:42:...|  2022-05-09|  2022-05-13|         4|       2|      2|       0|    0|460.0799999999|        Twin Comfort|         8|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-05-09 23:59:00|        132|         0|    null| null|      null|    null|    Porto|18.5|24.3|14.0|null|\n|     179|   1490275|   Suiça|     Registado|    631|        Twin Comfort|No Reembolsable 13%|2022-05-07 13:42:...|  2022-05-09|  2022-05-13|         4|       2|      2|       0|    0|460.0799999999|        Twin Comfort|         8|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-05-09 23:59:00|        132|         0|    null| null|      null|    null|    Porto|16.8|21.7|12.6|null|\n|     179|   1490275|   Suiça|     Registado|    631|        Twin Comfort|No Reembolsable 13%|2022-05-07 13:42:...|  2022-05-09|  2022-05-13|         4|       2|      2|       0|    0|460.0799999999|        Twin Comfort|         8|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-05-09 23:59:00|        132|         0|    null| null|      null|    null|    Porto|15.1|19.7|11.2|null|\n|     179|   1490275|   Suiça|     Registado|    631|        Twin Comfort|No Reembolsable 13%|2022-05-07 13:42:...|  2022-05-09|  2022-05-13|         4|       2|      2|       0|    0|460.0799999999|        Twin Comfort|         8|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-05-09 23:59:00|        132|         0|    null| null|      null|    null|    Porto|16.5|21.7|12.8|null|\n|     179|   1490275|   Suiça|     Registado|    631|        Twin Comfort|No Reembolsable 13%|2022-05-07 13:42:...|  2022-05-09|  2022-05-13|         4|       2|      2|       0|    0|460.0799999999|        Twin Comfort|         8|                2|                     2|                      0|                   0|      Porto|           Porto|       4|                12|             24|2023-05-09 23:59:00|        132|         0|    null| null|      null|    null|    Porto|18.5|23.9|14.2|null|\n|     310|   1444650|Portugal|    Modificada|   1424|Quarto Twin Standard|              PROMO|2022-03-01 16:27:...|  2022-03-02|  2022-03-04|         2|       2|      2|       0|    0|          88.0|Quarto Twin Standard|        25|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-05-09 23:59:00|        192|         0|    null| null|      null|    null|    Porto| 9.7|14.6| 5.6| 0.0|\n|     310|   1444650|Portugal|    Modificada|   1424|Quarto Twin Standard|              PROMO|2022-03-01 16:27:...|  2022-03-02|  2022-03-04|         2|       2|      2|       0|    0|          88.0|Quarto Twin Standard|        25|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-05-09 23:59:00|        192|         0|    null| null|      null|    null|    Porto|11.6|14.6| 8.9|11.9|\n|     310|   1444650|Portugal|    Modificada|   1424|Quarto Twin Standard|              PROMO|2022-03-01 16:27:...|  2022-03-02|  2022-03-04|         2|       2|      2|       0|    0|          88.0|Quarto Twin Standard|        25|                2|                     2|                      1|                   0|       Gaia|           Porto|       3|                 0|              0|2023-05-09 23:59:00|        192|         0|    null| null|      null|    null|    Porto|10.7|16.2| 7.3| 0.5|\n|     493|   1684542|Portugal|     Registado|   2323|  Apartamento T1 R/C|                Bar|2023-02-24 11:50:...|  2023-02-27|  2023-03-03|         4|       2|      2|       0|    0|         420.0|  Apartamento T1 R/C|         1|                4|                     4|                      3|                   1|  Carnaxide|       Carnaxide|       0|                 0|              0|2023-05-09 12:00:00|          5|         0|    null| null|      null|    null|Carnaxide|10.7|15.3| 7.1| 0.0|\n|     493|   1684542|Portugal|     Registado|   2323|  Apartamento T1 R/C|                Bar|2023-02-24 11:50:...|  2023-02-27|  2023-03-03|         4|       2|      2|       0|    0|         420.0|  Apartamento T1 R/C|         1|                4|                     4|                      3|                   1|  Carnaxide|       Carnaxide|       0|                 0|              0|2023-05-09 12:00:00|          5|         0|    null| null|      null|    null|Carnaxide|10.0|14.3| 6.6| 0.0|\n|     493|   1684542|Portugal|     Registado|   2323|  Apartamento T1 R/C|                Bar|2023-02-24 11:50:...|  2023-02-27|  2023-03-03|         4|       2|      2|       0|    0|         420.0|  Apartamento T1 R/C|         1|                4|                     4|                      3|                   1|  Carnaxide|       Carnaxide|       0|                 0|              0|2023-05-09 12:00:00|          5|         0|    null| null|      null|    null|Carnaxide| 9.5|12.9| 6.5| 0.0|\n|     493|   1684542|Portugal|     Registado|   2323|  Apartamento T1 R/C|                Bar|2023-02-24 11:50:...|  2023-02-27|  2023-03-03|         4|       2|      2|       0|    0|         420.0|  Apartamento T1 R/C|         1|                4|                     4|                      3|                   1|  Carnaxide|       Carnaxide|       0|                 0|              0|2023-05-09 12:00:00|          5|         0|    null| null|      null|    null|Carnaxide|10.0|13.1| 6.9| 0.0|\n+--------+----------+--------+--------------+-------+--------------------+-------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+--------------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------+-----+----------+--------+---------+----+----+----+----+\nonly showing top 20 rows\n\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "event_Location",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "event",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "city",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "temperature_avg",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "temperature_tmax",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "temperature_min",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "precipitation_avg",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "// Join pelo reserve_ID\n// Selecionar tudo das reservas\n\nvar finalDataSet = spark.sql(\n    \"\"\"\n    SELECT \n        first(hotel_ID) AS hotel_ID, \n        Reserve_ID,\n        first(pais) AS pais,\n        first(estado_reserva) AS estado_reserva,\n        first(room_ID) AS room_ID,\n        first(T_tipo_quarto) AS tipo_quarto,\n        first(rate_plan) AS rate_plan,\n        first(data_reserva) AS data_reserva,\n        first(data_chegada) AS data_chegada,\n        first(data_partida) AS data_partida,\n        first(num_noites) AS num_noites,\n        first(ocupacao) AS ocupacao,\n        first(adultos) AS adultos,\n        first(criancas) AS criancas,\n        first(bebes) AS bebes,\n        first(preco_euros) AS preco_euros,\n        first(quantidade) AS quantidade,\n        first(capacidade_maxima) AS capacidade_maxima,\n        first(capacidade_max_adultos) AS capacidade_max_adultos,\n        first(capacidade_max_criancas) AS capacidade_max_criancas,\n        first(capacidade_max_bebes) AS capacidade_max_bebes,\n        first(localizacao) AS localizacao,\n        first(area_localizacao) AS area_localizacao,\n        first(estrelas) AS estrelas,\n        first(idade_max_criancas) AS idade_max_criancas,\n        first(idade_max_bebes) AS idade_max_bebes,\n        first(hora_max_checkin) AS hora_max_checkin,\n        first(qtd_quartos) AS qtd_quartos,\n        first(is_holiday) AS is_holiday,\n        first(Location) AS event_Location,\n        first(Event) AS event,\n        first(city) AS city,\n        avg(tavg) AS temperature_avg,\n        max(tmax) AS temperature_tmax,\n        min(tmin) AS temperature_min,\n        avg(prcp) AS precipitation_avg\n       \n    FROM JoinedDataset\n    GROUP BY Reserve_ID\n    \"\"\")\nfinalDataSet.cache()",
   "id": "",
   "dateCreated": "2023-05-08 17:09:37.474",
   "config": {},
   "dateStarted": "2023-05-10 00:11:33.272",
   "dateUpdated": "2023-05-10 00:11:33.450",
   "dateFinished": "2023-05-10 00:11:33.449",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[1m\u001b[34mfinalDataSet\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 34 more fields]\n\u001b[1m\u001b[34mres48\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 34 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "println(finalDataSet.count())\nfinalDataSet.show()",
   "id": "",
   "dateCreated": "2023-05-10 00:11:20.730",
   "config": {},
   "dateStarted": "2023-05-10 00:11:36.395",
   "dateUpdated": "2023-05-10 00:11:37.511",
   "dateFinished": "2023-05-10 00:11:37.511",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "21195\n+--------+----------+--------------+--------------+-------+--------------------+-------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------------+-----+----------------+------------------+----------------+---------------+------------------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|         tipo_quarto|          rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|preco_euros|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|event_Location|event|            city|   temperature_avg|temperature_tmax|temperature_min| precipitation_avg|\n+--------+----------+--------------+--------------+-------+--------------------+-------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------------+-----+----------------+------------------+----------------+---------------+------------------+\n|     395|   1423075|       Espanha|     Cancelado|   1828|             Estúdio|           Standard|2022-01-16 17:45:...|  2022-02-25|  2022-02-27|         2|       2|      4|       0|    0|      280.0|         5|                2|                     2|                      0|                   1|               Porto|           Porto|       0|                 3|             36|2023-05-09 20:00:00|         16|         0|          null| null|           Porto|12.566666666666668|            18.9|            6.5|              null|\n|     535|   1429890|      Portugal|     Registado|   2523|        Quarto Duplo|            WebSite|2022-02-02 15:28:...|  2022-02-06|  2022-02-07|         1|       2|      2|       0|    0|       58.5|         5|                3|                     2|                      1|                   1| Travanca do Mondego|         Coimbra|       4|                12|             24|2023-05-09 23:55:00|         11|         0|          null| null|         Coimbra|              11.2|            18.0|            6.9|              null|\n|     539|   1434277|      Portugal|     Registado|   2546|            Villa T2|                Bar|2022-02-11 12:50:...|  2022-02-12|  2022-02-13|         1|       1|      1|       0|    0|      160.0|         2|                4|                     4|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-09 18:00:00|         58|         0|          null| null|          Amares|              9.95|            13.1|            6.8|              null|\n|     179|   1434507|Estados Unidos|     Cancelado|    630|      Duplo  Comfort|        Tarifa Base|2022-02-11 21:12:...|  2022-07-09|  2022-07-13|         4|       2|      2|       0|    0|     593.64|        27|                2|                     2|                      0|                   0|               Porto|           Porto|       4|                12|             24|2023-05-09 23:59:00|        132|         0|          null| null|           Porto|             25.68|            38.1|           14.1|               0.0|\n|     280|   1435255|      Portugal|     Registado|   2564|      SUITE FAMILIAR|                BAR|2022-02-13 15:47:...|  2022-04-23|  2022-04-24|         1|       2|      2|       2|    0|      200.0|         2|                4|                     3|                      2|                   2|    Viana do Castelo|Viana do Castelo|       4|                12|             24|2023-05-09 23:59:00|         37|         0|          null| null|Viana do Castelo|             12.05|            16.6|            7.4|              null|\n|     309|   1437296|      Portugal|      Pendente|   1372|Quarto Duplo Stan...|              PROMO|2022-02-16 14:20:...|  2022-02-16|  2022-02-17|         1|       1|      1|       0|    0|       43.0|        10|                2|                     2|                      1|                   0|             Valongo|           Porto|       3|                12|              4|2023-05-09 23:59:00|         41|         0|          null| null|           Porto|12.350000000000001|            16.4|            9.1|1.5499999999999998|\n|     310|   1441431|      Portugal|      Pendente|   1424|Quarto Twin Standard|              PROMO|2022-02-23 14:03:...|  2022-02-23|  2022-02-24|         1|       2|      2|       0|    0|       39.6|        25|                2|                     2|                      1|                   0|                Gaia|           Porto|       3|                 0|              0|2023-05-09 23:59:00|        192|         0|          null| null|           Porto|              12.2|            22.7|            6.4|               0.0|\n|     395|   1443176|      Portugal|     Cancelado|   1829|     Estúdio Jardim |           Standard|2022-02-26 20:48:...|  2022-03-01|  2022-03-02|         1|       1|      1|       0|    0|       55.0|         6|                2|                     2|                      0|                   1|               Porto|           Porto|       0|                 3|             36|2023-05-09 20:00:00|         16|         1|          null| null|           Porto|11.399999999999999|            17.0|            7.3|              4.45|\n|     311|   1450711|        França|  NãoRegistado|   1407|DB - Quarto Duplo...|       DB Room Only|2022-03-12 19:35:...|  2022-03-13|  2022-03-14|         1|       2|      2|       0|    0|       64.0|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-09 23:59:00|         30|         0|          null| null|            Maia|              10.5|            14.2|            6.3|              null|\n|     304|   1459640|      Alemanha|     Registado|   1406|  301 - Quarto Duplo|          Rack Rate|2022-03-26 20:09:...|  2022-06-27|  2022-07-01|         4|       2|      2|       0|    0|     250.24|         1|                2|                     2|                      0|                   0|             Coimbra|         Coimbra|       0|                11|             23|2023-05-09 22:30:00|         28|         0|          null| null|         Coimbra|17.099999999999998|            26.4|           11.6|               0.0|\n|     514|   1460507|Estados Unidos|     Registado|   2492|         Garden Room|  Non-Refundable >5|2022-03-28 00:08:...|  2022-06-27|  2022-07-04|         7|       2|      2|       0|    0|      924.0|         4|                3|                     2|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-09 18:00:00|         13|         0|          null| null|       Carnaxide|20.175000000000004|            30.2|           15.3|               0.0|\n|     322|   1462518|       Espanha|     Registado|   1413|               Duplo|Não Reembolsável AP|2022-03-30 16:23:...|  2022-04-02|  2022-04-03|         1|       2|      2|       0|    0|       62.0|        19|                2|                     2|                      1|                   0|              Aveiro|          Aveiro|       3|                10|             24|2023-05-09 23:59:00|         52|         0|          null| null|          Aveiro|              10.7|            15.4|            5.2|              null|\n|     310|   1466376|      Portugal|  NãoRegistado|   1395|Quarto Duplo Stan...|                NRF|2022-04-04 14:40:...|  2022-04-05|  2022-04-06|         1|       2|      2|       0|    0|       43.2|        10|                2|                     2|                      1|                   0|                Gaia|           Porto|       3|                 0|              0|2023-05-09 23:59:00|        192|         0|          null| null|           Porto|             10.85|            17.0|            6.3|              null|\n|     444|   1468011|      Portugal|     Registado|   2076|               Suite|             Normal|2022-04-06 12:31:...|  2022-04-15|  2022-04-17|         2|       2|      2|       2|    0|      320.0|         4|                4|                     2|                      3|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-09 23:59:00|         77|         1|          null| null|         Batalha|              14.6|            20.0|           11.5|              null|\n|     560|   1477495|        França|     Registado|   2866|         Estúdio 2+1|                 7N|2022-04-19 21:00:...|  2022-09-18|  2022-09-25|         7|       2|      2|       0|    0|     573.75|         1|                3|                     2|                      1|                   1|               Porto|           Porto|       0|                 3|             36|2023-05-09 20:00:00|          8|         0|          null| null|           Porto|           20.4375|            29.2|           11.8|               0.0|\n|     444|   1477635|Estados Unidos|     Registado|   2386| Twin vista  mar ...|             Normal|2022-04-20 03:36:...|  2022-05-07|  2022-05-08|         1|       2|      6|       0|    0|      270.0|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-09 23:59:00|         77|         0|          null| null|         Batalha|             16.25|            23.0|           10.6|              null|\n|     311|   1479818|      Alemanha|     Cancelado|   1407|DB - Quarto Duplo...|           Duplo BB|2022-04-23 08:57:...|  2022-07-02|  2022-07-03|         1|       2|      2|       0|    0|       99.0|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-09 23:59:00|         30|         0|          null| null|            Maia|18.450000000000003|            24.7|           14.0|               1.5|\n|     444|   1482093|      Portugal|     Registado|   2073|              Duplo |             Normal|2022-04-26 11:15:...|  2022-05-14|  2022-05-15|         1|       2|      4|       0|    0|      160.0|        14|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-09 23:59:00|         77|         0|          null| null|         Batalha|19.799999999999997|            28.0|           15.0|              null|\n|     504|   1488965|       Espanha|     Registado|   2374|       Cela da Torre|                Bar|2022-05-05 16:09:...|  2022-05-06|  2022-05-07|         1|       2|      2|       0|    0|     106.59|         1|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-09 23:59:00|         27|         0|          null| null|          Monção|              18.2|            25.9|           10.0|               0.0|\n|      44|   1489269|Estados Unidos|     Cancelado|     85| Quarto Vista Pinhão|                BAR|2022-05-05 23:32:...|  2022-07-13|  2022-07-15|         2|       2|      2|       0|    0|      268.0|         6|                2|                     2|                      0|                   0|      Pinhão - Alijó|           Alijó|       3|                12|             24|2023-05-09 23:00:00|         10|         0|          null| null|           Alijó|31.366666666666664|            40.8|           23.8|               0.0|\n+--------+----------+--------------+--------------+-------+--------------------+-------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------------+-----+----------------+------------------+----------------+---------------+------------------+\nonly showing top 20 rows\n\n"
     }
    ]
   }
  }
 ],
 "name": "Zeppelin Notebook",
 "id": "",
 "noteParams": {},
 "noteForms": {},
 "angularObjects": {},
 "config": {
  "isZeppelinNotebookCronEnable": false,
  "looknfeel": "default",
  "personalizedMode": "false"
 },
 "info": {}
}