{
 "paragraphs": [
  {
   "settings": {
    "params": {
     "bdtMeta": {}
    },
    "forms": {}
   },
   "apps": [],
   "status": "ERROR",
   "text": "import org.apache.spark.sql.DataFrame\nimport org.apache.spark.sql.functions._\n\n// Calcula o LowerLimit  usando Three Sigma\ndef calculateLowerLimit(df: DataFrame, column: String): Double = {\n  val filteredDF = df.filter(col(column) >= 0)\n  val meanValue = filteredDF.agg(mean(col(column)).as(\"mean\")).first().getDouble(0)\n  val stdDevValue = filteredDF.agg(stddev(col(column)).as(\"stddev\")).first().getDouble(0)\n  Math.max(0.0, meanValue - 3 * stdDevValue) // limite mínimo é zero\n}",
   "id": "",
   "dateCreated": "2023-05-03 22:50:26.069",
   "config": {},
   "dateStarted": "2023-05-10 20:05:41.298",
   "dateUpdated": "2023-05-10 20:05:41.378",
   "dateFinished": "2023-05-10 20:05:41.378"
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {}
    },
    "forms": {}
   },
   "apps": [],
   "status": "ERROR",
   "text": "// Calcula o UpperLimit  usando Three Sigma\n\ndef calculateUpperLimit(df: DataFrame, column: String): Double = {\n  val meanValue = df.agg(mean(col(column)).as(\"mean\")).first().getDouble(0)\n  val stdDevValue = df.agg(stddev(col(column)).as(\"stddev\")).first().getDouble(0)\n  meanValue + 3 * stdDevValue\n}",
   "id": "",
   "dateCreated": "2023-05-03 22:31:41.905",
   "config": {},
   "dateStarted": "2023-05-10 20:05:46.551",
   "dateUpdated": "2023-05-10 20:05:46.664",
   "dateFinished": "2023-05-10 20:05:46.664"
  },
  {
   "user": "anonymous",
   "config": {
    "colWidth": 12,
    "fontSize": 9,
    "enabled": true,
    "results": {},
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "editorMode": "ace/mode/scala"
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {},
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Quantidade de quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "num_linhas",
          "tpe": {
           "presentableName": "long"
          },
          "nullable": false
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "jobName": "paragraph_1563110258183_1613653816",
   "id": "20190714-161738_1950435706",
   "dateCreated": "2019-07-14T16:17:38+0300",
   "status": "FINISHED",
   "progressUpdateIntervalMs": 500,
   "focus": true,
   "$$hashKey": "object:394",
   "text": "//depois testar com o iqr 1.5\n\nval resultQuartosReservados = spark.sql(\n    \"\"\"\n     SELECT * \n      FROM InitialQuartosReservados qr\n      INNER JOIN Hotel h \n      ON h.hotel_ID = qr.hotel_ID   \n    \"\"\"\n)\n\n// Calcula a média e o desvio padrão do número de noites usando Three Sigma\n//mean: Double = 2.282015534754033\n//stdDev: Double = 4.682108190781085\nval mean = resultQuartosReservados.agg(avg(\"num_noites\")).head.getDouble(0)\nval stdDev = resultQuartosReservados.agg(stddev(\"num_noites\")).head.getDouble(0)\n//mean + 3 * stdDev \n//14.32 = 2.28 + 3 * 4.68\nval upperLimit = 14\nval lowerLimit = 0.0 \nval outliers = resultQuartosReservados.filter($\"num_noites\" > upperLimit || $\"num_noites\" < lowerLimit)\n\n// adiciona uma coluna com o número de linhas\nval resultCount = outliers.withColumn(\"num_linhas\", count(\"*\").over())\n//// exibe o valor da coluna \"num_linhas\"\nresultCount.agg(max(\"num_linhas\")).show()\noutliers.show(115)\n//result.limit(100).show(100)",
   "dateStarted": "2023-06-07 22:42:25.743",
   "dateUpdated": "2023-06-07 22:42:29.203",
   "dateFinished": "2023-06-07 22:42:29.203",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+---------------+\n|max(num_linhas)|\n+---------------+\n|            115|\n+---------------+\n\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+----------+---------------------+--------+-------+--------+-----+---------------+------------+------------+--------+--------------------+--------+------------------+---------------+-------------------+-----------+----------------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|         tipo_quarto|           rate_plan|        data_reserva|num_noites|Quantidade de quartos|ocupacao|adultos|criancas|bebes|    preco_euros|data_chegada|data_partida|hotel_ID|         localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|area_localizacao|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+----------+---------------------+--------+-------+--------+-----+---------------+------------+------------+--------+--------------------+--------+------------------+---------------+-------------------+-----------+----------------+\n|     493|   1720111|      Portugal|     Registado|   2323|  Apartamento T1 R/C|Não Reembolsável ...|2023-04-14 09:05:...|        23|                    1|       3|      3|       0|    0|         2070.0|  2023-05-31|  2023-06-23|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     493|   1717922|      Portugal|     Registado|   2800| Estudio com lareira|                 Bar|2023-04-11 15:27:...|        31|                    1|       1|      1|       0|    0|         1550.0|  2023-05-20|  2023-06-20|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     328|   1717448|       Senegal|     Cancelado|   1456|Superior Double Room|             WebSite|2023-04-10 22:48:...|        15|                    1|       1|      1|       0|    0|        1117.39|  2023-05-15|  2023-05-30|     328|              Lisboa|       0|                 0|              0|2023-06-07 22:00:00|         56|       Carnaxide|\n|     444|   1715706|        Quatar|     Registado|   2077|            Familiar|              Normal|2023-04-08 12:08:...|        25|                    1|       2|      2|       0|    0|         4020.0|  2023-04-24|  2023-05-19|     444|              Nazaré|       4|                12|             24|2023-06-07 23:59:00|         77|         Batalha|\n|     493|   1714167|      Portugal|     Cancelado|   2323|  Apartamento T1 R/C|                 Bar|2023-04-05 21:26:...|        23|                    1|       1|      1|       0|    0|         2300.0|  2023-05-31|  2023-06-23|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     482|   1710835|        Itália|     Registado|   2285|      Apartamento T1|(WEB) Best Availa...|2023-04-02 08:01:...|        18|                    1|       2|      2|       0|    0|          967.1|  2023-04-12|  2023-04-30|     482|            Portimão|       4|                 3|             36|2023-06-07 23:59:00|        143|           Lagos|\n|     328|   1705910|      Marrocos|     Registado|   1450|6 Bed Mixed Dormi...|             WebSite|2023-03-26 15:22:...|        18|                    1|       1|      1|       0|    0|         500.98|  2023-07-09|  2023-07-27|     328|              Lisboa|       0|                 0|              0|2023-06-07 22:00:00|         56|       Carnaxide|\n|     328|   1703765|    Cabo Verde|     Cancelado|   1450|6 Bed Mixed Dormi...|             WebSite|2023-03-23 12:03:...|        28|                    1|       1|      1|       0|    0|         819.08|  2023-03-27|  2023-04-24|     328|              Lisboa|       0|                 0|              0|2023-06-07 22:00:00|         56|       Carnaxide|\n|     391|   1700724|         Suiça|     Registado|   1803|            Bordeaux|        BASE.WEBSITE|2023-03-19 11:45:...|        24|                    1|       1|      1|       0|    0|         1320.0|  2023-04-11|  2023-05-05|     391|        Torres Novas|       4|                17|              0|2023-06-07 23:59:00|         19|          Amares|\n|     328|   1696421|    Cabo Verde|     Registado|   1450|6 Bed Mixed Dormi...|             WebSite|2023-03-13 10:15:...|        21|                    1|       1|      1|       0|    0|         622.63|  2023-03-20|  2023-04-10|     328|              Lisboa|       0|                 0|              0|2023-06-07 22:00:00|         56|       Carnaxide|\n|     399|   1695347|       Espanha|     Registado|   1859|1 Bedroom Garden ...| Best Available Rate|2023-03-11 18:50:...|        17|                    1|       3|      3|       0|    0|         2720.0|  2023-08-13|  2023-08-30|     399|              Tavira|       0|                 3|              0|2023-06-07 16:00:00|          9|       Albufeira|\n|     328|   1694270|     Argentina|     Registado|   1453|Standard Double Room|    B.A.R. (onlines)|2023-03-09 22:02:...|        15|                    1|       2|      2|       0|    0|         1064.0|  2023-03-14|  2023-03-29|     328|              Lisboa|       0|                 0|              0|2023-06-07 22:00:00|         56|       Carnaxide|\n|     493|   1693880|      Portugal|     Registado|   2338| Estudio com Terraço|                 Bar|2023-03-09 12:46:...|        31|                    1|       1|      1|       0|    0|         1457.0|  2023-05-05|  2023-06-05|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     310|   1693446|        Brasil|     Registado|   1673|Quarto Duplo Supe...|      MR - Main Rate|2023-03-08 18:34:...|        18|                    1|       2|      2|       0|    0|        912.285|  2023-04-09|  2023-04-27|     310|                Gaia|       3|                 0|              0|2023-06-07 23:59:00|        192|           Porto|\n|     493|   1692422|      Portugal|     Registado|   2338| Estudio com Terraço|                 Bar|2023-03-07 10:55:...|        16|                    1|       1|      1|       0|    0|         1120.0|  2023-03-10|  2023-03-26|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     493|   1689583|      Portugal|     Registado|   2324|    Estudio com sala|                 Bar|2023-03-03 11:09:...|       168|                    1|       1|      1|       0|    0|         6600.0|  2023-03-16|  2023-08-31|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     493|   1689577|      Portugal|     Cancelado|   2800| Estudio com lareira|Não Reembolsável ...|2023-03-03 11:02:...|       168|                    1|       1|      1|       0|    0|         6652.8|  2023-03-16|  2023-08-31|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     328|   1685188|    Cabo Verde|     Cancelado|   1452|         Single Room|             WebSite|2023-02-25 12:06:...|        17|                    1|       1|      1|       0|    0|         909.17|  2023-04-05|  2023-04-22|     328|              Lisboa|       0|                 0|              0|2023-06-07 22:00:00|         56|       Carnaxide|\n|     309|   1677758|      Portugal|    Modificada|   2254|Quarto Duplo Supe...|                  NR|2023-02-13 21:08:...|        15|                    1|       2|      2|       0|    0|          741.0|  2023-02-18|  2023-03-05|     309|             Valongo|       3|                12|              4|2023-06-07 23:59:00|         41|           Porto|\n|     309|   1677748|      Portugal|  NãoRegistado|   2254|Quarto Duplo Supe...|                  NR|2023-02-13 20:49:...|        15|                    1|       2|      2|       0|    0|          741.0|  2023-02-18|  2023-03-05|     309|             Valongo|       3|                12|              4|2023-06-07 23:59:00|         41|           Porto|\n|     493|   1677401|      Portugal|     Registado|   2800| Estudio com lareira|                 Bar|2023-02-13 13:25:...|        31|                    1|       1|      1|       0|    0|         1364.0|  2023-03-17|  2023-04-17|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     328|   1674186|    Cabo Verde|     Registado|   1453|Standard Double Room|    B.A.R. (onlines)|2023-02-08 13:23:...|        15|                    1|       1|      1|       0|    0|         1090.0|  2023-05-09|  2023-05-24|     328|              Lisboa|       0|                 0|              0|2023-06-07 22:00:00|         56|       Carnaxide|\n|     493|   1668644|      Portugal|     Cancelado|   2338| Estudio com Terraço|                 Bar|2023-01-31 17:01:...|       481|                    1|       1|      1|       0|    0|        20683.0|  2023-02-05|  2024-05-31|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     490|   1666181|      Portugal|     Registado|   2317|      Apartamento T1|                 Bar|2023-01-27 19:09:...|        21|                    1|       2|      2|       0|    0|         2100.0|  2023-02-16|  2023-03-09|     490|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     492|   1664223|      Portugal|     Cancelado|   2321|      Apartamento T2|                 Bar|2023-01-25 16:46:...|        21|                    1|       2|      2|       0|    0|         2940.0|  2023-02-16|  2023-03-09|     492|              Lisboa|       0|                 0|              0|2023-06-07 09:00:00|         13|       Carnaxide|\n|     478|   1661543|   Reino Unido|     Registado|   2231|Duplo (Cama de Ca...|    Não Reembolsável|2023-01-22 10:13:...|        32|                    1|       2|      2|       0|    0|        2721.75|  2023-06-11|  2023-07-13|     478|             Estoril|       2|                12|             24|2023-06-07 18:00:00|         26|      Carcavelos|\n|     392|   1649999|         Suiça|     Registado|   1889|        APARTAMENTO |     Oferta Especial|2023-01-04 13:33:...|        21|                    1|       2|      2|       0|    0|     2260.09224|  2023-06-01|  2023-06-22|     392|               Olhão|       4|                11|             24|2023-06-07 23:30:00|         19|       Albufeira|\n|     492|   1642762|      Portugal|     Registado|   2801|Apartamento com 3...|                 Bar|2022-12-19 11:12:...|        48|                    1|       3|      3|       0|    0|         9158.4|  2022-12-19|  2023-02-05|     492|              Lisboa|       0|                 0|              0|2023-06-07 09:00:00|         13|       Carnaxide|\n|     493|   1641157|      Portugal|     Registado|   2324|    Estudio com sala|Não Reembolsável ...|2022-12-15 13:21:...|        29|                    1|       2|      2|       0|    0|         1305.0|  2022-12-30|  2023-01-28|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     490|   1626899|      Portugal|     Registado|   2574|Quarto familiar c...|Promoção mais 7 n...|2022-11-17 09:01:...|       149|                    1|       1|      1|       0|    0|         5587.5|  2023-02-01|  2023-06-30|     490|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     503|   1619837|        Brasil|     Cancelado|   2784|Individual Econom...|              BAR RO|2022-11-03 16:22:...|       149|                    1|       1|      1|       0|    0|         6505.0|  2023-02-02|  2023-07-01|     503|              Aveiro|       3|                10|             36|2023-06-07 23:00:00|        187|          Aveiro|\n|     493|   1618127|      Portugal|     Registado|   2338| Estudio com Terraço|                 Bar|2022-10-31 16:55:...|        27|                    1|       2|      2|       0|    0|         1600.0|  2022-10-31|  2022-11-27|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     493|   1615124|      Portugal|     Registado|   2323|  Apartamento T1 R/C|Não Reembolsável ...|2022-10-25 18:10:...|        30|                    1|       1|      1|       0|    0|         1600.0|  2022-11-03|  2022-12-03|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     392|   1613784|      Alemanha|     Registado|   1889|        APARTAMENTO |       Epoca Normal |2022-10-23 14:36:...|        16|                    1|       2|      2|       0|    0|        1207.04|  2023-03-13|  2023-03-29|     392|               Olhão|       4|                11|             24|2023-06-07 23:30:00|         19|       Albufeira|\n|     494|   1613490|      Portugal|     Registado|   2383|Quarto twin Com W...|    Promoção7 noites|2022-10-22 19:29:...|        41|                    1|       1|      1|       0|    0|         1400.0|  2022-11-04|  2022-12-15|     494|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     492|   1612233|      Portugal|     Registado|   2333|Quarto de casal c...|                 Bar|2022-10-20 12:31:...|        85|                    1|       1|      1|       0|    0|         3000.0|  2022-11-07|  2023-01-31|     492|              Lisboa|       0|                 0|              0|2023-06-07 09:00:00|         13|       Carnaxide|\n|     482|   1611150|        França|     Registado|   2285|      Apartamento T1|(WEB) Best Availa...|2022-10-18 17:20:...|        15|                    1|       2|      2|       0|    0|          621.3|  2022-10-20|  2022-11-04|     482|            Portimão|       4|                 3|             36|2023-06-07 23:59:00|        143|           Lagos|\n|     494|   1609729|      Portugal|     Registado|   2383|Quarto twin Com W...|    Promoção7 noites|2022-10-16 18:24:...|        60|                    1|       1|      1|       0|    0|         2805.0|  2022-11-01|  2022-12-31|     494|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     379|   1604976|   Reino Unido|     Registado|   1739|Suite T1 Vista Ma...|      Non Refundable|2022-10-09 14:07:...|        16|                    1|       2|      2|       2|    0|        3177.75|  2023-06-30|  2023-07-16|     379|               Lagos|       4|                10|             36|2023-06-07 18:00:00|         26|           Lagos|\n|     444|   1604775|        Quatar|     Registado|   2229|              Triplo|              Normal|2022-10-09 07:04:...|        30|                    1|       2|      2|       0|    0|         3320.0|  2022-10-20|  2022-11-19|     444|              Nazaré|       4|                12|             24|2023-06-07 23:59:00|         77|         Batalha|\n|     492|   1598223|      Portugal|     Registado|   2321|      Apartamento T2|           7 noites |2022-09-28 17:54:...|        18|                    1|       1|      1|       0|    0|         1620.0|  2022-10-14|  2022-11-01|     492|              Lisboa|       0|                 0|              0|2023-06-07 09:00:00|         13|       Carnaxide|\n|     490|   1594795|      Portugal|     Registado|   2799| Apartamento estúdio|                 Bar|2022-09-23 15:50:...|        30|                    1|       1|      1|       0|    0|         1600.0|  2022-10-01|  2022-10-31|     490|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     493|   1594243|      Portugal|     Registado|   2324|    Estudio com sala|Não Reembolsável ...|2022-09-22 18:03:...|        16|                    1|       1|      1|       0|    0|          850.0|  2022-10-15|  2022-10-31|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     490|   1594217|      Portugal|     Registado|   2798|Apartamento Estúd...|                 Bar|2022-09-22 17:38:...|        30|                    1|       2|      2|       0|    0|         1700.0|  2022-09-26|  2022-10-26|     490|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     482|   1592168|      Portugal|     Registado|   2285|      Apartamento T1|(WEB) Best Availa...|2022-09-19 16:49:...|        15|                    1|       2|      2|       0|    0|          988.0|  2022-09-24|  2022-10-09|     482|            Portimão|       4|                 3|             36|2023-06-07 23:59:00|        143|           Lagos|\n|     556|   1589602|      Portugal|      Pendente|   2831|Double Room Standard|WEB (Best Availab...|2022-09-15 11:01:...|        31|                    1|       1|      1|       0|    0|        1556.75|  2022-10-01|  2022-11-01|     556|             Covilhã|       3|                10|              3|2023-06-07 23:00:00|         84|  Castelo Branco|\n|     328|   1586909|        Angola|     Registado|   1452|         Single Room|             WebSite|2022-09-11 16:23:...|        20|                    1|       1|      1|       0|    0|         1261.6|  2022-09-30|  2022-10-20|     328|              Lisboa|       0|                 0|              0|2023-06-07 22:00:00|         56|       Carnaxide|\n|     328|   1586909|        Angola|     Registado|   1453|Standard Double Room|             WebSite|2022-09-11 16:23:...|        20|                    1|       1|      1|       0|    0|        1594.97|  2022-09-30|  2022-10-20|     328|              Lisboa|       0|                 0|              0|2023-06-07 22:00:00|         56|       Carnaxide|\n|     492|   1586762|      Portugal|     Registado|   2322|Quarto twin com W...|           7 noites |2022-09-11 12:17:...|        31|                    1|       2|      2|       0|    0|         1100.0|  2022-09-30|  2022-10-31|     492|              Lisboa|       0|                 0|              0|2023-06-07 09:00:00|         13|       Carnaxide|\n|     492|   1585707|      Portugal|     Registado|   2321|      Apartamento T2|                 Bar|2022-09-09 12:44:...|        30|                    1|       3|      3|       0|    0|         4000.0|  2022-09-14|  2022-10-14|     492|              Lisboa|       0|                 0|              0|2023-06-07 09:00:00|         13|       Carnaxide|\n|     395|   1583953|        Brasil|     Registado|   1828|             Estúdio|                  7N|2022-09-06 19:58:...|        16|                    1|       2|      2|       0|    0|          902.7|  2022-12-20|  2023-01-05|     395|               Porto|       0|                 3|             36|2023-06-07 20:00:00|         16|           Porto|\n|     493|   1578001|      Portugal|     Registado|   2323|  Apartamento T1 R/C|Não Reembolsável ...|2022-08-29 10:13:...|        31|                    1|       1|      1|       0|    0|         1600.0|  2022-10-03|  2022-11-03|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     493|   1574736|      Portugal|     Registado|   2324|    Estudio com sala|Não Reembolsável ...|2022-08-24 11:10:...|        52|                    1|       1|      1|       0|    0|         3000.0|  2022-08-24|  2022-10-15|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     482|   1571909|        Itália|     Registado|   2285|      Apartamento T1|(WEB) Best Availa...|2022-08-19 20:56:...|        21|                    1|       2|      2|       0|    0|         3125.5|  2022-08-26|  2022-09-16|     482|            Portimão|       4|                 3|             36|2023-06-07 23:59:00|        143|           Lagos|\n|     493|   1570488|      Portugal|     Registado|   2800|Estudio com 2 qua...|                 Bar|2022-08-17 17:18:...|        20|                    1|       1|      1|       0|    0|         1800.0|  2022-08-21|  2022-09-10|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     492|   1570239|      Portugal|     Registado|   2333|Quarto de casal c...|                 Bar|2022-08-17 11:55:...|        57|                    1|       1|      1|       0|    0|         1500.0|  2022-08-19|  2022-10-15|     492|              Lisboa|       0|                 0|              0|2023-06-07 09:00:00|         13|       Carnaxide|\n|     492|   1567912|      Portugal|     Registado|   2322|Quarto twin com W...|                 Bar|2022-08-13 19:25:...|       147|                    1|       1|      1|       0|    0|         4500.0|  2022-09-06|  2023-01-31|     492|              Lisboa|       0|                 0|              0|2023-06-07 09:00:00|         13|       Carnaxide|\n|     493|   1567160|      Portugal|     Cancelado|   2338| Estudio com Terraço|Não Reembolsável ...|2022-08-12 14:28:...|        91|                    1|       2|      2|       0|    0|         4800.0|  2022-08-25|  2022-11-24|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     392|   1566703|      Alemanha|     Registado|   1889|        APARTAMENTO |     Oferta Especial|2022-08-11 19:56:...|        29|                    1|       1|      1|       0|    0|        1735.65|  2022-11-04|  2022-12-03|     392|               Olhão|       4|                11|             24|2023-06-07 23:30:00|         19|       Albufeira|\n|     493|   1565579|      Portugal|     Registado|   2324|    Estudio com sala|                 Bar|2022-08-10 10:03:...|        60|                    1|       2|      2|       0|    0|         3000.0|  2022-08-16|  2022-10-15|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     309|   1562692|      Portugal|     Registado|   2254|Quarto Duplo Supe...|      MR - Main Rate|2022-08-06 15:06:...|        17|                    2|       1|      2|       2|    0|        1799.28|  2022-08-27|  2022-09-13|     309|             Valongo|       3|                12|              4|2023-06-07 23:59:00|         41|           Porto|\n|     309|   1562215|      Portugal|  NãoRegistado|   1430|Quarto Twin Superior|      MR - Main Rate|2022-08-05 17:42:...|        17|                    1|       1|      1|       1|    0|         899.64|  2022-08-27|  2022-09-13|     309|             Valongo|       3|                12|              4|2023-06-07 23:59:00|         41|           Porto|\n|     309|   1562215|      Portugal|  NãoRegistado|   2254|Quarto Duplo Supe...|      MR - Main Rate|2022-08-05 17:42:...|        17|                    1|       1|      1|       1|    0|         899.64|  2022-08-27|  2022-09-13|     309|             Valongo|       3|                12|              4|2023-06-07 23:59:00|         41|           Porto|\n|     309|   1562182|      Portugal|  NãoRegistado|   1430|Quarto Twin Superior|      MR - Main Rate|2022-08-05 17:07:...|        17|                    1|       1|      1|       1|    0|         899.64|  2022-08-27|  2022-09-13|     309|             Valongo|       3|                12|              4|2023-06-07 23:59:00|         41|           Porto|\n|     309|   1562182|      Portugal|  NãoRegistado|   2254|Quarto Duplo Supe...|      MR - Main Rate|2022-08-05 17:07:...|        17|                    1|       1|      1|       1|    0|         899.64|  2022-08-27|  2022-09-13|     309|             Valongo|       3|                12|              4|2023-06-07 23:59:00|         41|           Porto|\n|     494|   1559787|      Portugal|     Registado|   2331|Quarto twin com W...|    Promoção7 noites|2022-08-02 13:29:...|       130|                    1|       1|      1|       0|    0|         3600.0|  2022-09-07|  2023-01-15|     494|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     494|   1558782|      Portugal|     Registado|   2331|Quarto twin com W...|                 Bar|2022-08-01 10:57:...|        19|                    1|       1|      1|       0|    0|         2470.0|  2022-08-01|  2022-08-20|     494|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     492|   1557748|      Portugal|     Registado|   2322|Quarto twin com W...|                 Bar|2022-07-30 22:05:...|        90|                    1|       1|      1|       0|    0|         2700.0|  2022-09-16|  2022-12-15|     492|              Lisboa|       0|                 0|              0|2023-06-07 09:00:00|         13|       Carnaxide|\n|     493|   1555045|      Portugal|     Registado|   2323|  Apartamento T1 R/C|Não Reembolsável ...|2022-07-27 09:43:...|        31|                    1|       1|      1|       0|    0|         1600.0|  2022-08-29|  2022-09-29|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     492|   1551966|      Portugal|     Registado|   2322|Quarto twin com W...|           7 noites |2022-07-25 15:18:...|        31|                    1|       1|      1|       0|    0|         1500.0|  2022-08-30|  2022-09-30|     492|              Lisboa|       0|                 0|              0|2023-06-07 09:00:00|         13|       Carnaxide|\n|     492|   1551961|      Portugal|     Cancelado|   2333|Quarto de casal c...|           7 noites |2022-07-25 15:14:...|        60|                    1|       2|      2|       0|    0|         1500.0|  2022-08-16|  2022-10-15|     492|              Lisboa|       0|                 0|              0|2023-06-07 09:00:00|         13|       Carnaxide|\n|     514|   1526304|         Suiça|     Registado|   2425|     Eco Garden Room|   Non-Refundable >5|2022-06-22 08:15:...|        15|                    1|       1|      1|       0|    0|         1620.0|  2022-09-23|  2022-10-08|     514|Charneca de Caparica|       3|                12|             24|2023-06-07 18:00:00|         13|       Carnaxide|\n|     310|   1525113|       Bélgica|  NãoRegistado|   1673|Quarto Duplo Supe...|      MR - Main Rate|2022-06-20 17:19:...|        20|                    2|       2|      4|       0|    0|         2760.0|  2022-07-24|  2022-08-13|     310|                Gaia|       3|                 0|              0|2023-06-07 23:59:00|        192|           Porto|\n|     482|   1518732|       Holanda|     Registado|   2285|      Apartamento T1|(WEB) Non-refunda...|2022-06-12 15:47:...|        17|                    1|       2|      2|       0|    0|         1236.9|  2022-09-17|  2022-10-04|     482|            Portimão|       4|                 3|             36|2023-06-07 23:59:00|        143|           Lagos|\n|     490|   1515904|      Portugal|     Registado|   2799| Apartamento estúdio| Promoção dia da Mãe|2022-06-08 16:16:...|        27|                    1|       1|      1|       0|    0|         2000.0|  2022-09-04|  2022-10-01|     490|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     493|   1509739|      Portugal|     Registado|   2338| Estudio com Terraço|Não Reembolsável ...|2022-05-31 17:10:...|        18|                    1|       1|      1|       0|    0|          810.0|  2022-06-15|  2022-07-03|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     493|   1506335|      Portugal|     Registado|   2323|  Apartamento T1 R/C|                 Bar|2022-05-27 16:00:...|        20|                    1|       1|      1|       0|    0|         1060.0|  2022-06-10|  2022-06-30|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     482|   1501349|        Canadá|     Registado|   2285|      Apartamento T1|(WEB) Non-refunda...|2022-05-21 06:55:...|        15|                    1|       2|      2|       0|    0|1254.5699999995|  2022-05-31|  2022-06-15|     482|            Portimão|       4|                 3|             36|2023-06-07 23:59:00|        143|           Lagos|\n|     482|   1500861|        Canadá|     Registado|   2285|      Apartamento T1|(WEB) Non-refunda...|2022-05-20 11:53:...|        16|                    2|       2|      4|       0|    0| 2623.999999999|  2022-05-30|  2022-06-15|     482|            Portimão|       4|                 3|             36|2023-06-07 23:59:00|        143|           Lagos|\n|     493|   1495419|      Portugal|     Registado|   2324|    Estudio com sala|Não Reembolsável ...|2022-05-13 14:03:...|        30|                    1|       2|      2|       0|    0|         1700.0|  2022-05-30|  2022-06-29|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     493|   1495413|      Portugal|     Registado|   2338| Estudio com Terraço|Não Reembolsável ...|2022-05-13 13:59:...|        19|                    1|       1|      1|       0|    0|          855.0|  2022-05-15|  2022-06-03|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     493|   1495031|      Portugal|     Registado|   2800|Estudio com 2 qua...|Não Reembolsável ...|2022-05-12 21:44:...|        16|                    1|       1|      1|       0|    0|          690.0|  2022-05-18|  2022-06-03|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     503|   1491342|Estados Unidos|    Modificada|   2368| Quarto Duplo / Twin|             BAR APA|2022-05-08 22:14:...|        35|                    1|       2|      2|       0|    0|         2690.0|  2022-05-24|  2022-06-28|     503|              Aveiro|       3|                10|             36|2023-06-07 23:00:00|        187|          Aveiro|\n|     482|   1489527|        Canadá|     Registado|   2285|      Apartamento T1|(WEB) Non-refunda...|2022-05-06 12:25:...|        15|                    1|       1|      1|       0|    0| 703.2399999995|  2022-05-10|  2022-05-25|     482|            Portimão|       4|                 3|             36|2023-06-07 23:59:00|        143|           Lagos|\n|     482|   1489523|        Canadá|     Registado|   2285|      Apartamento T1|(WEB) Non-refunda...|2022-05-06 12:22:...|        16|                    4|       1|      4|       0|    0|2996.7199999978|  2022-05-09|  2022-05-25|     482|            Portimão|       4|                 3|             36|2023-06-07 23:59:00|        143|           Lagos|\n|     327|   1477712|      Alemanha|     Registado|   1445|                  T1|               P.V.P|2022-04-20 08:41:...|        18|                    1|       2|      2|       0|    0|         1710.0|  2022-05-02|  2022-05-20|     327|     Câmara de Lobos|       4|                12|             24|2023-06-07 18:00:00|        123|         Funchal|\n|     327|   1477708|      Alemanha|  NãoRegistado|   1445|                  T1|               P.V.P|2022-04-20 08:36:...|        18|                    1|       2|      2|       0|    0|         1710.0|  2022-05-02|  2022-05-20|     327|     Câmara de Lobos|       4|                12|             24|2023-06-07 18:00:00|        123|         Funchal|\n|     493|   1477047|      Portugal|     Registado|   2324|    Estudio com sala|                 Bar|2022-04-19 11:30:...|        30|                    1|       1|      1|       0|    0|         1800.0|  2022-04-24|  2022-05-24|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     494|   1468891|      Portugal|     Registado|   2331|Quarto twin com W...|    Promoção7 noites|2022-04-07 10:05:...|        15|                    1|       1|      1|       0|    0|          892.5|  2022-04-11|  2022-04-26|     494|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     328|   1467919|      Portugal|    Modificada|   1450|6 Bed Mixed Dormi...|    B.A.R. (onlines)|2022-04-06 10:29:...|        15|                    1|       1|      1|       0|    0|          400.0|  2022-04-12|  2022-04-27|     328|              Lisboa|       0|                 0|              0|2023-06-07 22:00:00|         56|       Carnaxide|\n|     285|   1464382|      Portugal|     Registado|   1290|ONE-BEDROOM APART...|                  7N|2022-04-01 21:53:...|        31|                    1|       2|      2|       0|    0|            0.0|  2022-10-01|  2022-11-01|     285|               Porto|       1|                 3|             36|2023-06-07 20:00:00|          8|           Porto|\n|     285|   1464232|Estados Unidos|     Cancelado|   1289|     SUPERIOR STUDIO|                  7N|2022-04-01 18:23:...|        28|                    1|       2|      2|       0|    0|         1317.6|  2022-09-09|  2022-10-07|     285|               Porto|       1|                 3|             36|2023-06-07 20:00:00|          8|           Porto|\n|     493|   1462453|      Portugal|     Registado|   2324|    Estudio com sala|Não Reembolsável ...|2022-03-30 15:11:...|        17|                    1|       1|      1|       0|    0|          765.0|  2022-03-31|  2022-04-17|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     238|   1456796|   Bielorússia|     Registado|    938|Side Superior Bal...|      Estadia Normal|2022-03-22 16:56:...|        41|                    1|       1|      1|       0|    0|         4498.5|  2022-04-09|  2022-05-20|     238|             Funchal|       3|                 8|             23|2023-06-07 23:30:00|         52|         Funchal|\n|     399|   1456224|      Alemanha|    Modificada|   1863|1 Bedroom Private...| Best Available Rate|2022-03-21 20:06:...|        16|                    1|       2|      2|       0|    0|         1616.0|  2022-09-23|  2022-10-09|     399|              Tavira|       0|                 3|              0|2023-06-07 16:00:00|          9|       Albufeira|\n|     392|   1454271|       Bélgica|     Registado|   2122|APARTAMENTO FAMIL...|Epoca Alta ( Jul,...|2022-03-18 20:15:...|        19|                    1|       2|      2|       1|    0|        4082.91|  2022-07-22|  2022-08-10|     392|               Olhão|       4|                11|             24|2023-06-07 23:30:00|         19|       Albufeira|\n|     328|   1451872|        Brasil|     Registado|   1456|Superior Double Room|             WebSite|2022-03-14 18:01:...|        27|                    1|       1|      1|       0|    0|         1462.0|  2022-04-01|  2022-04-28|     328|              Lisboa|       0|                 0|              0|2023-06-07 22:00:00|         56|       Carnaxide|\n|     403|   1450818| Nova Zelândia|     Registado|   2740|Quarto Superior A...|Tarifa sem pequen...|2022-03-12 23:25:...|        18|                    1|       2|      2|       0|    0|          954.0|  2022-03-26|  2022-04-13|     403|           Ermesinde|       4|                 0|              0|2023-06-07 23:59:00|         26|           Porto|\n|     493|   1450260|      Portugal|     Registado|   2338| Estudio com Terraço|Não Reembolsável ...|2022-03-11 18:35:...|        31|                    1|       1|      1|       0|    0|         1300.0|  2022-03-17|  2022-04-17|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     328|   1448760|        Itália|     Registado|   1456|Superior Double Room|             WebSite|2022-03-08 21:57:...|        15|                    1|       2|      2|       0|    0|          782.0|  2022-03-20|  2022-04-04|     328|              Lisboa|       0|                 0|              0|2023-06-07 22:00:00|         56|       Carnaxide|\n|     399|   1448243|       Espanha|     Registado|   1863|1 Bedroom Private...| Best Available Rate|2022-03-08 07:06:...|        17|                    1|       3|      3|       0|    0|         2686.0|  2022-08-13|  2022-08-30|     399|              Tavira|       0|                 3|              0|2023-06-07 16:00:00|          9|       Albufeira|\n|     285|   1446027|      Portugal|     Registado|   1290|ONE-BEDROOM APART...|                  7N|2022-03-03 20:04:...|        18|                    1|       2|      2|       0|    0|            0.0|  2022-03-14|  2022-04-01|     285|               Porto|       1|                 3|             36|2023-06-07 20:00:00|          8|           Porto|\n|     493|   1445857|      Portugal|     Registado|   2323|  Apartamento T1 R/C|                 Bar|2022-03-03 15:33:...|        30|                    1|       1|      1|       0|    0|         1600.0|  2022-04-30|  2022-05-30|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     490|   1444083|      Portugal|     Registado|   2573|Quarto de casal c...|Promoção mais 7 n...|2022-02-28 17:09:...|        45|                    1|       1|      1|       0|    0|         1687.5|  2022-03-11|  2022-04-25|     490|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     490|   1442747|         Suiça|     Registado|   2317|      Apartamento T1|Promoção mais 7 n...|2022-02-25 21:07:...|        64|                    1|       1|      1|       0|    0|         3360.0|  2022-02-25|  2022-04-30|     490|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     493|   1442004|      Portugal|     Registado|   2324|    Estudio com sala|Não Reembolsável ...| 2022-02-24 15:00:43|        61|                    1|       2|      2|       0|    0|         3100.0|  2022-02-28|  2022-04-30|     493|           Carnaxide|       0|                 0|              0|2023-06-07 12:00:00|          5|       Carnaxide|\n|     490|   1437984|      Portugal|     Registado|   2798|Apartamento Estúd...| Promoção dia da Mãe|2022-02-17 15:22:...|        61|                    1|       1|      1|       0|    0|         2600.0|  2022-02-28|  2022-04-30|     490|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     560|   1435031|      Portugal|     Cancelado|   2868|         Estudio 2+2|                  7N|2022-02-13 08:25:...|        20|                    1|       2|      2|       0|    0|            0.0|  2022-03-11|  2022-03-31|     560|               Porto|       0|                 3|             36|2023-06-07 20:00:00|          8|           Porto|\n|     444|   1434245|        Suécia|     Registado|   2076|               Suite|              Normal|2022-02-11 12:02:...|        18|                    1|       2|      2|       0|    0|         1980.0|  2022-02-27|  2022-03-17|     444|              Nazaré|       4|                12|             24|2023-06-07 23:59:00|         77|         Batalha|\n|     328|   1433249| África do Sul|     Registado|   1451|4 Bed Mixed Dormi...|             WebSite|2022-02-09 13:05:...|        88|                    1|       1|      1|       0|    0|         1977.0|  2022-02-26|  2022-05-25|     328|              Lisboa|       0|                 0|              0|2023-06-07 22:00:00|         56|       Carnaxide|\n|     494|   1429966|      Portugal|     Registado|   2383|Quarto twin Com W...|                 Bar|2022-02-02 17:20:...|        31|                    1|       2|      2|       0|    0|         1650.0|  2022-03-07|  2022-04-07|     494|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     494|   1429963|      Portugal|     Registado|   2383|Quarto twin Com W...|                 Bar|2022-02-02 17:14:...|        28|                    1|       2|      2|       0|    0|         1650.0|  2022-02-07|  2022-03-07|     494|              Lisboa|       0|                 0|              0|2023-06-07 12:00:00|          6|       Carnaxide|\n|     414|   1428830|       Irlanda|     Registado|   2050|Duplo Vista Interior|        Normal - Bar|2022-01-31 12:24:...|        15|                    1|       1|      1|       0|    0|         1800.0|  2022-08-13|  2022-08-28|     414|São Martinho do P...|       3|                12|             36|2023-06-07 23:30:00|         30|        Alcobaça|\n|     285|   1423137|       Holanda|     Registado|   1290|ONE-BEDROOM APART...|                  7N|2022-01-16 20:02:...|        17|                    1|       5|      5|       0|    0|         1162.8|  2022-07-11|  2022-07-28|     285|               Porto|       1|                 3|             36|2023-06-07 20:00:00|          8|           Porto|\n|     283|   1418645|      Portugal|     Cancelado|   1242|                  T1|                  7N|2022-01-03 07:05:...|        42|                    1|       2|      2|       0|    0|            0.0|  2022-04-19|  2022-05-31|     283|               Porto|       0|                 3|             36|2023-06-07 20:00:00|          7|           Porto|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+----------+---------------------+--------+-------+--------+-----+---------------+------------+------------+--------+--------------------+--------+------------------+---------------+-------------------+-----------+----------------+\n\n\u001b[1m\u001b[34mresultQuartosReservados\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 23 more fields]\n\u001b[1m\u001b[34mmean\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 2.2818960366460863\n\u001b[1m\u001b[34mstdDev\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 4.682051578623312\n\u001b[1m\u001b[34mupperLimit\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m = 14\n\u001b[1m\u001b[34mlowerLimit\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.0\n\u001b[1m\u001b[34moutliers\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 23 more fields]\n\u001b[1m\u001b[34mresultCount\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 24 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "num_linhas",
          "tpe": {
           "presentableName": "long"
          },
          "nullable": false
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "//Hóteis a remover que não tem qualquer reserva\n\nval resultQuartosReservados2 = spark.sql(\n    \"\"\"\n    SELECT * \n    FROM InitialHotel h\n    WHERE NOT EXISTS (SELECT 1 FROM InitialQuartosReservados qr\n    WHERE h.hotel_ID = qr.hotel_ID)\n    \"\"\"\n)\nval resultCount = resultQuartosReservados2.withColumn(\"num_linhas\", count(\"*\").over())\n// exibe o valor da coluna \"num_linhas\"\nresultCount.agg(max(\"num_linhas\")).show()\n resultQuartosReservados2.show(60)",
   "id": "",
   "dateCreated": "2023-05-07 17:38:06.368",
   "config": {},
   "dateStarted": "2023-06-07 22:43:29.313",
   "dateUpdated": "2023-06-07 22:43:30.515",
   "dateFinished": "2023-06-07 22:43:30.515",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+---------------+\n|max(num_linhas)|\n+---------------+\n|             57|\n+---------------+\n\n+--------+--------------------+--------+------------------+---------------+-------------------+-----------+--------------------+\n|hotel_ID|         localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|    area_localizacao|\n+--------+--------------------+--------+------------------+---------------+-------------------+-----------+--------------------+\n|     167|              Lisboa|       4|                12|             36|2023-06-07 23:59:00|         62|           Carnaxide|\n|     206|               Porto|       3|                 0|              0|2023-06-07 18:00:00|          7|               Porto|\n|     226|              Lisboa|       0|                 2|             24|2023-06-07 17:00:00|          2|           Carnaxide|\n|     237|              Lisboa|       3|                11|             24|2023-06-07 23:59:00|         91|           Carnaxide|\n|     242|              Lisboa|       0|                 5|             24|2023-06-07 20:00:00|          8|           Carnaxide|\n|     276|               Braga|       4|                12|             24|2023-06-07 23:59:00|         17|              Amares|\n|     277|               Braga|       3|                 0|              0|2023-06-07 18:00:00|         20|              Amares|\n|     278|               Braga|       4|                 0|              0|2023-06-07 18:00:00|         29|              Amares|\n|     279|               Braga|       0|                 0|              0|2023-06-07 18:00:00|         18|              Amares|\n|     281|               Braga|       4|                12|              3|2023-06-07 23:59:00|         16|              Amares|\n|     297|               Porto|       0|                12|             24|2023-06-07 20:00:00|          8|               Porto|\n|     306|                   .|       1|                 0|              0|2023-06-07 18:00:00|          7|                   .|\n|     307|                   .|       1|                 0|              0|2023-06-07 18:00:00|         19|                   .|\n|     316|             Espinho|       2|                 0|              0|2023-06-07 20:00:00|         17|             Espinho|\n|     317|             Espinho|       3|                 5|             24|2023-06-07 23:59:00|         13|             Espinho|\n|     318|             Espinho|       2|                 0|              0|2023-06-07 18:00:00|         10|             Espinho|\n|     339|            Vila Meã|       4|                12|             60|2023-06-07 23:59:00|         30|               Porto|\n|     350|           Albufeira|       3|                11|             24|2023-06-07 23:59:00|         68|           Albufeira|\n|     361|              Lisboa|       1|                12|             36|2023-06-07 18:00:00|          2|           Carnaxide|\n|     365|   Sabugueiro / Seia|       4|                12|             36|2023-06-07 23:59:00|         21|      Castelo Branco|\n|     369|               Porto|       3|                12|             12|2023-06-07 18:00:00|         17|               Porto|\n|     370|              Lisboa|       0|                 2|             24|2023-06-07 00:01:00|         19|           Carnaxide|\n|     380|             Cascais|       1|                16|              0|2023-06-07 18:00:00|         46|          Carcavelos|\n|     384|             Lousada|       4|                 0|              0|2023-06-07 18:00:00|         27|               Porto|\n|     386|              Sintra|       5|                12|             36|2023-06-07 23:59:00|         15|              Sintra|\n|     405|               Porto|       1|                 0|              0|2023-06-07 18:00:00|          4|               Porto|\n|     406|               Olhão|       3|                 0|              0|2023-06-07 18:00:00|         40|           Albufeira|\n|     408|           Albufeira|       1|                 0|              0|2023-06-07 18:00:00|          7|           Albufeira|\n|     409| Albufeira - Algarve|       0|                 0|              0|2023-06-07 18:00:00|         43|           Albufeira|\n|     423|               Porto|       0|                12|             24|2023-06-07 18:00:00|         13|               Porto|\n|     425|    Praia da Vitória|       3|                 0|              0|2023-06-07 18:00:00|         52|    Praia da Vitória|\n|     427|Valença, Viana do...|       0|                12|              0|2023-06-07 18:00:00|         17|Valença, Viana do...|\n|     428|               Porto|       0|                12|              1|2023-06-07 14:00:00|          8|               Porto|\n|     439|              Lisboa|       1|                 0|              0|2023-06-07 18:00:00|         41|           Carnaxide|\n|     452|            Alcobaça|       3|                 0|              0|2023-06-07 18:00:00|         90|            Alcobaça|\n|     477|Vila Praia de Âncora|       4|                10|              0|2023-06-07 18:00:00|         56|    Viana do Castelo|\n|     479|          Carcavelos|       0|                 0|              0|2023-06-07 18:00:00|         38|          Carcavelos|\n|     485|               Porto|       0|                 6|             24|2023-06-07 18:00:00|          2|               Porto|\n|     499|              Fuseta|       0|                 0|              0|2023-06-07 18:00:00|         21|           Albufeira|\n|     509|               teste|       0|                 0|              0|2023-06-07 18:00:00|          2|               teste|\n|     512|São Brás de Alportel|       0|                18|             24|2023-06-07 00:01:00|          5|           Albufeira|\n|     520|     Alto dos Lombos|       0|                 0|              0|2023-06-07 18:00:00|         10|            Bragança|\n|     524|       Ponta Delgada|       3|                 0|            168|2023-06-07 16:00:00|          2|              Açores|\n|     525|    Viana do Castelo|       4|                10|             24|2023-06-07 18:00:00|         58|    Viana do Castelo|\n|     527|           Albufeira|       0|                 0|              0|2023-06-07 18:00:00|         60|           Albufeira|\n|     528|           Albufeira|       0|                 0|              0|2023-06-07 18:00:00|         29|           Albufeira|\n|     530|União de Freguesi...|       3|                 0|              0|2023-06-07 18:00:00|          3|               Porto|\n|     532|              Almada|       0|                 0|              0|2023-06-07 21:00:00|         38|           Carnaxide|\n|     543|              Lisboa|       0|                 2|             24|2023-06-07 00:01:00|         12|           Carnaxide|\n|     544|              Lisboa|       0|                 2|             24|2023-06-07 00:01:00|          1|           Carnaxide|\n|     545|              Lisboa|       0|                 2|             24|2023-06-07 00:01:00|          2|           Carnaxide|\n|     551|   Vila Nova de gaia|       0|                 3|             36|2023-06-07 18:00:00|          1|   Vila Nova de gaia|\n|     552|              Lisboa|       0|                18|             24|2023-06-07 00:01:00|          1|           Carnaxide|\n|     553|              Lisboa|       0|                 0|              0|2023-06-07 18:00:00|         38|           Carnaxide|\n|     554|              Lisboa|       0|                 0|              0|2023-06-07 18:00:00|         30|           Carnaxide|\n|     555|       Ponta Delgada|       0|                 0|              0|2023-06-07 18:00:00|          5|              Açores|\n|     557|               Olhão|       3|                 0|              0|2023-06-07 18:00:00|         67|           Albufeira|\n+--------+--------------------+--------+------------------+---------------+-------------------+-----------+--------------------+\n\n\u001b[1m\u001b[34mresultQuartosReservados2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, localizacao: string ... 6 more fields]\n\u001b[1m\u001b[34mresultCount\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, localizacao: string ... 7 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {}
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "//Agrupamento e ordenação de Hoteis com mais reservas e com menos reservas\nval hotelReservationsCount = resultQuartosReservados\n        .groupBy(\"qr.hotel_ID\").count()\n        .orderBy($\"count\".desc)\n\nval lowerLimit = 13\nval outliers = hotelReservationsCount.filter($\"count\" < lowerLimit)\n\nprintln(outliers.count())\noutliers.show(100)\n\nhotelReservationsCount.show(10000)",
   "id": "",
   "dateCreated": "2023-05-03 21:24:30.093",
   "config": {},
   "dateStarted": "2023-06-07 22:43:46.841",
   "dateUpdated": "2023-06-07 22:43:50.607",
   "dateFinished": "2023-06-07 22:43:50.607",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "5\n+--------+-----+\n|hotel_ID|count|\n+--------+-----+\n|     491|    5|\n|     390|    5|\n|     302|    5|\n|     442|    4|\n|     513|    1|\n+--------+-----+\n\n+--------+-----+\n|hotel_ID|count|\n+--------+-----+\n|     311| 3325|\n|     310| 2120|\n|     556| 1885|\n|     444| 1687|\n|     535| 1344|\n|     309| 1140|\n|     482| 1001|\n|     539|  880|\n|     426|  859|\n|     179|  782|\n|     319|  593|\n|     514|  458|\n|     304|  402|\n|     328|  363|\n|     322|  310|\n|     504|  293|\n|     443|  279|\n|     465|  268|\n|     378|  263|\n|     392|  259|\n|     537|  248|\n|     313|  235|\n|     511|  227|\n|     280|  222|\n|     238|  213|\n|     453|  206|\n|     395|  205|\n|     314|  204|\n|     379|  204|\n|      49|  196|\n|     478|  193|\n|     321|  190|\n|     259|  185|\n|     415|  169|\n|     358|  167|\n|     560|  165|\n|     413|  162|\n|     503|  162|\n|      44|  151|\n|     492|  145|\n|     493|  144|\n|     421|  144|\n|     185|  134|\n|     414|  134|\n|     501|  126|\n|     445|  126|\n|     495|  120|\n|      54|  117|\n|     391|  108|\n|     403|   94|\n|     349|   88|\n|     416|   85|\n|     494|   79|\n|      20|   77|\n|     283|   74|\n|     366|   74|\n|     273|   71|\n|     516|   67|\n|     285|   62|\n|     522|   62|\n|     335|   55|\n|     332|   52|\n|     269|   51|\n|     483|   50|\n|     399|   49|\n|     287|   47|\n|     404|   42|\n|     284|   37|\n|     526|   36|\n|     433|   32|\n|     490|   31|\n|     400|   30|\n|     368|   30|\n|     559|   28|\n|     225|   24|\n|     320|   23|\n|     241|   23|\n|     356|   20|\n|     327|   18|\n|     561|   18|\n|     558|   15|\n|     546|   15|\n|     389|   13|\n|     491|    5|\n|     390|    5|\n|     302|    5|\n|     442|    4|\n|     513|    1|\n+--------+-----+\n\n\u001b[1m\u001b[34mhotelReservationsCount\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [hotel_ID: int, count: bigint]\n\u001b[1m\u001b[34mlowerLimit\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m = 13\n\u001b[1m\u001b[34moutliers\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [hotel_ID: int, count: bigint]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_por_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_medio_por_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_medio_por_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "//Preço Médio por noite por cada id Hotel\nval dfRatePlan = resultQuartosReservados.select(\"qr.hotel_ID\",\"h.localizacao\",\"qr.preco_euros\",\"qr.num_noites\")\n// converte a coluna \"preco_euros\" para o tipo de dados numérico\nval dfComPrecoNumerico = dfRatePlan.withColumn(\"preco_euros\", col(\"preco_euros\").cast(\"double\"))\n\n// adiciona uma coluna \"preco_por_noite\" com o valor da coluna \"preco_euros\" dividido pelo número de noites da reserva\nval dfComPrecoPorNoite = dfComPrecoNumerico.withColumn(\"preco_por_noite\", col(\"preco_euros\") / col(\"num_noites\"))\n\n// agrupa o dataframe pelo ID do hotel e calcula a média da coluna \"preco_por_noite\" para cada grupo\nval mediaPrecoPorHotel = dfComPrecoPorNoite.groupBy(\"hotel_ID\").agg(avg(\"preco_por_noite\").alias(\"preco_medio_por_noite\"))\nval mediaPrecoPorHotelArredondado = mediaPrecoPorHotel.withColumn(\"preco_medio_por_noite\", round(col(\"preco_medio_por_noite\"), 2))\nval mediaPrecoPorHotelArredondado_orderDESC = mediaPrecoPorHotelArredondado.orderBy($\"preco_medio_por_noite\".desc)\n\nmediaPrecoPorHotelArredondado_orderDESC.show(10000)",
   "id": "",
   "dateCreated": "2023-05-03 23:17:54.828",
   "config": {},
   "dateStarted": "2023-06-07 22:43:57.961",
   "dateUpdated": "2023-06-07 22:44:00.667",
   "dateFinished": "2023-06-07 22:44:00.667",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+--------+---------------------+\n|hotel_ID|preco_medio_por_noite|\n+--------+---------------------+\n|     358|               263.39|\n|     445|               252.59|\n|     513|                250.0|\n|     443|               237.41|\n|     225|               235.01|\n|     313|               233.17|\n|     379|               216.27|\n|      49|               214.91|\n|     241|                203.0|\n|     390|               182.19|\n|     185|               176.65|\n|     273|               172.65|\n|     389|               169.11|\n|     491|                166.0|\n|     558|               163.94|\n|     483|               160.55|\n|     259|               156.63|\n|     356|               153.16|\n|     179|                151.5|\n|     495|               147.01|\n|     368|               145.27|\n|     559|               139.41|\n|      44|               137.97|\n|     537|               137.91|\n|     280|               136.11|\n|     514|               133.45|\n|     413|               129.76|\n|      54|               128.09|\n|     482|               126.53|\n|     238|               125.55|\n|     444|                124.6|\n|     465|               119.62|\n|     392|                115.7|\n|     501|               114.76|\n|     332|               112.71|\n|     414|               112.55|\n|     378|               110.78|\n|     399|               110.29|\n|     327|               108.33|\n|     453|               106.63|\n|     421|               104.67|\n|     416|               104.22|\n|     504|               103.86|\n|     426|               102.71|\n|     269|               101.36|\n|     404|                99.82|\n|     391|                 98.6|\n|     302|                98.45|\n|     415|                97.97|\n|     395|                96.81|\n|     511|                90.96|\n|     442|                89.75|\n|     311|                89.61|\n|     400|                89.37|\n|     287|                87.86|\n|     322|                86.18|\n|     366|                86.13|\n|     321|                84.62|\n|     546|                 83.4|\n|     535|                82.97|\n|     478|                82.63|\n|     490|                82.62|\n|     556|                80.87|\n|     526|                80.74|\n|     539|                 78.6|\n|     494|                78.44|\n|     349|                78.09|\n|     492|                76.31|\n|     314|                75.85|\n|     304|                75.49|\n|     319|                 74.3|\n|     335|                73.47|\n|     561|                69.72|\n|     503|                67.94|\n|     493|                67.61|\n|     403|                67.36|\n|     320|                66.61|\n|     310|                66.61|\n|     285|                65.37|\n|     516|                64.96|\n|     433|                60.54|\n|     309|                59.61|\n|      20|                59.43|\n|     283|                58.35|\n|     560|                57.54|\n|     522|                56.74|\n|     328|                52.85|\n|     284|                51.18|\n+--------+---------------------+\n\n\u001b[1m\u001b[34mdfRatePlan\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, localizacao: string ... 2 more fields]\n\u001b[1m\u001b[34mdfComPrecoNumerico\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, localizacao: string ... 2 more fields]\n\u001b[1m\u001b[34mdfComPrecoPorNoite\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, localizacao: string ... 3 more fields]\n\u001b[1m\u001b[34mmediaPrecoPorHotel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, preco_medio_por_noite: double]\n\u001b[1m\u001b[34mmediaPrecoPorHotelArredondado\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, preco_medio_por_noite: double]\n\u001b[1m\u001b[34mmediaPrecoPorHotelArredondado_orderDESC\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [hotel_ID: int, ..."
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "count",
          "tpe": {
           "presentableName": "long"
          },
          "nullable": false
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "//Agrupar por Pais;\nval dfRatePlan = resultQuartosReservados.select(\"qr.pais\")\nval agrPais = dfRatePlan.groupBy(\"qr.pais\").count()\nval order_agr_Pais = agrPais.orderBy($\"count\".desc)\n\nval lowerLimit = 3\nval outliers = order_agr_Pais.filter($\"count\" < lowerLimit)\nval numlinhas = outliers.count()\n// saveDataFrame(order_agr_Pais,\"agr_Pais\")\nprintln(numlinhas)\noutliers.show(100)\norder_agr_Pais.show(10000)\n",
   "id": "",
   "dateCreated": "2023-05-05 17:22:06.727",
   "config": {},
   "dateStarted": "2023-06-07 22:44:11.046",
   "dateUpdated": "2023-06-07 22:44:16.760",
   "dateFinished": "2023-06-07 22:44:16.760",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "43\n+--------------------+-----+\n|                pais|count|\n+--------------------+-----+\n|         Bielorússia|    2|\n|             Uruguai|    2|\n|              Mónaco|    2|\n|              Jersey|    2|\n|              Egipto|    2|\n|     Ilha da Reunião|    2|\n|             Tunísia|    2|\n|            Islândia|    2|\n|             Jamaica|    2|\n|             Andorra|    2|\n|           Tailândia|    2|\n|                Peru|    2|\n|            Paraguai|    2|\n|             APO/FPO|    2|\n|Ilhas Virgens (E....|    2|\n|            Jordânia|    1|\n|             Senegal|    1|\n|               Kenia|    1|\n|            Camarões|    1|\n|           Sri Lanka|    1|\n|        Ilhas Caimão|    1|\n|            Moldávia|    1|\n|   Antígua e Barbuda|    1|\n|                Irão|    1|\n|              Ruanda|    1|\n|             Malásia|    1|\n|            Bulgária|    1|\n|         Suazilândia|    1|\n|               Níger|    1|\n|          Guadeloupe|    1|\n|São Cristóvão e N...|    1|\n|           Macedónia|    1|\n|            Botswana|    1|\n|          Bangladesh|    1|\n|             Albánia|    1|\n|República da Quir...|    1|\n|           Martinica|    1|\n| Antilhas Holandesas|    1|\n|          Montenegro|    1|\n|                Gana|    1|\n|                Niue|    1|\n|          Costa Rica|    1|\n|     Samoa Americana|    1|\n+--------------------+-----+\n\n+--------------------+-----+\n|                pais|count|\n+--------------------+-----+\n|            Portugal|13049|\n|             Espanha| 2410|\n|      Estados Unidos| 2089|\n|              França| 1719|\n|         Reino Unido|  948|\n|            Alemanha|  840|\n|               Suiça|  485|\n|              Canadá|  431|\n|             Holanda|  427|\n|              Brasil|  412|\n|              Itália|  410|\n|             Bélgica|  326|\n|             Irlanda|  235|\n|          Luxemburgo|  131|\n|           Austrália|   97|\n|             Áustria|   91|\n|           Dinamarca|   90|\n|              Suécia|   77|\n|             Polónia|   67|\n|              Israel|   63|\n|             Noruega|   57|\n|            Filandia|   53|\n|           Argentina|   39|\n|     Républica Checa|   38|\n|              México|   36|\n|             Hungria|   24|\n|             Ucránia|   21|\n|             Roménia|   21|\n|              Angola|   21|\n|               Japão|   21|\n|           Singapura|   20|\n|          Eslováquia|   20|\n|       Nova Zelândia|   15|\n|               Malta|   15|\n|       África do Sul|   15|\n|              Grécia|   14|\n|               India|   12|\n|           Hong Kong|   11|\n|             Estónia|   10|\n|               Chile|   10|\n|             Turquia|   10|\n|            Colômbia|   10|\n|            Lituánia|    9|\n|               Outro|    9|\n|             Equador|    8|\n|              Rússia|    8|\n|              Taiwan|    8|\n|           Filipinas|    8|\n|               China|    8|\n|          Moçambique|    8|\n|             Letónia|    8|\n|             Croácia|    7|\n|             Nigéria|    7|\n|           Eslovénia|    7|\n|          Cabo Verde|    7|\n|           Venezuela|    7|\n|Emirados Árabes U...|    6|\n|              Chipre|    5|\n|            Marrocos|    5|\n|       Coreia do Sul|    4|\n|              Quatar|    4|\n|             Argélia|    4|\n|      Arábia Saudita|    4|\n|          Porto Rico|    4|\n|              Sérvia|    3|\n|             Arménia|    3|\n|             Bermuda|    3|\n|              Panamá|    3|\n|            Islândia|    2|\n|             Andorra|    2|\n|           Tailândia|    2|\n|              Jersey|    2|\n|                Peru|    2|\n|              Egipto|    2|\n|         Bielorússia|    2|\n|             Tunísia|    2|\n|     Ilha da Reunião|    2|\n|             Jamaica|    2|\n|             APO/FPO|    2|\n|            Paraguai|    2|\n|             Uruguai|    2|\n|              Mónaco|    2|\n|Ilhas Virgens (E....|    2|\n|            Jordânia|    1|\n|               Kenia|    1|\n|              Ruanda|    1|\n|           Sri Lanka|    1|\n|             Senegal|    1|\n|          Bangladesh|    1|\n|           Martinica|    1|\n|            Bulgária|    1|\n|        Ilhas Caimão|    1|\n|            Camarões|    1|\n|             Malásia|    1|\n|República da Quir...|    1|\n|          Costa Rica|    1|\n|               Níger|    1|\n|             Albánia|    1|\n| Antilhas Holandesas|    1|\n|   Antígua e Barbuda|    1|\n|São Cristóvão e N...|    1|\n|            Moldávia|    1|\n|          Guadeloupe|    1|\n|     Samoa Americana|    1|\n|          Montenegro|    1|\n|                Gana|    1|\n|           Macedónia|    1|\n|            Botswana|    1|\n|                Niue|    1|\n|         Suazilândia|    1|\n|                Irão|    1|\n+--------------------+-----+\n\n\u001b[1m\u001b[34mdfRatePlan\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [pais: string]\n\u001b[1m\u001b[34magrPais\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [pais: string, count: bigint]\n\u001b[1m\u001b[34morder_agr_Pais\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [pais: string, count: bigint]\n\u001b[1m\u001b[34mlowerLimit\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m = 3\n\u001b[1m\u001b[34moutliers\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [pais: string, count: bigint]\n\u001b[1m\u001b[34mnumlinhas\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 43\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "rate_plan_normalized",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Quantidade de quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "rate_plan_normalized",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Quantidade de quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "rate_plan_normalized",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Quantidade de quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "rate_plan_normalized",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Quantidade de quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "rate_plan_normalized",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Quantidade de quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "rate_plan_normalized",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Quantidade de quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "//Após a limpeza, aplicação algumas etapas de limpeza e padronização do rate_Plan\n\nval result_after_cleaning = spark.sql(\n    \"\"\"\n    SELECT * \n    FROM QuartosReservados \n    \"\"\"\n)\n// Remover espaços em branco extras\nval dfTrimmed = result_after_cleaning.withColumn(\"rate_plan\", trim(col(\"rate_plan\")))\n\n// Converter para letras minúsculas\nval dfLower = dfTrimmed.withColumn(\"rate_plan\", lower(col(\"rate_plan\")))\n\n// Remover caracteres especiais e pontuações\nval dfCleaned = dfLower.withColumn(\"rate_plan\", regexp_replace(col(\"rate_plan\"), \"[^a-zA-Z0-9 ]\", \"\"))\n\n// Criar uma nova coluna \"rate_plan_normalized\" com os valores normalizados\nval dfNormalized = dfCleaned.withColumn(\"rate_plan_normalized\", regexp_replace(col(\"rate_plan\"), \" +\", \" \"))\n\n// Substituir os valores correspondentes e manter os demais valores como estão\nval dfCategorized = dfNormalized.withColumn(\"rate_plan_normalized\", \n    when(lower(col(\"rate_plan\")).rlike(\"no refund|nao reembol|nonrefundable|no_refundable|nrf|noreembolsvel|no reembolsvel|non refundable|no reembolsable 13|non refund|no refundable bb|nr\"), \"non-refundable\").when(lower(col(\"rate_plan\")).rlike(\"promo|oferta|desconto\"), \"promo\")\n            .when(lower(col(\"rate_plan\")).rlike(\"normal|standard|base\"), \"normal\")\n            .when(lower(col(\"rate_plan\")).rlike(\"web|website|online\"), \"website\")\n            .when(lower(col(\"rate_plan\")).rlike(\"bar\"), \"bar\")\n            .when(lower(col(\"rate_plan\")).rlike(\"standart\"), \"standart\")\n            .when(lower(col(\"rate_plan\")).rlike(\"tw\"), \"twin\")\n            .when(lower(col(\"rate_plan\")).rlike(\"direct|reserva_direta|venda_direta\"), \"direct\")\n            .otherwise(col(\"rate_plan_normalized\"))\n)\n\n// Agrupar os dados pelo rate_plan_normalized e contar a ocorrência\nval groupedData = dfCategorized.groupBy(\"rate_plan_normalized\").count()\n\n// Substituir valores com count inferior a 20 por \"other\"\nval dfUpdated = dfCategorized.join(groupedData, Seq(\"rate_plan_normalized\"))\n  .withColumn(\"rate_plan_normalized\", when(col(\"count\") < 20, \"other\").otherwise(col(\"rate_plan_normalized\")))\n  .drop(\"count\")\n\ndfUpdated.cache()\ndfUpdated.createOrReplaceTempView(QuartosReservadosTable)\n\n\n// Ordenar por contagem em ordem decrescente\nval sortedData = dfUpdated.groupBy(\"rate_plan_normalized\").count().orderBy(desc(\"count\"))\n\nprintln(sortedData.count()) // Total de categorias\n// Exibir o resultado\nsortedData.show(1000)\n\n  ",
   "id": "",
   "dateCreated": "2023-05-16 17:02:52.834",
   "config": {},
   "dateStarted": "2023-06-07 22:44:24.289",
   "dateUpdated": "2023-06-07 22:44:36.615",
   "dateFinished": "2023-06-07 22:44:36.615",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "44\n+--------------------+-----+\n|rate_plan_normalized|count|\n+--------------------+-----+\n|      non-refundable| 4938|\n|              normal| 4333|\n|                 bar| 4195|\n|             website| 4081|\n|        mr main rate| 2536|\n|        main rate bb| 1056|\n|               promo|  573|\n|         tarifa site|  380|\n|               other|  331|\n|            standart|  186|\n|        db room only|  167|\n|melhor preo garan...|  167|\n|                  4n|  165|\n|            duplo bb|  148|\n|      reserva direta|  140|\n|           room only|  132|\n|reembolsvel suple...|  116|\n|                twin|  109|\n|              direct|  105|\n|          meia penso|  105|\n|  reserva antecipada|   99|\n|chocolate experience|   93|\n|epoca alta jul ag...|   66|\n|clientes fidelizados|   65|\n|                  7n|   65|\n|    semi flexivel bb|   59|\n|tarifa sem pequen...|   54|\n|      reembolsvel ap|   49|\n| best available rate|   46|\n|       semi flexivel|   39|\n|               db ro|   32|\n|   premium room only|   32|\n|tarifa com pequen...|   30|\n|       dbs room only|   28|\n|       dbt room only|   28|\n|clg flexible sin ...|   28|\n|                  hb|   27|\n|          premium bb|   24|\n|        main rate hb|   24|\n|              dbs bb|   23|\n|               db bb|   21|\n|            avionics|   20|\n|         superior bb|   20|\n|           rack rate|   20|\n+--------------------+-----+\n\n\u001b[1m\u001b[34mresult_after_cleaning\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [rate_plan_normalized: string, tipo_quarto: string ... 20 more fields]\n\u001b[1m\u001b[34mdfTrimmed\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [rate_plan_normalized: string, tipo_quarto: string ... 20 more fields]\n\u001b[1m\u001b[34mdfLower\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [rate_plan_normalized: string, tipo_quarto: string ... 20 more fields]\n\u001b[1m\u001b[34mdfCleaned\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [rate_plan_normalized: string, tipo_quarto: string ... 20 more fields]\n\u001b[1m\u001b[34mdfNormalized\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [rate_plan_normalized: string, tipo_quarto: string ... 20 more fields]\n\u001b[1m\u001b[34mdfCategorized\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [rate..."
     }
    ]
   }
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "val result_after_cleaning = spark.sql(\n    \"\"\"\n    SELECT * \n    FROM QuartosReservados \n    \"\"\"\n)\n\nresult_after_cleaning.show(10000)",
   "id": "",
   "dateCreated": "2023-05-16 21:51:15.069",
   "config": {},
   "dateStarted": "2023-06-07 22:44:44.114",
   "dateUpdated": "2023-06-07 22:44:48.147",
   "dateFinished": "2023-06-07 22:44:48.146",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+--------------------+--------------------+--------+----------+--------------------+--------------+-------+--------------------+--------------------+----------+---------------------+--------+-------+--------+-----+---------------+------------+------------+------------------+------------------+--------------------+-----------------------------+\n|rate_plan_normalized|         tipo_quarto|hotel_ID|Reserve_ID|                pais|estado_reserva|room_ID|           rate_plan|        data_reserva|num_noites|Quantidade de quartos|ocupacao|adultos|criancas|bebes|    preco_euros|data_chegada|data_partida|       preco_noite|preco_noite_adulto|preco_noite_ocupacao|dif_data_chegada_data_reserva|\n+--------------------+--------------------+--------+----------+--------------------+--------------+-------+--------------------+--------------------+----------+---------------------+--------+-------+--------+-----+---------------+------------+------------+------------------+------------------+--------------------+-----------------------------+\n|        main rate bb|            superior|     310|   1722047|            Portugal|     Registado|   2870|        main rate bb|2023-04-16 21:55:...|         1|                    1|       2|      2|       0|    0|       100.4435|  2023-04-30|  2023-05-01|          100.4435|          50.22175|            50.22175|                           14|\n|       semi flexivel|            superior|     311|   1720340|          Luxemburgo|     Registado|   2034|       semi flexivel|2023-04-14 14:31:...|         1|                    1|       2|      2|       0|    0|          90.45|  2023-06-01|  2023-06-02|             90.45|            45.225|              45.225|                           48|\n|                 bar|         vista pinho|      44|   1718932|      Estados Unidos|     Cancelado|     85|                 bar|2023-04-12 17:31:...|         1|                    1|       2|      2|       0|    0|          125.0|  2023-06-15|  2023-06-16|             125.0|              62.5|                62.5|                           64|\n|             website|               duplo|     335|   1717009|            Portugal|     Cancelado|   1488|baronline  min 2 ...|2023-04-10 14:38:...|         2|                    1|       2|      2|       0|    0|          130.0|  2023-04-10|  2023-04-12|              65.0|              32.5|                32.5|                            0|\n|             website|      duplo standard|     556|   1716447|            Portugal|     Registado|   2831|web best availabl...|2023-04-09 18:38:...|         1|                    4|       2|      8|       0|    0|          272.0|  2023-06-03|  2023-06-04|             272.0|              34.0|               136.0|                           55|\n|        main rate bb|            superior|     310|   1716190|            Portugal|      Pendente|   1673|        main rate bb|2023-04-09 11:20:...|         1|                    1|       1|      1|       0|    0|       59.43675|  2023-04-15|  2023-04-16|          59.43675|          59.43675|            59.43675|                            6|\n|             website|                  t1|     482|   1713319|             Irlanda|     Registado|   2285|web best availabl...|2023-04-04 21:08:...|         7|                    1|       3|      3|       0|    0|        1220.75|  2023-07-18|  2023-07-25|174.39285714285714| 58.13095238095238|   58.13095238095238|                          105|\n|               other|          eco garden|     514|   1713213|           Argentina|     Cancelado|   2425|         bearpride23|2023-04-04 19:10:...|         5|                    1|       1|      1|       0|    0|          725.0|  2023-05-30|  2023-06-04|             145.0|             145.0|               145.0|                           56|\n|             website|     triplo standard|     556|   1710971|             Espanha|     Registado|   2833|web best availabl...|2023-04-02 11:30:...|         2|                    1|       3|      3|       0|    0|          166.6|  2023-04-05|  2023-04-07|              83.3|27.766666666666666|  27.766666666666666|                            3|\n|               other|               suite|     426|   1704701|            Portugal|     Registado|   1992|      penso completa|2023-03-24 17:02:...|         5|                    1|       2|      2|       1|    0|         1243.0|  2023-04-02|  2023-04-07|             248.6|             124.3|               124.3|                            9|\n|              normal|              studio|     395|   1704561|            Alemanha|     Cancelado|   1829|            standard|2023-03-24 13:05:...|         2|                    1|       2|      2|       0|    0|          190.0|  2023-03-25|  2023-03-27|              95.0|              47.5|                47.5|                            1|\n|              direct|       duplo ou twin|     511|   1704056|             Espanha|     Registado|   2394|smart deal  direc...|2023-03-23 18:47:...|         4|                    1|       1|      1|       0|    0|          279.0|  2023-03-29|  2023-04-02|             69.75|             69.75|               69.75|                            6|\n|      non-refundable|       twin standard|     366|   1694509|            Portugal|    Modificada|   1648|      non refundable|2023-03-10 12:07:...|         1|                    1|       2|      2|       0|    0|           75.6|  2023-03-11|  2023-03-12|              75.6|              37.8|                37.8|                            1|\n|             website|            superior|     328|   1692675|             Noruega|     Registado|   1456|             website|2023-03-07 16:48:...|         2|                    1|       2|      2|       0|    0|         153.19|  2023-04-06|  2023-04-08|            76.595|           38.2975|             38.2975|                           30|\n|        mr main rate|      duplo standard|     310|   1691045|               Suiça|     Registado|   1395|       mr  main rate|2023-03-05 16:45:...|         3|                    1|       2|      2|       0|    0|        138.225|  2023-03-06|  2023-03-09|46.074999999999996|23.037499999999998|  23.037499999999998|                            1|\n|      non-refundable|        twin confort|     179|   1690589|              Canadá|     Registado|    631|  no reembolsable 13|2023-03-04 20:29:...|         3|                    1|       2|      2|       0|    0|        502.686|  2023-05-27|  2023-05-30|167.56199999999998| 83.78099999999999|   83.78099999999999|                           84|\n|            standart|     duplo economico|     511|   1689186|            Portugal|     Registado|   2867|standart rate  qu...|2023-03-02 18:07:...|         3|                    1|       2|      2|       0|    0|          495.0|  2023-08-18|  2023-08-21|             165.0|              82.5|                82.5|                          169|\n|        main rate bb|      duplo standard|     309|   1687493|            Portugal|    Modificada|   1372|        main rate bb|2023-02-28 12:41:...|         2|                    1|       2|      2|       0|    0|        127.167|  2023-04-21|  2023-04-23|           63.5835|          31.79175|            31.79175|                           52|\n|        mr main rate|      duplo standard|     309|   1687154|             Espanha|    Modificada|   1372|       mr  main rate|2023-02-27 22:27:...|         1|                    1|       2|      2|       0|    0|       34.55625|  2023-03-02|  2023-03-03|          34.55625|         17.278125|           17.278125|                            3|\n|      non-refundable|       twin standard|     366|   1686287|            Portugal|     Registado|   1648|      non refundable|2023-02-26 21:25:...|         1|                    1|       2|      2|       1|    0|           75.6|  2023-03-04|  2023-03-05|              75.6|              37.8|                37.8|                            6|\n|        main rate bb|duplot duplo com ...|     311|   1684483|             Bélgica|  NãoRegistado|   1946|        main rate bb|2023-02-24 10:15:...|         1|                    1|       3|      3|       0|    0|        129.675|  2023-08-13|  2023-08-14|           129.675|            43.225|              43.225|                          170|\n|                 bar|      duplo standard|     539|   1684443|            Portugal|    Confirmado|   2542|                 bar|2023-02-24 09:05:...|         5|                    1|       1|      1|       0|    0|          475.0|  2023-08-20|  2023-08-25|              95.0|              95.0|                95.0|                          177|\n|                 bar|     vista traseiras|      44|   1683809|              França|     Registado|    190|                 bar|2023-02-23 10:13:...|         1|                    1|       2|      2|       0|    0|           91.0|  2023-03-28|  2023-03-29|              91.0|              45.5|                45.5|                           33|\n|              normal|              studio|     395|   1680789|            Portugal|     Registado|   1829|            standard|2023-02-18 13:06:...|         1|                    1|       2|      2|       0|    0|          100.0|  2023-02-18|  2023-02-19|             100.0|              50.0|                50.0|                            0|\n|      non-refundable|       duplo confort|     179|   1674055|             Espanha|     Registado|    630|  no reembolsable 13|2023-02-08 10:26:...|         2|                    1|       1|      1|       0|    0|        144.774|  2023-02-15|  2023-02-17|            72.387|            72.387|              72.387|                            7|\n|      non-refundable|                  t1|     241|   1672602|             Holanda|     Registado|    983|          non refund|2023-02-06 13:51:...|         2|                    1|       2|      2|       0|    0|          340.0|  2023-06-09|  2023-06-11|             170.0|              85.0|                85.0|                          123|\n|             website|                  t1|     482|   1668584|             Irlanda|     Registado|   2285|web best availabl...|2023-01-31 15:22:...|         5|                    1|       2|      2|       0|    0|          285.0|  2023-05-18|  2023-05-23|              57.0|              28.5|                28.5|                          107|\n|                 bar|twin com wc priva...|     492|   1667935|            Portugal|     Registado|   2322|                 bar|2023-01-30 15:43:...|         3|                    1|       2|      2|       0|    0|          210.0|  2023-02-06|  2023-02-09|              70.0|              35.0|                35.0|                            7|\n|      non-refundable|     alojamento nisa|     537|   1667473|            Portugal|     Cancelado|   2721|      no reembolsvel|2023-01-29 21:26:...|         1|                    1|       2|      2|       1|    0| 129.4999999999|  2023-02-04|  2023-02-05|    129.4999999999|    64.74999999995|      64.74999999995|                            6|\n|        mr main rate|      duplo standard|     311|   1666554|            Portugal|     Registado|   1407|       mr  main rate|2023-01-28 14:16:...|         1|                    1|       2|      2|       0|    0|          57.33|  2023-01-30|  2023-01-31|             57.33|            28.665|              28.665|                            2|\n|             website|                twin|     535|   1664366|            Alemanha|     Registado|   2524|             website|2023-01-25 18:38:...|         3|                    1|       2|      2|       0|    0|          207.0|  2023-04-15|  2023-04-18|              69.0|              34.5|                34.5|                           80|\n|        main rate bb|      duplo standard|     309|   1662193|            Portugal|  NãoRegistado|   1372|        main rate bb|2023-01-23 10:06:...|         1|                    1|       2|      2|       0|    0|         60.858|  2023-04-15|  2023-04-16|            60.858|            30.429|              30.429|                           82|\n|             website|      duplo standard|     556|   1661043|              Brasil|     Registado|   2831|web best availabl...|2023-01-21 11:14:...|         1|                    1|       2|      2|       0|    1|           68.0|  2023-01-27|  2023-01-28|              68.0|              34.0|                34.0|                            6|\n|        main rate bb|            superior|     310|   1660318|            Portugal|    Modificada|   2870|        main rate bb|2023-01-20 07:28:...|         3|                    1|       3|      3|       0|    0|        268.569|  2023-02-19|  2023-02-22| 89.52300000000001|29.841000000000005|  29.841000000000005|                           30|\n|              normal|            superior|     443|   1656811|      Estados Unidos|     Cancelado|   2063|              normal|2023-01-14 22:45:...|         2|                    1|       2|      2|       0|    0|          514.0|  2023-04-03|  2023-04-05|             257.0|             128.5|               128.5|                           79|\n|         tarifa site|               duplo|     304|   1656510|            Portugal|     Registado|   1352|         tarifa site|2023-01-14 15:22:...|         3|                    1|       1|      1|       0|    0|          179.4|  2023-04-03|  2023-04-06|59.800000000000004|59.800000000000004|  59.800000000000004|                           79|\n|             website|      duplo standard|     556|   1651717|            Portugal|      Pendente|   2831|web best availabl...|2023-01-06 23:30:...|         1|                    1|       2|      2|       0|    0|          72.25|  2023-01-07|  2023-01-08|             72.25|            36.125|              36.125|                            1|\n|        mr main rate|      duplo standard|     309|   1647298|            Portugal|  NãoRegistado|   1372|       mr  main rate|2022-12-29 21:06:...|         1|                    2|       2|      4|       0|    0|        119.952|  2023-08-14|  2023-08-15|           119.952|            29.988|              59.976|                          228|\n|              normal|twin vista mar pa...|     444|   1646962|            Portugal|     Registado|   2386|              normal|2022-12-29 11:30:...|         3|                    1|       2|      2|       0|    0|          240.0|  2023-02-12|  2023-02-15|              80.0|              40.0|                40.0|                           45|\n|      non-refundable|               suite|     179|   1642070|              França|     Registado|   1766|  no reembolsable 13|2022-12-17 13:24:...|         4|                    1|       3|      3|       0|    0| 501.0479999998|  2022-12-19|  2022-12-23|   125.26199999995|41.753999999983336|  41.753999999983336|                            2|\n|               other|                  t1|     453|   1640641|            Portugal|     Registado|   2117|        venda direta|2022-12-14 11:51:...|         1|                    1|       4|      4|       0|    0|            0.0|  2022-12-14|  2022-12-15|               0.0|               0.0|                 0.0|                            0|\n|      non-refundable|       duplo confort|     179|   1636142|            Portugal|     Registado|    630|  no reembolsable 13|2022-12-04 21:49:...|         2|                    1|       1|      1|       0|    0| 144.7739999999|  2022-12-26|  2022-12-28|    72.38699999995|    72.38699999995|      72.38699999995|                           22|\n|             website|      duplo standard|     556|   1631024|            Portugal|    Modificada|   2831|web best availabl...|2022-11-25 10:32:...|         3|                    1|       2|      2|       0|    0|          171.0|  2022-11-28|  2022-12-01|              57.0|              28.5|                28.5|                            3|\n|                 bar|      duplo standard|     539|   1630260|             Espanha|     Registado|   2542|                 bar|2022-11-23 16:08:...|         2|                    1|       1|      1|       0|    0|          136.0|  2022-11-25|  2022-11-27|              68.0|              68.0|                68.0|                            2|\n|      non-refundable|                twin|     322|   1629203|            Portugal|     Registado|   2259|   no reembolsvel ap|2022-11-21 16:24:...|         1|                    1|       1|      1|       0|    0|           59.0|  2022-12-01|  2022-12-02|              59.0|              59.0|                59.0|                           10|\n|              normal|            standard|     319|   1624040|            Portugal|     Registado|   2264|           normal bb|2022-11-11 11:57:...|         4|                    1|       2|      2|       0|    0|          292.0|  2022-12-12|  2022-12-16|              73.0|              36.5|                36.5|                           31|\n|            standart|            superior|     511|   1622539|            Alemanha|     Registado|   2810|standart rate  qu...|2022-11-08 15:03:...|         1|                    1|       2|      2|       0|    0|           80.0|  2022-11-08|  2022-11-09|              80.0|              40.0|                40.0|                            0|\n|                 bar|      duplo standard|     426|   1620027|            Portugal|     Registado|   1995|                 bar|2022-11-03 21:33:...|         2|                    1|       2|      2|       0|    0|          161.0|  2022-11-04|  2022-11-06|              80.5|             40.25|               40.25|                            1|\n|               other|               other|     225|   1617407|              França|     Registado|    846|                  or|2022-10-30 11:11:...|         5|                    1|       3|      3|       0|    0|         1075.0|  2022-11-09|  2022-11-14|             215.0| 71.66666666666667|   71.66666666666667|                           10|\n|             website|               suite|     535|   1617206|            Portugal|     Registado|   2527|             website|2022-10-29 18:20:...|         2|                    1|       2|      2|       0|    0|          162.0|  2023-01-03|  2023-01-05|              81.0|              40.5|                40.5|                           66|\n|              normal|              triplo|     444|   1614973|               Suiça|     Registado|   2229|              normal|2022-10-25 13:50:...|         1|                    1|       1|      1|       0|    0|          120.0|  2022-10-25|  2022-10-26|             120.0|             120.0|               120.0|                            0|\n|                 bar|                  t3|     379|   1613154|         Reino Unido|    Modificada|   1742|                 bar|2022-10-22 04:48:...|         8|                    1|       5|      5|       0|    0|         2936.0|  2023-06-15|  2023-06-23|             367.0|              73.4|                73.4|                          236|\n|        main rate bb|      duplo standard|     311|   1610683|            Portugal|  NãoRegistado|   1407|        main rate bb|2022-10-18 05:38:...|         1|                    1|       2|      2|       0|    0|          83.79|  2022-10-19|  2022-10-20|             83.79|            41.895|              41.895|                            1|\n|      non-refundable| duplo cama de casal|     478|   1609499|            Portugal|     Registado|   2231|      no reembolsvel|2022-10-16 11:58:...|         2|                    1|       2|      2|       0|    0|          100.0|  2022-11-15|  2022-11-17|              50.0|              25.0|                25.0|                           30|\n|             website|            familiar|     535|   1606113|            Portugal|     Registado|   2526|             website|2022-10-11 07:40:...|         1|                    1|       2|      2|       0|    0|           81.0|  2022-10-13|  2022-10-14|              81.0|              40.5|                40.5|                            2|\n|              normal|               duplo|     444|   1601297|              França|     Registado|   2073|              normal|2022-10-03 14:29:...|         1|                    1|       2|      2|       0|    0|           80.0|  2022-10-06|  2022-10-07|              80.0|              40.0|                40.0|                            3|\n|      non-refundable|alojamento arraiolos|     537|   1596417|            Portugal|     Registado|   2720|      no reembolsvel|2022-09-26 12:40:...|         1|                    1|       2|      2|       0|    1| 129.4999999999|  2022-10-02|  2022-10-03|    129.4999999999|    64.74999999995|      64.74999999995|                            6|\n|             website|      duplo standard|     556|   1595739|            Portugal|      Pendente|   2831|web best availabl...|2022-09-25 13:30:...|         1|                    1|       2|      2|       0|    0|           57.0|  2022-10-17|  2022-10-18|              57.0|              28.5|                28.5|                           22|\n|              normal|duplo vista mar l...|     444|   1593144|            Portugal|     Cancelado|   2074|              normal|2022-09-21 06:06:...|         1|                    1|       2|      2|       0|    0|           90.0|  2022-10-03|  2022-10-04|              90.0|              45.0|                45.0|                           12|\n|             website|               duplo|     535|   1593026|            Portugal|     Registado|   2523|             website|2022-09-20 21:11:...|         1|                    1|       2|      2|       0|    0|           95.0|  2022-09-24|  2022-09-25|              95.0|              47.5|                47.5|                            4|\n|              normal|           duplotwin|     404|   1592600|         Reino Unido|     Registado|   1888|         preo normal|2022-09-20 10:39:...|         4|                    1|       2|      2|       0|    0|          360.0|  2022-09-27|  2022-10-01|              90.0|              45.0|                45.0|                            7|\n|              normal|               suite|     444|   1591856|            Alemanha|     Registado|   2076|              normal|2022-09-19 09:01:...|         2|                    1|       2|      2|       0|    0|          260.0|  2022-09-20|  2022-09-22|             130.0|              65.0|                65.0|                            1|\n|              normal|               suite|     444|   1590204|      Estados Unidos|     Registado|   2076|              normal|2022-09-16 10:26:...|         1|                    1|       2|      2|       0|    0|          130.0|  2022-09-18|  2022-09-19|             130.0|              65.0|                65.0|                            2|\n|tarifa sem pequen...|            standard|     403|   1587869|            Portugal|    Modificada|   1876|tarifa sem pequen...|2022-09-12 21:14:...|         2|                    1|       1|      1|       0|    0|           99.0|  2022-10-20|  2022-10-22|              49.5|              49.5|                49.5|                           38|\n|              normal|     city individual|     319|   1584357|              Grécia|     Registado|   2889|           normal ro|2022-09-07 13:10:...|         6|                    1|       1|      1|       0|    0|          318.0|  2022-09-25|  2022-10-01|              53.0|              53.0|                53.0|                           18|\n|                 bar|         apartamento|     559|   1580967|            Portugal|     Registado|   2862|                 bar|2022-09-02 09:50:...|         2|                    1|       2|      2|       0|    1|          306.0|  2022-09-16|  2022-09-18|             153.0|              76.5|                76.5|                           14|\n|epoca alta jul ag...|       duplo ou twin|     392|   1579894|             Espanha|     Registado|   1801|epoca alta  jul a...|2022-08-31 18:27:...|         2|                    1|       2|      2|       0|    0|       257.0112|  2022-09-02|  2022-09-04|          128.5056|           64.2528|             64.2528|                            2|\n|        main rate bb|            superior|     311|   1579742|            Portugal|  NãoRegistado|   2034|        main rate bb|2022-08-31 15:40:...|         1|                    1|       2|      2|       0|    0|          97.02|  2022-09-28|  2022-09-29|             97.02|             48.51|               48.51|                           28|\n|                  4n|              studio|     287|   1576645|             Espanha|     Registado|   1232|                  4n|2022-08-27 00:14:...|         4|                    1|       4|      4|       0|    0|          486.0|  2022-08-29|  2022-09-02|             121.5|            30.375|              30.375|                            2|\n|         tarifa site|               suite|     304|   1576306|              França|     Registado|   1348|         tarifa site|2022-08-26 13:07:...|         2|                    1|       2|      2|       0|    0|          221.4|  2022-09-01|  2022-09-03|             110.7|             55.35|               55.35|                            6|\n|             website|    duplo wextra bed|     556|   1576252|            Portugal|      Pendente|   2847|web best availabl...|2022-08-26 12:05:...|         1|                    1|       2|      2|       1|    0|           71.0|  2022-08-28|  2022-08-29|              71.0|              35.5|                35.5|                            2|\n|             website|      duplo standard|     556|   1574543|            Portugal|     Registado|   2831|web best availabl...|2022-08-23 23:49:...|         1|                    1|       2|      2|       0|    0|          55.25|  2022-08-24|  2022-08-25|             55.25|            27.625|              27.625|                            1|\n|               other|            superior|     310|   1574395|      Estados Unidos|     Registado|   1674| early booking 30 sf|2022-08-23 19:58:...|         2|                    1|       2|      2|       0|    0|          101.2|  2022-10-08|  2022-10-10|              50.6|              25.3|                25.3|                           46|\n|      non-refundable|duplot duplo com ...|     311|   1572629|            Portugal|     Registado|   1946|                  nr|2022-08-21 10:58:...|         1|                    1|       2|      2|       1|    0| 120.7499999999|  2022-09-11|  2022-09-12|    120.7499999999|    60.37499999995|      60.37499999995|                           21|\n|      non-refundable|               duplo|     415|   1569058|              Canadá|     Registado|   1940|      non refundable|2022-08-15 18:39:...|         1|                    1|       2|      2|       0|    0|           96.0|  2022-08-15|  2022-08-16|              96.0|              48.0|                48.0|                            0|\n|                 bar|                  t2|     539|   1566469|            Portugal|    Confirmado|   2546|                 bar|2022-08-11 14:23:...|         2|                    1|       1|      1|       0|    0|          220.0|  2022-08-20|  2022-08-22|             110.0|             110.0|               110.0|                            9|\n|                 bar|        cela monacal|     504|   1565960|            Portugal|    Modificada|   2377|                 bar|2022-08-10 18:29:...|         1|                    1|       1|      2|       0|    0|          77.52|  2022-11-17|  2022-11-18|             77.52|             38.76|               77.52|                           99|\n|              normal|               other|     273|   1565719|             Espanha|     Registado|   1235|              normal|2022-08-10 13:00:...|         2|                    1|       2|      2|       0|    0|          400.0|  2022-08-21|  2022-08-23|             200.0|             100.0|               100.0|                           11|\n|              normal|               duplo|     444|   1563446|             Espanha|     Registado|   2073|              normal|2022-08-07 16:11:...|         2|                    1|       2|      2|       0|    0|          320.0|  2022-08-26|  2022-08-28|             160.0|              80.0|                80.0|                           19|\n|      non-refundable|                pool|     514|   1558490|             Espanha|     Registado|   2494|       no refundable|2022-07-31 21:37:...|         3|                    1|       2|      2|       0|    0|          526.5|  2022-08-04|  2022-08-07|             175.5|             87.75|               87.75|                            4|\n|        main rate bb|      duplo standard|     309|   1557519|              Itália|     Registado|   1372|        main rate bb|2022-07-30 15:44:...|         5|                    1|       2|      2|       0|    0|          308.7|  2022-08-25|  2022-08-30|61.739999999999995|30.869999999999997|  30.869999999999997|                           26|\n|          meia penso|      duplo standard|     426|   1557354|            Portugal|    Modificada|   1995|          meia penso|2022-07-30 11:02:...|         1|                    1|       2|      2|       0|    0|          140.0|  2022-08-07|  2022-08-08|             140.0|              70.0|                70.0|                            8|\n|        main rate bb|      duplo standard|     311|   1554087|      Estados Unidos|     Registado|   1407|        main rate bb|2022-07-27 01:09:...|         1|                    1|       1|      1|       0|    0|          90.65|  2022-09-22|  2022-09-23|             90.65|             90.65|               90.65|                           57|\n|             website|               suite|     556|   1552342|            Portugal|      Pendente|   2834|web best availabl...|2022-07-25 22:17:...|         4|                    1|       4|      4|       0|    0|         504.05|  2022-08-10|  2022-08-14|          126.0125|         31.503125|           31.503125|                           16|\n|             website|               suite|     556|   1548751|            Portugal|     Registado|   2834|web best availabl...|2022-07-22 17:21:...|         1|                    1|       4|      4|       0|    0|         119.85|  2022-07-23|  2022-07-24|            119.85|           29.9625|             29.9625|                            1|\n|      non-refundable|               duplo|     415|   1543737|      Estados Unidos|     Registado|   1940|      non refundable|2022-07-16 01:03:...|         1|                    1|       2|      2|       0|    0|           96.0|  2022-07-26|  2022-07-27|              96.0|              48.0|                48.0|                           10|\n|      non-refundable|            superior|     310|   1536828|            Portugal|    Modificada|   1673|                 nrf|2022-07-06 16:11:...|         4|                    3|       1|      3|       0|    0|          734.4|  2022-07-11|  2022-07-15|             183.6|61.199999999999996|               183.6|                            5|\n|      non-refundable|       twin standard|     366|   1536151|            Portugal|    Modificada|   1648|      non refundable|2022-07-05 18:15:...|         1|                    1|       2|      2|       0|    0|           65.7|  2022-07-12|  2022-07-13|              65.7|             32.85|               32.85|                            7|\n|             website|               duplo|     535|   1536104|            Portugal|     Cancelado|   2523|             website|2022-07-05 17:21:...|         2|                    1|       2|      2|       0|    0|          162.0|  2022-07-20|  2022-07-22|              81.0|              40.5|                40.5|                           15|\n|      non-refundable|       twin standard|     310|   1534368|            Portugal|    Modificada|   1424|                 nrf|2022-07-03 17:37:...|         4|                    1|       2|      2|       0|    0|          226.8|  2022-07-04|  2022-07-08|              56.7|             28.35|               28.35|                            1|\n|      non-refundable|       twin standard|     310|   1530788|            Portugal|  NãoRegistado|   1424|                 nrf|2022-06-28 14:36:...|         1|                    2|       2|      4|       0|    0|          126.0|  2022-06-30|  2022-07-01|             126.0|              31.5|                63.0|                            2|\n|      non-refundable|      duplo standard|     311|   1530712|              França|  NãoRegistado|   1407|           db bb nrf|2022-06-28 13:00:...|         2|                    1|       1|      1|       0|    0|          181.0|  2022-07-19|  2022-07-21|              90.5|              90.5|                90.5|                           21|\n|      non-refundable|            superior|     309|   1527295|            Portugal|  NãoRegistado|   2254|     superior ro nrf|2022-06-23 13:14:...|         1|                    1|       1|      1|       0|    0|           58.0|  2022-06-23|  2022-06-24|              58.0|              58.0|                58.0|                            0|\n|      non-refundable|         sut premium|     311|   1527082|             Croácia|     Registado|   2159|      premium bb nrf|2022-06-23 07:38:...|         1|                    1|       2|      2|       0|    0|          118.0|  2022-06-25|  2022-06-26|             118.0|              59.0|                59.0|                            2|\n|      non-refundable|               duplo|     321|   1525867|             Espanha|     Registado|   1417|bar no refundable...|2022-06-21 16:26:...|         1|                    1|       2|      2|       0|    0|           84.0|  2022-08-27|  2022-08-28|              84.0|              42.0|                42.0|                           67|\n|               other|            superior|     309|   1524856|            Portugal|     Registado|   2254|         superior ro|2022-06-20 12:27:...|         3|                    1|       1|      1|       0|    0|          159.3|  2022-06-21|  2022-06-24|              53.1|              53.1|                53.1|                            1|\n|                  4n|    onebed apartment|     285|   1521130|             Espanha|     Cancelado|   1290|                  4n|2022-06-15 10:38:...|         4|                    1|       4|      4|       0|    0|          468.0|  2022-08-28|  2022-09-01|             117.0|             29.25|               29.25|                           74|\n|              normal|              triplo|     444|   1518268|            Portugal|     Registado|   2229|              normal|2022-06-11 21:11:...|         4|                    1|       3|      3|       0|    0|          480.0|  2022-06-20|  2022-06-24|             120.0|              40.0|                40.0|                            9|\n|             website|      duplo standard|     556|   1516589|            Portugal|      Pendente|   2831|web best availabl...|2022-06-09 12:33:...|         2|                    1|       2|      2|       0|    0|         118.75|  2022-06-12|  2022-06-14|            59.375|           29.6875|             29.6875|                            3|\n|                 bar|            superior|     504|   1516396|            Portugal|     Registado|   2369|                 bar|2022-06-09 08:28:...|         1|                    1|       1|      1|       0|    0|        127.585|  2022-07-23|  2022-07-24|           127.585|           127.585|             127.585|                           44|\n|        db room only|      duplo standard|     311|   1516150|             Espanha|  NãoRegistado|   1407|        db room only|2022-06-08 20:22:...|         1|                    1|       1|      1|       0|    0|           84.0|  2022-08-12|  2022-08-13|              84.0|              84.0|                84.0|                           65|\n|              dbs bb|            superior|     311|   1514267|               Suiça|     Registado|   2034|              dbs bb|2022-06-06 17:24:...|         4|                    1|       2|      2|       0|    0|          406.0|  2022-06-30|  2022-07-04|             101.5|             50.75|               50.75|                           24|\n|             website|       twin standard|     556|   1513408|            Portugal|      Pendente|   2832|web best availabl...|2022-06-05 17:55:...|         1|                    1|       2|      2|       0|    0|          170.0|  2022-06-11|  2022-06-12|             170.0|              85.0|                85.0|                            6|\n|              normal|              triplo|     444|   1508646|            Portugal|     Registado|   2229|              normal|2022-05-30 13:23:...|         2|                    1|       3|      3|       0|    0|          240.0|  2022-06-03|  2022-06-05|             120.0|              40.0|                40.0|                            4|\n|              normal|               other|     501|   1499078|              França|     Registado|   2372|              normal|2022-05-18 07:54:...|         2|                    1|       3|      3|       0|    1|          312.0|  2022-05-22|  2022-05-24|             156.0|              52.0|                52.0|                            4|\n|             website|            bungalow|     535|   1496817|            Portugal|      Pendente|   2783|             website|2022-05-15 16:11:...|         1|                    1|       2|      2|       0|    0|           72.0|  2022-05-18|  2022-05-19|              72.0|              36.0|                36.0|                            3|\n|               promo|            superior|     379|   1494951|         Reino Unido|     Registado|   1740|         oferta maio|2022-05-12 20:17:...|         7|                    1|       1|      1|       1|    0|          896.8|  2022-05-27|  2022-06-03| 128.1142857142857| 128.1142857142857|   128.1142857142857|                           15|\n|               promo|               suite|     379|   1493459|             Irlanda|     Registado|   1732|         oferta maio|2022-05-11 07:51:...|        12|                    1|       3|      3|       0|    0|         1625.6|  2022-05-28|  2022-06-09|135.46666666666667| 45.15555555555556|   45.15555555555556|                           17|\n|   premium room only|         sut premium|     311|   1487168|             Espanha|  NãoRegistado|   2159|   premium room only|2022-05-03 14:25:...|         1|                    2|       1|      2|       0|    0|          208.0|  2022-05-12|  2022-05-13|             208.0|             104.0|               208.0|                            9|\n|                 bar|      duplo standard|     426|   1479096|            Alemanha|     Registado|   1995|                 bar|2022-04-22 07:48:...|         1|                    1|       2|      2|       0|    0|           70.0|  2022-04-22|  2022-04-23|              70.0|              35.0|                35.0|                            0|\n|      non-refundable|            superior|     309|   1479020|              França|  NãoRegistado|   2254|     superior ro nrf|2022-04-21 22:58:...|         3|                    1|       2|      2|       0|    0|          144.0|  2022-04-22|  2022-04-25|              48.0|              24.0|                24.0|                            1|\n|                 bar|               suite|     321|   1478889|              Brasil|     Registado|   2257|           bar  s pa|2022-04-21 19:41:...|         1|                    1|       4|      4|       1|    0|           97.0|  2022-05-08|  2022-05-09|              97.0|             24.25|               24.25|                           17|\n|                 bar|        duplo deluxe|     465|   1476610|      Estados Unidos|     Registado|   2407|              bar bb|2022-04-18 16:57:...|         1|                    1|       2|      2|       0|    0|          110.0|  2022-04-20|  2022-04-21|             110.0|              55.0|                55.0|                            2|\n|               promo|      duplo standard|     311|   1470852|              França|  NãoRegistado|   1407|               promo|2022-04-09 14:09:...|         1|                    1|       2|      2|       0|    0|           49.5|  2022-04-28|  2022-04-29|              49.5|             24.75|               24.75|                           19|\n|                 bar|              studio|     490|   1467157|            Portugal|     Registado|   2799|                 bar|2022-04-05 12:35:...|         2|                    1|       2|      2|       0|    0|          130.0|  2022-04-07|  2022-04-09|              65.0|              32.5|                32.5|                            2|\n|      non-refundable|      duplo standard|     556|   1464856|            Portugal|      Pendente|   2831| nrf  non refundable|2022-04-02 16:43:...|         2|                    1|       2|      2|       0|    0|         125.55|  2022-04-02|  2022-04-04|            62.775|           31.3875|             31.3875|                            0|\n|      non-refundable|            superior|     309|   1460549|            Portugal|     Registado|   1430|         twin bb nrf|2022-03-28 06:36:...|         2|                    1|       2|      2|       0|    0|          113.4|  2022-03-28|  2022-03-30|              56.7|             28.35|               28.35|                            0|\n|              normal|               other|     273|   1460424|      Estados Unidos|     Registado|   1197|              normal|2022-03-27 21:28:...|         1|                    1|       2|      2|       0|    0|          155.0|  2022-06-17|  2022-06-18|             155.0|              77.5|                77.5|                           82|\n|               db ro|      duplo standard|     309|   1457852|            Portugal|    Modificada|   1372|               db ro|2022-03-23 23:52:...|         1|                    1|       2|      2|       0|    0|           48.6|  2022-06-04|  2022-06-05|              48.6|              24.3|                24.3|                           73|\n|                 bar|            familiar|     492|   1457582|            Portugal|     Registado|   2332|                 bar|2022-03-23 18:21:...|         1|                    1|       3|      3|       0|    0|          100.0|  2022-04-17|  2022-04-18|             100.0|33.333333333333336|  33.333333333333336|                           25|\n|        main rate bb|      duplo standard|     310|   1456608|            Portugal|  NãoRegistado|   1395|        main rate bb|2022-03-22 13:04:...|         2|                    1|       2|      2|       0|    0|          128.0|  2022-04-22|  2022-04-24|              64.0|              32.0|                32.0|                           31|\n|              normal|               duplo|     444|   1448347|              França|     Registado|   2073|              normal|2022-03-08 11:22:...|         2|                    3|       2|      6|       0|    0|          420.0|  2022-03-14|  2022-03-16|             210.0|              35.0|               105.0|                            6|\n|              normal|               duplo|     444|   1448024|            Portugal|     Registado|   2073|              normal|2022-03-07 18:33:...|         1|                    1|       2|      2|       0|    0|           70.0|  2022-03-13|  2022-03-14|              70.0|              35.0|                35.0|                            6|\n|               other|            standard|     259|   1442899|            Portugal|     Registado|   1103|      lastimute egds|2022-02-26 09:56:...|         1|                    1|       2|      2|       0|    0|          121.5|  2022-02-26|  2022-02-27|             121.5|             60.75|               60.75|                            0|\n|                 bar|        cela sculare|     504|   1442873|            Portugal|     Registado|   2378|                 bar|2022-02-26 08:32:...|         1|                    1|       2|      2|       0|    0|           79.8|  2022-02-26|  2022-02-27|              79.8|              39.9|                39.9|                            0|\n|             website|    duplo wextra bed|     556|   1441907|            Portugal|     Registado|   2847|web best availabl...|2022-02-24 11:02:...|         1|                    1|       2|      2|       1|    0|          110.5|  2022-05-14|  2022-05-15|             110.5|             55.25|               55.25|                           79|\n|                 bar|           duplotwin|     185|   1441042|            Portugal|    Modificada|    660|                 bar|2022-02-22 19:24:...|         1|                    1|       2|      2|       0|    0|          118.0|  2022-02-28|  2022-03-01|             118.0|              59.0|                59.0|                            6|\n|                 bar|       twin standard|     426|   1440593|      Estados Unidos|     Registado|   1990|                 bar|2022-02-21 23:47:...|         9|                    1|       2|      2|       0|    0|          900.0|  2022-08-11|  2022-08-20|             100.0|              50.0|                50.0|                          171|\n|               promo|       twin standard|     311|   1440323|            Portugal|     Registado|   1429|               promo|2022-02-21 16:58:...|         1|                    1|       2|      2|       0|    0|           49.0|  2022-02-26|  2022-02-27|              49.0|              24.5|                24.5|                            5|\n|               promo|      duplo standard|     310|   1438686|              França|     Registado|   1395|               promo|2022-02-18 18:19:...|         6|                    1|       2|      2|       0|    0|          264.0|  2022-02-25|  2022-03-03|              44.0|              22.0|                22.0|                            7|\n|              normal|              studio|     560|   1437893|            Portugal|     Registado|   2865|            standard|2022-02-17 13:14:...|         3|                    1|       1|      1|       0|    0|          135.0|  2022-03-07|  2022-03-10|              45.0|              45.0|                45.0|                           18|\n|               promo|          eco garden|     514|   1425124|            Portugal|     Registado|   2425|        winter promo|2022-01-22 10:37:...|         2|                    1|       2|      2|       0|    0|          161.0|  2022-02-25|  2022-02-27|              80.5|             40.25|               40.25|                           34|\n|      non-refundable|      duplo standard|     310|   1424020|            Portugal|    Modificada|   1395|                 nrf|2022-01-19 10:31:...|         1|                    1|       2|      2|       0|    0|           48.0|  2022-01-23|  2022-01-24|              48.0|              24.0|                24.0|                            4|\n|             website|      duplo standard|     556|   1422910|            Portugal|      Pendente|   2831|web best availabl...|2022-01-16 09:47:...|         1|                    1|       2|      2|       0|    0|          52.25|  2022-01-16|  2022-01-17|             52.25|            26.125|              26.125|                            0|\n|               promo|               other|     269|   1422027|            Portugal|     Registado|   1159|campanha especial...|2022-01-13 12:36:...|         1|                    1|       1|      1|       0|    0|          59.86|  2022-01-19|  2022-01-20|             59.86|             59.86|               59.86|                            6|\n|             website|      duplo standard|     556|   1723333|            Portugal|      Pendente|   2831|web best availabl...|2023-04-18 08:09:...|         1|                    1|       2|      2|       0|    0|           57.8|  2023-05-07|  2023-05-08|              57.8|              28.9|                28.9|                           19|\n|        main rate bb|      duplo standard|     311|   1721040|            Alemanha|     Registado|   1407|        main rate bb|2023-04-15 15:21:...|         1|                    1|       2|      2|       0|    0|           89.3|  2023-05-01|  2023-05-02|              89.3|             44.65|               44.65|                           16|\n|        mr main rate|      duplo standard|     311|   1720641|      Estados Unidos|  NãoRegistado|   1407|       mr  main rate|2023-04-14 21:29:...|         1|                    1|       2|      2|       0|    0|          80.75|  2023-05-07|  2023-05-08|             80.75|            40.375|              40.375|                           23|\n|              normal|               other|     501|   1717666|           Austrália|     Registado|   2364|              normal|2023-04-11 10:52:...|         2|                    1|       2|      2|       0|    0|          228.0|  2023-06-10|  2023-06-12|             114.0|              57.0|                57.0|                           60|\n|                 bar|               suite|     465|   1717515|      Estados Unidos|     Registado|   2408|              bar bb|2023-04-11 06:02:...|         1|                    1|       2|      2|       0|    0|          120.0|  2023-06-12|  2023-06-13|             120.0|              60.0|                60.0|                           62|\n|                 bar|duplo premium cam...|     426|   1714954|            Portugal|     Registado|   1991|                 bar|2023-04-06 22:18:...|         2|                    1|       2|      2|       0|    1|          171.0|  2023-05-05|  2023-05-07|              85.5|             42.75|               42.75|                           29|\n|             website|    duplo wextra bed|     556|   1714006|            Portugal|      Pendente|   2847|web best availabl...|2023-04-05 18:17:...|         1|                    1|       3|      3|       0|    0|           83.3|  2023-05-01|  2023-05-02|              83.3|27.766666666666666|  27.766666666666666|                           26|\n|        mr main rate|      duplo standard|     309|   1706478|            Portugal|     Registado|   1372|       mr  main rate|2023-03-27 09:40:...|         1|                    1|       1|      1|       0|    0|         46.075|  2023-03-28|  2023-03-29|            46.075|            46.075|              46.075|                            1|\n|                 bar|casal com wc priv...|     494|   1704026|            Portugal|     Registado|   2326|                 bar|2023-03-23 18:15:...|         1|                    1|       2|      2|       0|    0|           85.0|  2023-03-28|  2023-03-29|              85.0|              42.5|                42.5|                            5|\n|        mr main rate|       twin standard|     311|   1701613|            Portugal|     Registado|   1429|       mr  main rate|2023-03-20 15:35:...|         1|                    2|       2|      4|       0|    0|          133.0|  2023-03-22|  2023-03-23|             133.0|             33.25|                66.5|                            2|\n|      non-refundable|              garden|     514|   1701430|             Bélgica|    Modificada|   2492|     nonrefundable 5|2023-03-20 11:24:...|         7|                    1|       1|      1|       0|    0|          980.0|  2023-08-04|  2023-08-11|             140.0|             140.0|               140.0|                          137|\n|        main rate bb|            superior|     310|   1697393|            Portugal|    Modificada|   1673|        main rate bb|2023-03-14 15:11:...|         1|                    1|       2|      2|       0|    0|         93.993|  2023-03-18|  2023-03-19|            93.993|           46.9965|             46.9965|                            4|\n|        mr main rate|      duplo standard|     309|   1696187|            Portugal|  NãoRegistado|   1372|       mr  main rate|2023-03-12 22:01:...|         1|                    1|       2|      2|       0|    0|       34.55625|  2023-03-22|  2023-03-23|          34.55625|         17.278125|           17.278125|                           10|\n|        main rate bb|            superior|     309|   1691667|            Portugal|     Registado|   2254|        main rate bb|2023-03-06 12:29:...|         1|                    2|       1|      2|       0|    0|       118.8735|  2023-03-07|  2023-03-08|          118.8735|          59.43675|            118.8735|                            1|\n|        main rate bb|      duplo standard|     310|   1690983|             Espanha|     Registado|   1397|        main rate bb|2023-03-05 15:29:...|         1|                    1|       3|      3|       0|    0|       88.92475|  2023-03-25|  2023-03-26|          88.92475|29.641583333333333|  29.641583333333333|                           20|\n|        mr main rate|      duplo standard|     310|   1687475|              Brasil|  NãoRegistado|   1395|       mr  main rate|2023-02-28 12:23:...|         1|                    1|       2|      2|       0|    0|        59.8975|  2023-05-02|  2023-05-03|           59.8975|          29.94875|            29.94875|                           63|\n|         tarifa site|               suite|     304|   1685269|            Alemanha|     Registado|   1348|         tarifa site|2023-02-25 14:46:...|         2|                    1|       2|      2|       0|    0|         237.36|  2023-05-10|  2023-05-12|            118.68|             59.34|               59.34|                           74|\n|        mr main rate|      duplo standard|     311|   1683972|             Espanha|     Registado|   1407|       mr  main rate|2023-02-23 14:24:...|         1|                    2|       2|      4|       0|    0|        132.696|  2023-03-09|  2023-03-10|           132.696|            33.174|              66.348|                           14|\n|             website|                  t2|     482|   1681903|            Portugal|     Cancelado|   2286|web best availabl...|2023-02-20 10:43:...|         8|                    1|       6|      6|       0|    0|         1995.0|  2023-07-22|  2023-07-30|           249.375|           41.5625|             41.5625|                          152|\n|             website|      duplo standard|     556|   1677955|            Portugal|     Registado|   2831|web best availabl...|2023-02-14 07:54:...|         1|                    1|       2|      2|       0|    0|           76.5|  2023-02-17|  2023-02-18|              76.5|             38.25|               38.25|                            3|\n|               other|       duplo ou twin|     392|   1674713|            Portugal|     Registado|   1801|programa de so va...|2023-02-09 01:59:...|         1|                    1|       2|      2|       0|    0|          120.0|  2023-02-14|  2023-02-15|             120.0|              60.0|                60.0|                            5|\n|             website|       twin standard|     556|   1672776|            Portugal|     Registado|   2832|web best availabl...|2023-02-06 17:42:...|         4|                    1|       2|      2|       0|    0|          221.0|  2023-02-06|  2023-02-10|             55.25|            27.625|              27.625|                            0|\n|      non-refundable|       duplo confort|     179|   1672743|             Polónia|     Registado|    630|  no reembolsable 13|2023-02-06 17:05:...|         1|                    1|       1|      1|       0|    0|         80.739|  2023-03-17|  2023-03-18|            80.739|            80.739|              80.739|                           39|\n|chocolate experience|            superior|     280|   1668968|            Portugal|     Registado|   2562|chocolate experience|2023-01-31 23:42:...|         1|                    1|       2|      2|       0|    0|           94.0|  2023-02-20|  2023-02-21|              94.0|              47.0|                47.0|                           20|\n|             website|               duplo|     535|   1668709|            Portugal|      Pendente|   2523|             website|2023-01-31 18:18:...|         1|                    1|       2|      2|       0|    1|           63.0|  2023-02-02|  2023-02-03|              63.0|              31.5|                31.5|                            2|\n|                 bar|                twin|     321|   1668487|            Portugal|     Registado|   1410|           bar  s pa|2023-01-31 12:44:...|         1|                    1|       2|      2|       0|    0|           67.0|  2023-02-02|  2023-02-03|              67.0|              33.5|                33.5|                            2|\n|        mr main rate|      duplo standard|     309|   1668057|            Portugal|  NãoRegistado|   1372|       mr  main rate|2023-01-30 18:31:...|         4|                    1|       2|      2|       0|    0|          176.4|  2023-04-11|  2023-04-15|              44.1|             22.05|               22.05|                           71|\n|                 bar|      duplo standard|     516|   1667947|              Suécia|     Cancelado|   2436|      bar  room only|2023-01-30 15:53:...|         7|                    1|       2|      2|       0|    0|         1410.0|  2023-06-26|  2023-07-03|201.42857142857142|100.71428571428571|  100.71428571428571|                          147|\n|              normal|               duplo|     501|   1666313|      Estados Unidos|     Registado|   2396|              normal|2023-01-27 23:25:...|         1|                    1|       2|      2|       0|    0|           83.0|  2023-03-19|  2023-03-20|              83.0|              41.5|                41.5|                           51|\n|                 bar|            superior|     504|   1663955|            Portugal|     Registado|   2369|                 bar|2023-01-25 12:05:...|         2|                    1|       1|      1|       0|    0|          205.2|  2023-01-27|  2023-01-29|             102.6|             102.6|               102.6|                            2|\n|              normal|              triplo|     444|   1655784|            Portugal|     Registado|   2229|              normal|2023-01-13 10:21:...|         1|                    1|       3|      3|       0|    0|           90.0|  2023-01-14|  2023-01-15|              90.0|              30.0|                30.0|                            1|\n|             website| bed mixed dormitory|     328|   1651776|            Alemanha|     Registado|   1450|             website|2023-01-07 07:59:...|         2|                    1|       1|      1|       0|    0|          30.64|  2023-01-07|  2023-01-09|             15.32|             15.32|               15.32|                            0|\n|             website|               suite|     556|   1650887|            Portugal|      Pendente|   2834|web best availabl...|2023-01-05 17:41:...|         1|                    1|       4|      4|       0|    0|          161.5|  2023-01-14|  2023-01-15|             161.5|            40.375|              40.375|                            9|\n|        mr main rate|      duplo standard|     311|   1633055|              Brasil|  NãoRegistado|   1407|       mr  main rate|2022-11-28 23:51:...|         1|                    1|       2|      2|       0|    0|          57.33|  2022-12-05|  2022-12-06|             57.33|            28.665|              28.665|                            7|\n|      non-refundable|               suite|     495|   1631071|            Portugal|     Registado|   2336|      no reembolsvel|2022-11-25 12:07:...|         1|                    1|       2|      2|       0|    0|          135.0|  2022-11-26|  2022-11-27|             135.0|              67.5|                67.5|                            1|\n|             website|       twin standard|     556|   1630679|            Portugal|      Pendente|   2832|web best availabl...|2022-11-24 14:28:...|         1|                    1|       2|      2|       0|    0|           68.0|  2022-12-27|  2022-12-28|              68.0|              34.0|                34.0|                           33|\n|                 bar|        cela sculare|     504|   1630482|            Portugal|    Modificada|   2378|                 bar|2022-11-24 00:07:...|         1|                    1|       2|      2|       0|    0|         72.675|  2022-11-26|  2022-11-27|            72.675|           36.3375|             36.3375|                            2|\n|      non-refundable|    alojamento crato|     537|   1630056|             Espanha|  NãoRegistado|   2722|      no reembolsvel|2022-11-23 10:29:...|         2|                    1|       2|      2|       0|    0| 258.9999999999|  2022-11-26|  2022-11-28|   129.49999999995|   64.749999999975|     64.749999999975|                            3|\n|        mr main rate|      duplo standard|     309|   1629983|            Portugal|    Modificada|   1372|       mr  main rate|2022-11-23 00:42:...|         1|                    1|       2|      2|       0|    0|          39.69|  2022-11-23|  2022-11-24|             39.69|            19.845|              19.845|                            0|\n|      reserva direta|                  t1|     453|   1627140|            Portugal|     Registado|   2117|      reserva direta|2022-11-17 17:04:...|         7|                    1|       3|      3|       0|    0|          735.0|  2022-11-24|  2022-12-01|             105.0|              35.0|                35.0|                            7|\n|        main rate bb|       twin standard|     311|   1623918|         Reino Unido|     Registado|   1429|        main rate bb|2022-11-11 07:31:...|         1|                    1|       2|      2|       0|    0|          70.56|  2022-11-13|  2022-11-14|             70.56|             35.28|               35.28|                            2|\n|             website|      duplo standard|     556|   1623780|            Portugal|      Pendente|   2831|web best availabl...|2022-11-10 20:14:...|         3|                    1|       1|      1|       0|    0|          152.0|  2022-11-11|  2022-11-14|50.666666666666664|50.666666666666664|  50.666666666666664|                            1|\n|                 bar|       twin assotado|     426|   1622625|            Portugal|     Registado|   1993|                 bar| 2022-11-08 17:32:44|         1|                    1|       2|      2|       0|    0|           48.0|  2022-11-09|  2022-11-10|              48.0|              24.0|                24.0|                            1|\n|        main rate bb|duplot duplo com ...|     311|   1620783|      Estados Unidos|  NãoRegistado|   1946|        main rate bb|2022-11-05 13:20:...|         1|                    1|       2|      2|       0|    0|         101.43|  2023-05-21|  2023-05-22|            101.43|            50.715|              50.715|                          197|\n|              normal|               duplo|     444|   1618893|      Estados Unidos|     Registado|   2073|              normal|2022-11-01 22:05:...|         2|                    1|       2|      2|       0|    0|          140.0|  2023-02-03|  2023-02-05|              70.0|              35.0|                35.0|                           94|\n|              normal|              studio|     395|   1614722|      Estados Unidos|     Registado|   1828|            standard|2022-10-25 00:44:...|         3|                    1|       1|      1|       0|    0|          243.0|  2022-12-06|  2022-12-09|              81.0|              81.0|                81.0|                           42|\n|              normal|               suite|     444|   1614661|             Espanha|     Registado|   2075|              normal|2022-10-24 21:10:...|         3|                    1|       2|      2|       2|    0|          450.0|  2022-10-29|  2022-11-01|             150.0|              75.0|                75.0|                            5|\n|      non-refundable|                pool|     514|   1614599|         Reino Unido|     Cancelado|   2494|       no refundable|2022-10-24 19:54:...|         2|                    1|       1|      1|       0|    0|          270.0|  2022-10-28|  2022-10-30|             135.0|             135.0|               135.0|                            4|\n|              normal|twin vista mar pa...|     444|   1610724|            Colômbia|     Registado|   2386|              normal|2022-10-18 07:49:...|         1|                    1|       2|      2|       0|    0|          100.0|  2022-10-18|  2022-10-19|             100.0|              50.0|                50.0|                            0|\n|             website|              single|     328|   1596068|      Estados Unidos|     Registado|   1452|             website|2022-09-25 20:52:...|         2|                    1|       1|      1|       0|    0|         135.17|  2022-09-29|  2022-10-01|            67.585|            67.585|              67.585|                            4|\n|                 bar|              single|     526|   1593292|            Portugal|      Pendente|   2472|                 bar| 2022-09-21 11:16:41|         1|                    1|       1|      1|       0|    0|           66.0|  2022-09-28|  2022-09-29|              66.0|              66.0|                66.0|                            7|\n|chocolate experience|     duplo economico|     280|   1592841|            Alemanha|     Registado|   2559|chocolate experience|2022-09-20 16:36:...|         1|                    1|       1|      1|       0|    0|           85.0|  2022-09-22|  2022-09-23|              85.0|              85.0|                85.0|                            2|\n|                 bar|      duplo standard|     539|   1592822|            Portugal|     Registado|   2542|                 bar|2022-09-20 15:57:...|         1|                    1|       1|      1|       0|    0|           47.0|  2022-09-28|  2022-09-29|              47.0|              47.0|                47.0|                            8|\n|      non-refundable|      duplo standard|     311|   1592589|             Espanha|     Registado|   1407| early booking 30 nr|2022-09-20 10:24:...|         1|                    1|       2|      2|       0|    0|          67.32|  2022-10-25|  2022-10-26|             67.32|             33.66|               33.66|                           35|\n|                 bar|            superior|     526|   1586451|            Alemanha|     Registado|   2758|                 bar|2022-09-10 18:36:...|         6|                    1|       2|      2|       0|    0|          504.0|  2022-09-21|  2022-09-27|              84.0|              42.0|                42.0|                           11|\n|              normal|twin vista mar pa...|     444|   1583699|              Itália|     Registado|   2386|              normal|2022-09-06 15:15:...|         2|                    1|       2|      2|       0|    0|          180.0|  2022-10-09|  2022-10-11|              90.0|              45.0|                45.0|                           33|\n|        mr main rate|duplot duplo com ...|     311|   1582197|              França|  NãoRegistado|   1946|       mr  main rate|2022-09-04 12:40:...|         1|                    1|       3|      3|       0|    0|           88.2|  2022-11-05|  2022-11-06|              88.2|29.400000000000002|  29.400000000000002|                           62|\n|             website|                  t1|     482|   1581263|             Espanha|     Registado|   2285|web best availabl...|2022-09-02 17:06:...|         1|                    1|       4|      4|       0|    0|          142.5|  2022-09-03|  2022-09-04|             142.5|            35.625|              35.625|                            1|\n|                  4n|              studio|     395|   1580200|              França|     Registado|   1829|                  4n|2022-09-01 09:12:...|         4|                    1|       2|      2|       0|    0|          432.0|  2022-10-21|  2022-10-25|             108.0|              54.0|                54.0|                           50|\n|      non-refundable|      single confort|     179|   1580178|               Suiça|     Registado|    629|  no reembolsable 13|2022-09-01 08:32:...|         1|                    1|       1|      1|       0|    0|         114.75|  2022-09-20|  2022-09-21|            114.75|            114.75|              114.75|                           19|\n|              normal|               other|     273|   1573308|            Portugal|     Registado|   1238|              normal|2022-08-22 12:10:...|         2|                    1|       2|      2|       0|    0|          460.0|  2022-08-23|  2022-08-25|             230.0|             115.0|               115.0|                            1|\n|             website|                  t1|     482|   1570281|            Portugal|     Registado|   2285|web best availabl...|2022-08-17 13:05:...|         7|                    1|       3|      3|       0|    1|         1527.6|  2022-08-23|  2022-08-30|218.22857142857143| 72.74285714285715|   72.74285714285715|                            6|\n|             website|               duplo|     535|   1568018|            Portugal|     Registado|   2523|             website|2022-08-13 23:37:...|         1|                    1|       2|      2|       0|    0|          108.0|  2022-09-03|  2022-09-04|             108.0|              54.0|                54.0|                           21|\n|        mr main rate|      duplo standard|     311|   1568007|      Estados Unidos|  NãoRegistado|   1407|       mr  main rate|2022-08-13 22:57:...|         1|                    1|       2|      2|       0|    0|           83.3|  2022-09-26|  2022-09-27|              83.3|             41.65|               41.65|                           44|\n|             website|                  t1|     482|   1566071|            Portugal|     Registado|   2285|web best availabl...|2022-08-10 20:58:...|         1|                    1|       2|      2|       0|    0|          209.0|  2022-08-14|  2022-08-15|             209.0|             104.5|               104.5|                            4|\n|              normal|            standard|     319|   1565777|            Portugal|     Registado|   2264|           normal bb|2022-08-10 14:13:...|         2|                    1|       1|      1|       0|    0|          118.0|  2022-09-28|  2022-09-30|              59.0|              59.0|                59.0|                           49|\n|        mr main rate|      duplo standard|     310|   1549543|            Portugal|      Pendente|   1395|       mr  main rate|2022-07-23 23:12:...|         1|                    1|       2|      2|       0|    0|          57.33|  2022-07-24|  2022-07-25|             57.33|            28.665|              28.665|                            1|\n|      non-refundable|      duplo standard|     310|   1549301|            Portugal|    Modificada|   1395|                  nr|2022-07-23 16:15:...|         1|                    1|       2|      2|       0|    0|         55.575|  2022-07-25|  2022-07-26|            55.575|           27.7875|             27.7875|                            2|\n|              normal|               other|     273|   1547872|      Estados Unidos|     Registado|   1235|              normal|2022-07-21 12:35:...|         2|                    1|       2|      2|       0|    0|          400.0|  2022-07-23|  2022-07-25|             200.0|             100.0|               100.0|                            2|\n|      non-refundable|            superior|     310|   1541578|               Suiça|     Cancelado|   1673|                  nr|2022-07-12 22:27:...|         3|                    1|       2|      2|       0|    0|          199.5|  2022-07-22|  2022-07-25|              66.5|             33.25|               33.25|                           10|\n|      non-refundable|           executivo|     319|   1536466|             Espanha|     Cancelado|   1415|   no reembolsvel bb|2022-07-06 07:49:...|         3|                    1|       1|      1|       0|    0|          184.5|  2022-07-11|  2022-07-14|              61.5|              61.5|                61.5|                            5|\n|      non-refundable|            superior|     309|   1535548|              França|  NãoRegistado|   2254|     superior ro nrf|2022-07-04 21:29:...|         9|                    1|       2|      2|       0|    0|          522.0|  2022-07-04|  2022-07-13|              58.0|              29.0|                29.0|                            0|\n|      non-refundable|            superior|     310|   1527910|            Portugal|    Modificada|   1674|                 nrf|2022-06-24 11:30:...|         1|                    1|       2|      2|       0|    0|           68.0|  2022-06-25|  2022-06-26|              68.0|              34.0|                34.0|                            1|\n|              normal|    clssico standard|     443|   1527679|            Portugal|     Registado|   2061|              normal|2022-06-23 22:16:...|         1|                    1|       2|      2|       0|    0|          193.0|  2022-06-26|  2022-06-27|             193.0|              96.5|                96.5|                            3|\n|                 bar|                  t1|     539|   1526350|            Portugal|     Cancelado|   2545|                 bar|2022-06-22 09:18:...|         2|                    1|       1|      1|       0|    0|            0.0|  2022-09-02|  2022-09-04|               0.0|               0.0|                 0.0|                           72|\n|                 bar|               suite|     358|   1524685|              França|     Registado|   1767|                 bar|2022-06-20 08:35:...|         2|                    1|       1|      1|       0|    0|          456.0|  2022-06-21|  2022-06-23|             228.0|             228.0|               228.0|                            1|\n|          meia penso|       twin standard|     426|   1520698|            Portugal|     Registado|   1990|          meia penso|2022-06-14 19:16:...|         4|                    1|       2|      2|       0|    0|          560.0|  2022-08-15|  2022-08-19|             140.0|              70.0|                70.0|                           62|\n|         tarifa site|            familiar|     304|   1518363|      Estados Unidos|     Registado|   1405|         tarifa site|2022-06-12 02:21:...|         1|                    1|       4|      4|       0|    0|         134.32|  2022-08-20|  2022-08-21|            134.32|             33.58|               33.58|                           69|\n|                 bar|      duplo standard|     539|   1516581|            Portugal|     Registado|   2542|                 bar|2022-06-09 12:22:...|         1|                    1|       1|      1|       0|    0|           60.0|  2022-06-09|  2022-06-10|              60.0|              60.0|                60.0|                            0|\n|                 bar|                twin|     349|   1514831|              Itália|    Modificada|   1551|                 bar|2022-06-07 11:16:...|         1|                    1|       1|      1|       0|    0|           79.0|  2022-07-17|  2022-07-18|              79.0|              79.0|                79.0|                           40|\n|      non-refundable|            superior|     310|   1514333|            Portugal|      Pendente|   1674|                 nrf|2022-06-06 18:25:...|         1|                    1|       2|      2|       0|    0|           68.0|  2022-06-06|  2022-06-07|              68.0|              34.0|                34.0|                            0|\n|                 bar|              studio|     445|   1513541|             Holanda|    Modificada|   2080|        bar 2 noites|2022-06-05 20:13:...|         7|                    1|       2|      2|       0|    0|         1750.0|  2022-06-16|  2022-06-23|             250.0|             125.0|               125.0|                           11|\n|                 bar|              deluxe|     445|   1511421|             Espanha|     Registado|   2140|        bar 2 noites|2022-06-02 17:54:...|         2|                    1|       2|      2|       0|    0|          560.0|  2022-08-05|  2022-08-07|             280.0|             140.0|               140.0|                           64|\n|                 bar|             terrace|     445|   1511421|             Espanha|     Registado|   2139|        bar 2 noites|2022-06-02 17:54:...|         2|                    1|       1|      1|       0|    0|          540.0|  2022-08-05|  2022-08-07|             270.0|             270.0|               270.0|                           64|\n|                 bar|              deluxe|     445|   1511250|         Reino Unido|     Registado|   2140|        bar 2 noites|2022-06-02 14:49:...|         5|                    1|       2|      2|       0|    0|         1200.0|  2022-06-06|  2022-06-11|             240.0|             120.0|               120.0|                            4|\n|            duplo bb|      duplo standard|     311|   1505396|              França|     Registado|   1407|            duplo bb|2022-05-26 12:03:...|         1|                    1|       2|      2|       0|    0|           99.0|  2022-07-24|  2022-07-25|              99.0|              49.5|                49.5|                           59|\n|              normal|                viii|     313|   1501480|            Alemanha|     Registado|   1379|              normal|2022-05-21 11:27:...|         7|                    1|       2|      2|       0|    1|         1960.0|  2022-09-02|  2022-09-09|             280.0|             140.0|               140.0|                          104|\n|                  7n|    onebed apartment|     285|   1501250|            Portugal|     Registado|   1290|                  7n|2022-05-20 21:06:...|         8|                    1|       2|      2|       0|    0|          560.0|  2022-08-30|  2022-09-07|              70.0|              35.0|                35.0|                          102|\n|                 bar|               other|     504|   1501192|         Reino Unido|     Registado|   2374|                 bar|2022-05-20 19:29:...|         1|                    1|       1|      1|       0|    0|        94.4775|  2022-05-24|  2022-05-25|           94.4775|           94.4775|             94.4775|                            4|\n|       dbs room only|            superior|     311|   1499898|             Noruega|     Registado|   2034|       dbs room only|2022-05-19 08:47:...|         1|                    1|       2|      2|       0|    0|           79.0|  2022-05-24|  2022-05-25|              79.0|              39.5|                39.5|                            5|\n|              normal|       duplo confort|     179|   1495430|         Reino Unido|     Registado|    630|         tarifa base|2022-05-13 14:21:...|         2|                    1|       2|      2|       0|    0|          291.1|  2022-07-05|  2022-07-07|            145.55|            72.775|              72.775|                           53|\n|               other|            standard|     259|   1493072|            Portugal|     Registado|   1103|pacote romnticoro...|2022-05-10 19:14:...|         2|                    1|       2|      2|       0|    0|          270.0|  2022-06-10|  2022-06-12|             135.0|              67.5|                67.5|                           31|\n|      non-refundable| duplo cama de casal|     478|   1488772|            Portugal|     Registado|   2231|      no reembolsvel|2022-05-05 12:41:...|         1|                    1|       2|      2|       0|    0|           65.0|  2022-05-07|  2022-05-08|              65.0|              32.5|                32.5|                            2|\n|              normal|              studio|     395|   1486103|              França|     Registado|   1829|            standard|2022-05-02 09:31:...|         1|                    1|       1|      1|       0|    0|          110.0|  2022-05-06|  2022-05-07|             110.0|             110.0|               110.0|                            4|\n|             website|               duplo|      54|   1485749|            Portugal|      Pendente|   1823|bar  melhor preo ...|2022-05-01 18:07:...|         1|                    1|       2|      2|       0|    0|           75.0|  2022-05-07|  2022-05-08|              75.0|              37.5|                37.5|                            6|\n|            duplo bb|      duplo standard|     311|   1485140|      Estados Unidos|     Registado|   1407|            duplo bb|2022-04-30 20:07:...|         1|                    1|       2|      2|       0|    0|           99.0|  2022-08-18|  2022-08-19|              99.0|              49.5|                49.5|                          110|\n|      reembolsvel ap|              triplo|     322|   1479858|             Espanha|     Cancelado|   2284|      reembolsvel ap|2022-04-23 10:03:...|         7|                    1|       3|      3|       0|    0|          665.0|  2022-08-01|  2022-08-08|              95.0|31.666666666666668|  31.666666666666668|                          100|\n|      non-refundable|      duplo standard|     311|   1476462|               Suiça|  NãoRegistado|   1407|           db bb nrf|2022-04-18 14:25:...|         1|                    1|       2|      2|       0|    0|           88.0|  2022-06-10|  2022-06-11|              88.0|              44.0|                44.0|                           53|\n|              normal|duplo vista mar l...|     444|   1473257|            Portugal|     Registado|   2074|              normal|2022-04-12 20:44:...|         2|                    1|       2|      2|       0|    0|          220.0|  2022-04-23|  2022-04-25|             110.0|              55.0|                55.0|                           11|\n|      non-refundable|duplot duplo com ...|     311|   1473003|              França|     Registado|   1946|  dbt room only  nrf|2022-04-12 15:22:...|         1|                    1|       3|      3|       0|    0|           98.0|  2022-04-26|  2022-04-27|              98.0|32.666666666666664|  32.666666666666664|                           14|\n|      reserva direta|                  t1|     453|   1472887|      Estados Unidos|     Registado|   2117|      reserva direta|2022-04-12 12:54:...|         4|                    1|       1|      1|       0|    0|          460.0|  2022-05-31|  2022-06-04|             115.0|             115.0|               115.0|                           49|\n|            duplo bb|      duplo standard|     311|   1472719|            Alemanha|  NãoRegistado|   1407|            duplo bb|2022-04-12 08:48:...|         2|                    1|       2|      2|       0|    0|          178.0|  2022-05-09|  2022-05-11|              89.0|              44.5|                44.5|                           27|\n|             website|            familiar|     535|   1471034|            Portugal|     Registado|   2526|             website|2022-04-09 17:55:...|         1|                    1|       2|      2|       2|    0|           81.0|  2022-04-13|  2022-04-14|              81.0|              40.5|                40.5|                            4|\n|                 bar|                  t1|     539|   1469066|            Portugal|     Registado|   2545|                 bar|2022-04-07 13:37:...|         1|                    1|       1|      1|       0|    0|          160.0|  2022-04-09|  2022-04-10|             160.0|             160.0|               160.0|                            2|\n|             website|                twin|     535|   1464685|            Portugal|      Pendente|   2524|             website|2022-04-02 13:25:...|         1|                    1|       2|      2|       0|    0|           72.0|  2022-04-02|  2022-04-03|              72.0|              36.0|                36.0|                            0|\n|             website|      duplo standard|     556|   1463318|            Portugal|      Pendente|   2831|web best availabl...|2022-03-31 16:11:...|         1|                    1|       2|      2|       0|    0|          52.25|  2022-03-31|  2022-04-01|             52.25|            26.125|              26.125|                            0|\n|                  hb|       duplo terrace|      49|   1461769|            Alemanha|     Registado|    211|                  hb|2022-03-29 17:30:...|         3|                    1|       2|      2|       0|    0|          780.0|  2022-05-27|  2022-05-30|             260.0|             130.0|               130.0|                           59|\n|              normal|                  t1|     283|   1461615|            Portugal|     Registado|   1242|            standard|2022-03-29 14:06:...|         3|                    1|       1|      1|       0|    0|          195.0|  2022-05-23|  2022-05-26|              65.0|              65.0|                65.0|                           55|\n|      non-refundable|duplot duplo com ...|     311|   1461579|              França|     Registado|   1946|  dbt room only  nrf|2022-03-29 13:23:...|         1|                    1|       3|      3|       0|    0|           88.0|  2022-03-30|  2022-03-31|              88.0|29.333333333333332|  29.333333333333332|                            1|\n|               promo|      duplo standard|     311|   1460405|              França|     Registado|   1407|               promo|2022-03-27 21:01:...|         1|                    2|       2|      4|       0|    0|           89.1|  2022-05-06|  2022-05-07|              89.1|            22.275|               44.55|                           40|\n|clientes fidelizados|               duplo|     349|   1460219|            Portugal|     Registado|   1552|clientes fidelizados|2022-03-27 18:33:...|         1|                    1|       1|      1|       0|    0|           39.0|  2022-03-31|  2022-04-01|              39.0|              39.0|                39.0|                            4|\n|              normal|s v vi vii vista mar|     313|   1457000|            Portugal|     Registado|   1382|              normal|2022-03-22 20:42:...|         6|                    1|       2|      2|       0|    0|         1320.0|  2022-07-05|  2022-07-11|             220.0|             110.0|               110.0|                          105|\n|                 bar|     alojamento mata|     537|   1455247|            Portugal|  NãoRegistado|   2723|                 bar|2022-03-20 16:43:...|         1|                    1|       2|      2|       0|    0|          140.0|  2022-04-09|  2022-04-10|             140.0|              70.0|                70.0|                           20|\n|      non-refundable|            superior|     311|   1455047|          Luxemburgo|     Registado|   2034|          dbs bb nrf|2022-03-20 12:14:...|         1|                    1|       2|      2|       0|    0|           83.0|  2022-03-27|  2022-03-28|              83.0|              41.5|                41.5|                            7|\n|                 bar|               suite|     358|   1454031|              Canadá|     Registado|   1769|                 bar|2022-03-18 13:33:...|         3|                    1|       2|      2|       0|    0|          600.0|  2022-03-28|  2022-03-31|             200.0|             100.0|               100.0|                           10|\n|      non-refundable|              triplo|     478|   1449969|             Espanha|     Registado|   2233|      no reembolsvel|2022-03-11 09:40:...|         1|                    1|       3|      3|       0|    0|           65.0|  2022-03-25|  2022-03-26|              65.0|21.666666666666668|  21.666666666666668|                           14|\n|      non-refundable|      duplo standard|     309|   1448186|            Portugal|     Registado|   1372|           db bb nrf|2022-03-07 22:45:...|         1|                    1|       1|      1|       0|    0|          45.45|  2022-03-07|  2022-03-08|             45.45|             45.45|               45.45|                            0|\n|              normal|            familiar|     238|   1447588|              Brasil|     Registado|    936|      estadia normal|2022-03-06 23:10:...|         4|                    1|       2|      2|       0|    0|          496.0|  2022-05-05|  2022-05-09|             124.0|              62.0|                62.0|                           60|\n|                twin|       twin standard|     311|   1446305|         Reino Unido|  NãoRegistado|   1429|               tw bb|2022-03-04 12:46:...|         1|                    1|       2|      2|       0|    0|           89.0|  2022-04-06|  2022-04-07|              89.0|              44.5|                44.5|                           33|\n|                  4n|    onebed apartment|     285|   1446027|            Portugal|     Registado|   1290|                  4n|2022-03-03 20:04:...|         6|                    1|       2|      2|       0|    0|            0.0|  2022-03-05|  2022-03-11|               0.0|               0.0|                 0.0|                            2|\n|               promo|       twin standard|     311|   1444347|            Portugal|     Registado|   1429|               promo|2022-03-01 07:49:...|         1|                    1|       2|      2|       0|    0|           62.1|  2022-07-01|  2022-07-02|              62.1|             31.05|               31.05|                          122|\n|              normal|              studio|     560|   1442732|             Bélgica|     Registado|   2865|            standard|2022-02-25 20:43:...|         3|                    1|       2|      2|       0|    0|          200.0|  2022-05-19|  2022-05-22| 66.66666666666667|33.333333333333336|  33.333333333333336|                           83|\n|               promo|       twin standard|     310|   1441278|            Portugal|     Registado|   1424|               promo|2022-02-23 09:22:...|         1|                    1|       2|      2|       0|    0|           44.0|  2022-02-23|  2022-02-24|              44.0|              22.0|                22.0|                            0|\n|                 bar|            standard|      20|   1436512|            Portugal|      Pendente|     81|                 bar|2022-02-15 02:45:...|         1|                    1|       2|      2|       0|    0|           51.5|  2022-02-25|  2022-02-26|              51.5|             25.75|               25.75|                           10|\n|             website|      duplo standard|     556|   1436004|            Portugal|     Registado|   2831|web best availabl...|2022-02-14 14:37:...|         3|                    1|       2|      2|       0|    0|         261.25|  2022-02-18|  2022-02-21| 87.08333333333333|43.541666666666664|  43.541666666666664|                            4|\n|                 bar|      duplo standard|     426|   1433097|      Estados Unidos|     Registado|   1995|                 bar|2022-02-09 01:30:...|         4|                    2|       2|      4|       0|    0|          720.0|  2022-08-15|  2022-08-19|             180.0|              45.0|                90.0|                          187|\n|      non-refundable|      duplo standard|     311|   1432640|              Itália|     Registado|   1407|           db bb nrf|2022-02-08 11:36:...|         1|                    1|       2|      2|       0|    0|           78.0|  2022-02-10|  2022-02-11|              78.0|              39.0|                39.0|                            2|\n|      non-refundable|      duplo standard|     309|   1431000|            Portugal|     Cancelado|   1372|           db ro nrf|2022-02-04 18:56:...|         1|                    1|       2|      2|       0|    0|           38.7|  2022-02-05|  2022-02-06|              38.7|             19.35|               19.35|                            1|\n|              normal|               duplo|     501|   1430171|      Estados Unidos|     Registado|   2396|              normal|2022-02-03 01:02:...|         1|                    1|       2|      2|       0|    0|          102.0|  2022-05-08|  2022-05-09|             102.0|              51.0|                51.0|                           94|\n|      non-refundable|      duplo standard|     311|   1429699|            Portugal|  NãoRegistado|   1407|    db room only nrf|2022-02-02 07:50:...|         1|                    1|       1|      1|       0|    0|           63.0|  2022-02-02|  2022-02-03|              63.0|              63.0|                63.0|                            0|\n|                 bar|           duplotwin|     185|   1428610|               Suiça|     Registado|    660|                 bar|2022-01-30 20:00:...|         1|                    1|       2|      2|       0|    0|          139.0|  2022-07-30|  2022-07-31|             139.0|              69.5|                69.5|                          181|\n|                 bar|              studio|     445|   1425771|      Estados Unidos|     Registado|   2080|        bar 2 noites|2022-01-24 02:34:...|         3|                    1|       2|      2|       0|    0|          750.0|  2022-09-22|  2022-09-25|             250.0|             125.0|               125.0|                          241|\n|             website|               suite|     535|   1422132|            Portugal|     Registado|   2527|             website|2022-01-13 17:26:...|         1|                    1|       2|      2|       0|    0|           81.0|  2022-01-21|  2022-01-22|              81.0|              40.5|                40.5|                            8|\n|        main rate bb|      duplo standard|     311|   1720152|              Taiwan|     Registado|   1407|        main rate bb|2023-04-14 09:58:...|         1|                    1|       1|      1|       0|    0|         82.215|  2023-05-05|  2023-05-06|            82.215|            82.215|              82.215|                           21|\n|                 bar|                twin|     526|   1719160|      Estados Unidos|     Registado|   2770|                 bar|2023-04-12 21:41:...|         3|                    1|       2|      2|       0|    0|          285.0|  2023-06-02|  2023-06-05|              95.0|              47.5|                47.5|                           51|\n|        mr main rate|       twin standard|     310|   1718608|             Espanha|     Registado|   1424|       mr  main rate|2023-04-12 11:38:...|         1|                    1|       2|      2|       0|    0|        59.8975|  2023-04-29|  2023-04-30|           59.8975|          29.94875|            29.94875|                           17|\n|        mr main rate|            superior|     310|   1717469|            Portugal|    Modificada|   1673|       mr  main rate|2023-04-11 00:15:...|         1|                    2|       2|      4|       0|    0|        101.365|  2023-04-14|  2023-04-15|           101.365|          25.34125|             50.6825|                            3|\n|      non-refundable|                  t1|     482|   1713014|            Portugal|     Registado|   2285|web nonrefundable...|2023-04-04 15:05:...|         3|                    1|       4|      4|       0|    0| 198.7799999999|  2023-04-10|  2023-04-13| 66.25999999996667|16.564999999991667|  16.564999999991667|                            6|\n|        mr main rate|      duplo standard|     310|   1712703|             Espanha|     Registado|   1395|       mr  main rate|2023-04-04 07:54:...|         2|                    3|       1|      3|       0|    0|          285.0|  2023-04-10|  2023-04-12|             142.5|              47.5|               142.5|                            6|\n|              normal|twin vista mar pa...|     444|   1710558|            Portugal|     Registado|   2386|              normal|2023-04-01 17:25:...|         2|                    1|       1|      1|       1|    0|          310.0|  2023-04-07|  2023-04-09|             155.0|             155.0|               155.0|                            6|\n|reembolsvel suple...|              triplo|     322|   1709282|             Espanha|     Cancelado|   2284|reembolsvel suple...|2023-03-30 19:02:...|         5|                    1|       2|      2|       0|    0|          610.0|  2023-04-09|  2023-04-14|             122.0|              61.0|                61.0|                           10|\n|        mr main rate|            superior|     311|   1706038|              Canadá|     Registado|   2034|       mr  main rate|2023-03-26 17:18:...|         1|                    1|       2|      2|       0|    0|           85.5|  2023-05-23|  2023-05-24|              85.5|             42.75|               42.75|                           58|\n|                 bar|twin duplo vista ...|     413|   1704454|            Portugal|     Registado|   1913|                 bar|2023-03-24 10:55:...|         2|                    1|       2|      2|       0|    0|          240.0|  2023-04-08|  2023-04-10|             120.0|              60.0|                60.0|                           15|\n|                 bar|                  t2|     539|   1698117|            Portugal|     Registado|   2546|                 bar|2023-03-15 14:54:...|         2|                    1|       1|      1|       0|    0|          340.0|  2023-07-21|  2023-07-23|             170.0|             170.0|               170.0|                          128|\n|        main rate bb|      duplo standard|     310|   1696911|            Portugal|     Registado|   1397|        main rate bb|2023-03-13 20:41:...|         1|                    1|       2|      2|       0|    0|          97.47|  2023-05-20|  2023-05-21|             97.47|            48.735|              48.735|                           68|\n|                 bar|      duplo standard|     539|   1696691|            Portugal|     Registado|   2542|                 bar|2023-03-13 15:42:...|         5|                    1|       1|      1|       0|    0|          550.0|  2023-08-01|  2023-08-06|             110.0|             110.0|               110.0|                          141|\n|              normal|s i ii iii iv ter...|     313|   1694782|              França|     Registado|   1378|              normal|2023-03-10 18:53:...|         2|                    1|       2|      2|       0|    0|          560.0|  2023-04-07|  2023-04-09|             280.0|             140.0|               140.0|                           28|\n|             website|            familiar|     535|   1694308|            Portugal|     Registado|   2526|             website|2023-03-09 23:21:...|         1|                    1|       2|      2|       0|    1|           85.5|  2023-03-10|  2023-03-11|              85.5|             42.75|               42.75|                            1|\n|             website|       twin standard|     556|   1691090|            Portugal|     Cancelado|   2832|web best availabl...|2023-03-05 17:29:...|         1|                    1|       2|      2|       0|    0|           68.0|  2023-05-13|  2023-05-14|              68.0|              34.0|                34.0|                           69|\n|         tarifa site|            superior|     304|   1689958|      Estados Unidos|     Registado|   1909|         tarifa site|2023-03-03 19:28:...|         2|                    1|       2|      2|       0|    0|         163.76|  2023-06-02|  2023-06-04|             81.88|             40.94|               40.94|                           91|\n|                 bar|               duplo|     526|   1689885|      Estados Unidos|     Registado|   2757|                 bar|2023-03-03 17:57:...|         7|                    1|       2|      2|       0|    0|          665.0|  2023-08-04|  2023-08-11|              95.0|              47.5|                47.5|                          154|\n|             website|  duplo with balcony|     328|   1688290|               Suiça|     Registado|   1454|             website|2023-03-01 14:32:...|         4|                    1|       2|      2|       0|    0|         273.94|  2023-03-10|  2023-03-14|            68.485|           34.2425|             34.2425|                            9|\n|                 bar|casal com wc priv...|     492|   1688272|            Portugal|     Cancelado|   2333|                 bar|2023-03-01 14:10:...|         4|                    1|       1|      1|       0|    0|          180.0|  2023-04-17|  2023-04-21|              45.0|              45.0|                45.0|                           47|\n|      non-refundable|               suite|     259|   1684253|             Holanda|    Modificada|   1104|non refundable  s...|2023-02-23 20:53:...|         1|                    2|       2|      4|       0|    0|          333.0|  2023-06-25|  2023-06-26|             333.0|             83.25|               166.5|                          122|\n|            standart|       duplo ou twin|     511|   1682487|              Canadá|     Registado|   2394|standart rate  qu...|2023-02-21 01:00:...|         3|                    1|       2|      2|       0|    0|          285.0|  2023-06-25|  2023-06-28|              95.0|              47.5|                47.5|                          124|\n|        mr main rate|      duplo standard|     309|   1682250|            Portugal|    Modificada|   1372|       mr  main rate|2023-02-20 18:27:...|         1|                    1|       2|      2|       0|    0|          42.75|  2023-02-25|  2023-02-26|             42.75|            21.375|              21.375|                            5|\n|           room only|       duplo confort|     179|   1680641|             Ucránia|     Registado|    630|           room only|2023-02-18 02:44:...|         3|                    1|       1|      1|       0|    0|        246.186|  2023-02-18|  2023-02-21|            82.062|            82.062|              82.062|                            0|\n|              normal|          individual|     314|   1680605|            Portugal|     Registado|   1428|            standard|2023-02-17 23:33:...|         2|                    1|       1|      1|       0|    0|          120.0|  2023-02-19|  2023-02-21|              60.0|              60.0|                60.0|                            2|"
     },
     {
      "type": "HTML",
      "data": "<div class=\"result-alert alert-warning\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><strong>Output is truncated</strong> to 102400 bytes. Learn more about <strong>ZEPPELIN_INTERPRETER_OUTPUT_LIMIT</strong></div>"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "count",
          "tpe": {
           "presentableName": "long"
          },
          "nullable": false
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "//Agrupamento por rate_plan\nval dfRatePlan = result_after_cleaning.select(\"rate_plan\")\n\n// Agrupar os dados pelo rateplan e contar o número de ocorrências\nval dfRatePlanCounts = dfRatePlan.groupBy(\"rate_plan\").count()\nval order = dfRatePlanCounts.orderBy($\"count\".desc)\n//Antes do tratamento tinhamos 234 rate_Plan Diferentes\nprintln (order.count())\nresult_after_cleaning.show()\n\n// Mostrar o resultado\norder.show(10000)",
   "id": "",
   "dateCreated": "2023-05-16 17:19:20.597",
   "config": {},
   "dateStarted": "2023-06-07 22:45:23.546",
   "dateUpdated": "2023-06-07 22:45:31.403",
   "dateFinished": "2023-06-07 22:45:31.402",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "224\n+--------------------+---------------+--------+----------+--------------+--------------+-------+--------------------+--------------------+----------+---------------------+--------+-------+--------+-----+-----------+------------+------------+------------------+------------------+--------------------+-----------------------------+\n|rate_plan_normalized|    tipo_quarto|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|           rate_plan|        data_reserva|num_noites|Quantidade de quartos|ocupacao|adultos|criancas|bebes|preco_euros|data_chegada|data_partida|       preco_noite|preco_noite_adulto|preco_noite_ocupacao|dif_data_chegada_data_reserva|\n+--------------------+---------------+--------+----------+--------------+--------------+-------+--------------------+--------------------+----------+---------------------+--------+-------+--------+-----+-----------+------------+------------+------------------+------------------+--------------------+-----------------------------+\n|        main rate bb|       superior|     310|   1722047|      Portugal|     Registado|   2870|        main rate bb|2023-04-16 21:55:...|         1|                    1|       2|      2|       0|    0|   100.4435|  2023-04-30|  2023-05-01|          100.4435|          50.22175|            50.22175|                           14|\n|       semi flexivel|       superior|     311|   1720340|    Luxemburgo|     Registado|   2034|       semi flexivel|2023-04-14 14:31:...|         1|                    1|       2|      2|       0|    0|      90.45|  2023-06-01|  2023-06-02|             90.45|            45.225|              45.225|                           48|\n|                 bar|    vista pinho|      44|   1718932|Estados Unidos|     Cancelado|     85|                 bar|2023-04-12 17:31:...|         1|                    1|       2|      2|       0|    0|      125.0|  2023-06-15|  2023-06-16|             125.0|              62.5|                62.5|                           64|\n|             website|          duplo|     335|   1717009|      Portugal|     Cancelado|   1488|baronline  min 2 ...|2023-04-10 14:38:...|         2|                    1|       2|      2|       0|    0|      130.0|  2023-04-10|  2023-04-12|              65.0|              32.5|                32.5|                            0|\n|             website| duplo standard|     556|   1716447|      Portugal|     Registado|   2831|web best availabl...|2023-04-09 18:38:...|         1|                    4|       2|      8|       0|    0|      272.0|  2023-06-03|  2023-06-04|             272.0|              34.0|               136.0|                           55|\n|        main rate bb|       superior|     310|   1716190|      Portugal|      Pendente|   1673|        main rate bb|2023-04-09 11:20:...|         1|                    1|       1|      1|       0|    0|   59.43675|  2023-04-15|  2023-04-16|          59.43675|          59.43675|            59.43675|                            6|\n|             website|             t1|     482|   1713319|       Irlanda|     Registado|   2285|web best availabl...|2023-04-04 21:08:...|         7|                    1|       3|      3|       0|    0|    1220.75|  2023-07-18|  2023-07-25|174.39285714285714| 58.13095238095238|   58.13095238095238|                          105|\n|               other|     eco garden|     514|   1713213|     Argentina|     Cancelado|   2425|         bearpride23|2023-04-04 19:10:...|         5|                    1|       1|      1|       0|    0|      725.0|  2023-05-30|  2023-06-04|             145.0|             145.0|               145.0|                           56|\n|             website|triplo standard|     556|   1710971|       Espanha|     Registado|   2833|web best availabl...|2023-04-02 11:30:...|         2|                    1|       3|      3|       0|    0|      166.6|  2023-04-05|  2023-04-07|              83.3|27.766666666666666|  27.766666666666666|                            3|\n|               other|          suite|     426|   1704701|      Portugal|     Registado|   1992|      penso completa|2023-03-24 17:02:...|         5|                    1|       2|      2|       1|    0|     1243.0|  2023-04-02|  2023-04-07|             248.6|             124.3|               124.3|                            9|\n|              normal|         studio|     395|   1704561|      Alemanha|     Cancelado|   1829|            standard|2023-03-24 13:05:...|         2|                    1|       2|      2|       0|    0|      190.0|  2023-03-25|  2023-03-27|              95.0|              47.5|                47.5|                            1|\n|              direct|  duplo ou twin|     511|   1704056|       Espanha|     Registado|   2394|smart deal  direc...|2023-03-23 18:47:...|         4|                    1|       1|      1|       0|    0|      279.0|  2023-03-29|  2023-04-02|             69.75|             69.75|               69.75|                            6|\n|      non-refundable|  twin standard|     366|   1694509|      Portugal|    Modificada|   1648|      non refundable|2023-03-10 12:07:...|         1|                    1|       2|      2|       0|    0|       75.6|  2023-03-11|  2023-03-12|              75.6|              37.8|                37.8|                            1|\n|             website|       superior|     328|   1692675|       Noruega|     Registado|   1456|             website|2023-03-07 16:48:...|         2|                    1|       2|      2|       0|    0|     153.19|  2023-04-06|  2023-04-08|            76.595|           38.2975|             38.2975|                           30|\n|        mr main rate| duplo standard|     310|   1691045|         Suiça|     Registado|   1395|       mr  main rate|2023-03-05 16:45:...|         3|                    1|       2|      2|       0|    0|    138.225|  2023-03-06|  2023-03-09|46.074999999999996|23.037499999999998|  23.037499999999998|                            1|\n|      non-refundable|   twin confort|     179|   1690589|        Canadá|     Registado|    631|  no reembolsable 13|2023-03-04 20:29:...|         3|                    1|       2|      2|       0|    0|    502.686|  2023-05-27|  2023-05-30|167.56199999999998| 83.78099999999999|   83.78099999999999|                           84|\n|            standart|duplo economico|     511|   1689186|      Portugal|     Registado|   2867|standart rate  qu...|2023-03-02 18:07:...|         3|                    1|       2|      2|       0|    0|      495.0|  2023-08-18|  2023-08-21|             165.0|              82.5|                82.5|                          169|\n|        main rate bb| duplo standard|     309|   1687493|      Portugal|    Modificada|   1372|        main rate bb|2023-02-28 12:41:...|         2|                    1|       2|      2|       0|    0|    127.167|  2023-04-21|  2023-04-23|           63.5835|          31.79175|            31.79175|                           52|\n|        mr main rate| duplo standard|     309|   1687154|       Espanha|    Modificada|   1372|       mr  main rate|2023-02-27 22:27:...|         1|                    1|       2|      2|       0|    0|   34.55625|  2023-03-02|  2023-03-03|          34.55625|         17.278125|           17.278125|                            3|\n|      non-refundable|  twin standard|     366|   1686287|      Portugal|     Registado|   1648|      non refundable|2023-02-26 21:25:...|         1|                    1|       2|      2|       1|    0|       75.6|  2023-03-04|  2023-03-05|              75.6|              37.8|                37.8|                            6|\n+--------------------+---------------+--------+----------+--------------+--------------+-------+--------------------+--------------------+----------+---------------------+--------+-------+--------+-----+-----------+------------+------------+------------------+------------------+--------------------+-----------------------------+\nonly showing top 20 rows\n\n+--------------------+-----+\n|           rate_plan|count|\n+--------------------+-----+\n|                 bar| 3480|\n|       mr  main rate| 2536|\n|              normal| 2414|\n|web best availabl...| 1706|\n|             website| 1670|\n|        main rate bb| 1056|\n|            standard|  557|\n|web best availabl...|  552|\n|      no reembolsvel|  500|\n|web nonrefundable...|  440|\n|  no reembolsable 13|  401|\n|                  nr|  390|\n|         tarifa site|  380|\n|               promo|  334|\n|                 nrf|  334|\n|    db room only nrf|  272|\n|           normal bb|  231|\n|         tarifa base|  228|\n|       no refundable|  221|\n|           normal ro|  203|\n|      non refundable|  200|\n|      estadia normal|  200|\n|tarifa no reembol...|  195|\n|     nonrefundable 5|  172|\n|         normal  bar|  167|\n|melhor preo garan...|  167|\n|        db room only|  167|\n|                  4n|  165|\n|               nr bb|  148|\n|            duplo bb|  148|\n|              bar bb|  146|\n|              bar ro|  140|\n|      reserva direta|  140|\n| early booking 30 nr|  134|\n|           room only|  132|\n|        bar 2 noites|  126|\n|reembolsvel suple...|  116|\n|        epoca normal|  116|\n|           db bb nrf|  108|\n|   no reembolsvel ro|  107|\n|web nrf  non refu...|  106|\n|          meia penso|  105|\n|  reserva antecipada|   99|\n|non refundable  s...|   96|\n|chocolate experience|   93|\n|standart rate  qu...|   93|\n|              nrf bb|   90|\n|             bar apa|   89|\n|           db ro nrf|   87|\n|         basewebsite|   79|\n|no reembolsvel su...|   77|\n| nrf  non refundable|   72|\n|           bar  c pa|   68|\n|   no reembolsvel ap|   67|\n|epoca alta  jul a...|   66|\n|     oferta especial|   66|\n|clientes fidelizados|   65|\n|                  7n|   65|\n|tarifa reembolsve...|   64|\n|standart rate  qu...|   63|\n|    semi flexivel bb|   59|\n|     superior ro nrf|   57|\n|tarifa sem pequen...|   54|\n|non refundable  d...|   54|\n|bar  melhor preo ...|   53|\n|    tw room only nrf|   52|\n|   no reembolsvel bb|   52|\n|    no refundable bb|   50|\n|      reembolsvel ap|   49|\n|           bar  s pa|   48|\n|               tw bb|   46|\n| best available rate|   46|\n|bar no refundable...|   44|\n|  tarifa normal  bar|   43|\n|      bar  room only|   43|\n|         preo normal|   42|\n|       semi flexivel|   39|\n|baronline  min 2 ...|   39|\n|        tw room only|   37|\n|          dbs ro nrf|   37|\n|nrf  melhor preo ...|   33|\n|   premium room only|   32|\n|non refundable bo...|   32|\n|               db ro|   32|\n|         twin ro nrf|   31|\n|         bar  normal|   31|\n|tarifa com pequen...|   30|\n|campanha especial...|   30|\n|bar no refundable...|   30|\n|standart rate  ap...|   30|\n|       dbt room only|   28|\n|clg  flexible sin...|   28|\n|       dbs room only|   28|\n|                  hb|   27|\n|promoo  baja de p...|   27|\n|  dbt room only  nrf|   25|\n|       epaltawebsite|   25|\n|           tw bb nrf|   25|\n|        main rate hb|   24|\n|          premium bb|   24|\n|         twin bb nrf|   24|\n|     superior bb nrf|   23|\n|              dbs bb|   23|\n|               db bb|   21|\n|            avionics|   20|\n|           rack rate|   20|\n|         superior bb|   20|\n|    winter promotion|   19|\n|        venda direta|   19|\n|           dia da me|   19|\n|         bearpride23|   17|\n|                 pvp|   16|\n|no reembolsvel  d...|   16|\n|    promoo dia da me|   16|\n|bp1  bar prepayme...|   16|\n|             twin bb|   15|\n|               junho|   15|\n|      penso completa|   15|\n|        min 3 noites|   15|\n|estadia com janta...|   15|\n|         oferta maio|   13|\n|         newyear2023|   13|\n|early booking 30 ...|   13|\n|     bar  meia penso|   13|\n|            19 image|   13|\n|         bar onlines|   13|\n|campanha especial...|   13|\n|        pgt dir s pa|   13|\n| bar  penso completa|   13|\n|  non refundable spa|   12|\n|     desconto 20  20|   12|\n|     desconto 20  10|   12|\n|nonrefundable hig...|   12|\n|             twin ro|   11|\n|         superior ro|   11|\n|                  or|   11|\n|early booking  di...|   10|\n|           baronline|   10|\n|early booking  di...|   10|\n|no reembolsvel  p...|   10|\n|      lastimute egds|    9|\n|          website 20|    9|\n|tarifa  non refun...|    9|\n|          dbs bb nrf|    9|\n|  standard rate s pa|    8|\n|standard ro  non ...|    8|\n|pacote romnticoro...|    8|\n| early booking 30 sf|    8|\n|      tarifa flexvel|    8|\n|room only  non re...|    7|\n|smart deal  direc...|    7|\n|bar  pequeno almo...|    7|\n|                  bb|    7|\n|noreembolsvel sem...|    7|\n|              dbt bb|    7|\n|        pgt dir c pa|    7|\n|      premium ro nrf|    7|\n|standard ro  4 ni...|    6|\n|smart deal   dire...|    6|\n|clg  flexible sin...|    6|\n|     venda direta nr|    6|\n|          non refund|    6|\n|          dbt bb nrf|    6|\n|      premium bb nrf|    6|\n|smart deal  direc...|    5|\n|               nr or|    5|\n| oferta especial out|    5|\n|programa de so va...|    5|\n|              direto|    5|\n|  standard rate c pa|    5|\n|aldeias histricas...|    5|\n|     nrf  meia penso|    5|\n|      super promo t1|    5|\n|            promo 10|    4|\n|    autumm promotion|    4|\n|no reembolsvel mi...|    4|\n|   minimum stay rate|    4|\n|             20 maio|    4|\n|no reembolsvel  d...|    4|\n|alojamento e pequ...|    3|\n|noreembolsvel com...|    3|\n|       early payment|    3|\n|       standard rate|    3|\n|congresso portugu...|    3|\n|            bar alta|    3|\n|      promoo de vero|    3|\n|early booking  di...|    3|\n|            romntico|    3|\n|       golegawebsite|    3|\n|        winter offer|    3|\n|no reembolsvel mi...|    3|\n|      bar full board|    2|\n|         last minute|    2|\n|non refundable  d...|    2|\n|especial dia dos ...|    2|\n|pscoa em famlia 2...|    2|\n|            7 noites|    2|\n|                  fb|    2|\n|programa de fim d...|    2|\n|pscoa com descont...|    2|\n|      reveillon 2023|    2|\n|early booking 30 ...|    2|\n|nao reembolsavel ...|    2|\n|s alojamento nrf ...|    2|\n|        winter promo|    2|\n|     desconto 20  15|    2|\n|   quinzena setembro|    2|\n|super reduc winte...|    1|\n|standard ro  non ...|    1|\n|          pre summer|    1|\n|   last minute offer|    1|\n|         ingeniarius|    1|\n| programa pscoa 2023|    1|\n|promoo mais 7 noites|    1|\n|    easter promotion|    1|\n|   promoo site hotel|    1|\n|        main rate fb|    1|\n|   website fidelizao|    1|\n|aldeias histricos...|    1|\n|      promoo7 noites|    1|\n|                  32|    1|\n|pscoa em famlia 2...|    1|\n|      bar half board|    1|\n|  casa caseiros egds|    1|\n+--------------------+-----+\n\n\u001b[1m\u001b[34mdfRatePlan\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [rate_plan: string]\n\u001b[1m\u001b[34mdfRatePlanCounts\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [rate_plan: string, count: bigint]\n\u001b[1m\u001b[34morder\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [rate_plan: string, count: bigint]\n"
     }
    ]
   }
  }
 ],
 "name": "Zeppelin Notebook",
 "id": "",
 "noteParams": {},
 "noteForms": {},
 "angularObjects": {},
 "config": {
  "isZeppelinNotebookCronEnable": false,
  "looknfeel": "default",
  "personalizedMode": "false"
 },
 "info": {}
}