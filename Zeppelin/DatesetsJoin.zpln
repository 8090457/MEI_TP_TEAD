{
 "paragraphs": [
  {
   "settings": {
    "params": {
     "bdtMeta": {}
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "// FILE #2",
   "id": "",
   "dateCreated": "2023-05-08 15:40:50.806",
   "config": {},
   "dateStarted": "2023-05-23 21:42:07.848",
   "dateUpdated": "2023-05-23 21:42:07.978",
   "dateFinished": "2023-05-23 21:42:07.977",
   "results": {
    "code": "SUCCESS",
    "msg": []
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Quantidade de quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "import org.apache.spark.sql.DataFrame\nimport org.apache.spark.sql.functions._\nimport spark.implicits._\n\nval joinFolder = \"/data/joins\"\nval saveJoins = false\n\ndef saveDataFrame(df: DataFrame, name: String): Unit = {\n    df.coalesce(1) // Print into a single file\n            .write\n            .mode(\"overwrite\")\n            .option(\"delimiter\", \";\")\n            .option(\"header\", true) // Maintain Headers\n            .csv(s\"$joinFolder/$name\") // Write to csv\n}\nval initialCount = spark.sql(\"SELECT DISTINCT * FROM QuartosReservados\")\ninitialCount.show(100)\nprintln(initialCount.count())",
   "id": "",
   "dateCreated": "2023-04-30 19:59:44.804",
   "config": {
    "editorHide": false
   },
   "dateStarted": "2023-05-23 21:42:07.979",
   "dateUpdated": "2023-05-23 21:42:13.908",
   "dateFinished": "2023-05-23 21:42:13.907",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+--------------------+--------+----------+--------------+--------------+-------+--------------------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+------------------+------------------+--------------------+-----------------------------+\n|         tipo_quarto|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|           rate_plan|        data_reserva|num_noites|Quantidade de quartos|ocupacao|adultos|criancas|bebes|   preco_euros|data_chegada|data_partida|       preco_noite|preco_noite_adulto|preco_noite_ocupacao|dif_data_chegada_data_reserva|\n+--------------------+--------+----------+--------------+--------------+-------+--------------------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+------------------+------------------+--------------------+-----------------------------+\n|            familiar|     535|   1694308|      Portugal|     Registado|   2526|             WebSite|2023-03-09 23:21:...|         1|                    1|       2|      2|       0|    1|          85.5|  2023-03-10|  2023-03-11|              85.5|             42.75|               42.75|                            1|\n|            superior|     311|   1579685|        Suécia|     Registado|   2034|        Main Rate BB|2022-08-31 15:02:...|         1|                    1|       2|      2|       0|    0|         107.8|  2022-08-31|  2022-09-01|             107.8|              53.9|                53.9|                            0|\n|                  t1|     482|   1515532|      Portugal|     Registado|   2285|(WEB) Non-refunda...|2022-06-08 07:21:...|         1|                    1|       2|      2|       0|    0|         55.66|  2022-06-08|  2022-06-09|             55.66|             27.83|               27.83|                            0|\n| bed mixed dormitory|     328|   1453439|        Brasil|     Registado|   1451|             WebSite|2022-03-17 12:15:...|         6|                    1|       1|      1|       0|    0|        122.54|  2022-03-31|  2022-04-06|20.423333333333336|20.423333333333336|  20.423333333333336|                           14|\n|        twin premium|     426|   1577089|      Alemanha|     Registado|   1994|        MEIA PENSÃO |2022-08-27 19:13:...|         1|                    1|       2|      2|       0|    0|         136.0|  2022-10-07|  2022-10-08|             136.0|              68.0|                68.0|                           41|\n|                  t2|     539|   1564528|      Portugal|     Cancelado|   2546|                 Bar|2022-08-08 21:24:...|         2|                    1|       1|      1|       0|    0|         220.0|  2022-08-21|  2022-08-23|             110.0|             110.0|               110.0|                           13|\n|                  t1|     482|   1482066|      Portugal|     Cancelado|   2285|(WEB) Non-refunda...|2022-04-26 10:36:...|         1|                    1|       4|      4|       0|    0|         66.26|  2022-05-14|  2022-05-15|             66.26|            16.565|              16.565|                           18|\n|                twin|     314|   1551636|        França|     Registado|   1387|            Standard|2022-07-25 07:28:...|         4|                    1|       2|      2|       0|    0|         360.0|  2022-08-23|  2022-08-27|              90.0|              45.0|                45.0|                           29|\n|      duplo standard|     280|   1672686|      Portugal|     Registado|   2561|CHOCOLATE EXPERIENCE|2023-02-06 15:30:...|         2|                    1|       1|      1|       1|    0|         188.0|  2023-02-18|  2023-02-20|              94.0|              94.0|                94.0|                           12|\n|                  t1|     539|   1511822|      Portugal|    Confirmado|   2545|                 Bar|2022-06-03 10:11:...|         2|                    1|       1|      1|       0|    0|         260.0|  2022-07-15|  2022-07-17|             130.0|             130.0|               130.0|                           42|\n| apartamento com 2 s|     511|   1667223|       Bélgica|     Registado|   2398|Smart Deal -  Dir...|2023-01-29 16:36:...|         5|                    1|       3|      3|       0|    0|         360.0|  2023-02-04|  2023-02-09|              72.0|              24.0|                24.0|                            6|\n|               duplo|     444|   1593566|         Suiça|     Registado|   2073|              Normal|2022-09-21 17:54:...|         1|                    1|       2|      2|       0|    0|          70.0|  2022-11-03|  2022-11-04|              70.0|              35.0|                35.0|                           43|\n|      duplo standard|     310|   1658541|      Portugal|  NãoRegistado|   1395|      MR - Main Rate|2023-01-17 16:21:...|         1|                    1|       2|      2|       0|    0|          44.1|  2023-01-17|  2023-01-18|              44.1|             22.05|               22.05|                            0|\n| bed mixed dormitory|     328|   1463412|      Alemanha|     Registado|   1450|             WebSite|2022-03-31 17:41:...|         1|                    1|       1|      1|       0|    0|         21.63|  2022-04-05|  2022-04-06|             21.63|             21.63|               21.63|                            5|\n|twin com wc priva...|     492|   1688271|      Portugal|     Cancelado|   2322|                 Bar|2023-03-01 14:09:...|         4|                    1|       1|      1|       0|    0|         240.0|  2023-04-10|  2023-04-14|              60.0|              60.0|                60.0|                           40|\n|       duplo ou twin|     392|   1623312|      Portugal|     Registado|   1801|       Epoca Normal |2022-11-09 23:14:...|         1|                    1|       1|      1|       0|    0|         69.92|  2022-11-11|  2022-11-12|             69.92|             69.92|               69.92|                            2|\n|            superior|     310|   1464568|      Portugal|     Registado|   1673|                 NRF|2022-04-02 10:22:...|         1|                    1|       2|      2|       0|    0|          53.0|  2022-04-02|  2022-04-03|              53.0|              26.5|                26.5|                            0|\n|          city duplo|     319|   1586164|      Alemanha|     Registado|   2890|         Normal (RO)|2022-09-10 07:42:...|         3|                    1|       1|      1|       0|    0|         213.0|  2022-09-13|  2022-09-16|              71.0|              71.0|                71.0|                            3|\n|      single confort|     179|   1669318|       Hungria|     Registado|    629| No Reembolsable 13%|2023-02-01 15:50:...|         3|                    1|       1|      1|       0|    0|211.8599999999|  2023-02-18|  2023-02-21| 70.61999999996667| 70.61999999996667|   70.61999999996667|                           17|\n|          eco garden|     514|   1540447|       Espanha|     Cancelado|   2425|   Non-Refundable >5|2022-07-11 17:40:...|         5|                    1|       2|      2|       0|    0|         540.0|  2022-07-28|  2022-08-02|             108.0|              54.0|                54.0|                           17|\n|       twin standard|     310|   1539090|      Portugal|     Registado|   1424|      MR - Main Rate|2022-07-09 20:17:...|         1|                    1|       2|      2|       0|    0|          63.7|  2022-07-17|  2022-07-18|              63.7|             31.85|               31.85|                            8|\n|      duplo standard|     311|   1690249|         Suiça|    Modificada|   1407|      MR - Main Rate|2023-03-04 12:21:...|         1|                    1|       2|      2|       0|    0|        64.505|  2023-03-29|  2023-03-30|            64.505|           32.2525|             32.2525|                           25|\n|       twin assotado|     426|   1716011|      Portugal|     Registado|   1993|                 BAR|2023-04-08 20:28:...|         2|                    1|       2|      2|       0|    0|         162.0|  2023-07-12|  2023-07-14|              81.0|              40.5|                40.5|                           95|\n|      duplo standard|     311|   1673779|       Holanda|  NãoRegistado|   1407|      MR - Main Rate|2023-02-07 21:17:...|         1|                    1|       2|      2|       0|    0|          63.7|  2023-02-15|  2023-02-16|              63.7|             31.85|               31.85|                            8|\n|                  t1|     482|   1572689|      Portugal|     Registado|   2285|(WEB) Best Availa...|2022-08-21 13:05:...|         5|                    1|       2|      2|       0|    0|         446.5|  2022-09-10|  2022-09-15|              89.3|             44.65|               44.65|                           20|\n|            standard|     259|   1441837|      Portugal|     Registado|   1103|NON REFUNDABLE - ...|2022-02-24 08:26:...|         3|                    1|       2|      2|       1|    0|         439.5|  2022-02-26|  2022-03-01|             146.5|             73.25|               73.25|                            2|\n|      duplo standard|     556|   1617367|      Portugal|      Pendente|   2831|WEB (Best Availab...|2022-10-30 08:54:...|         1|                    1|       1|      1|       0|    0|          57.0|  2022-10-30|  2022-10-31|              57.0|              57.0|                57.0|                            0|\n|           executivo|     319|   1566929|      Portugal|     Registado|   1415|Não reembolsável ...|2022-08-12 08:46:...|         2|                    1|       2|      2|       0|    0|         141.0|  2022-08-27|  2022-08-29|              70.5|             35.25|               35.25|                           15|\n|       duplo confort|     179|   1677995|       Espanha|     Registado|    630| No Reembolsable 13%|2023-02-14 09:26:...|         3|                    1|       2|      2|       0|    0|343.2329999999|  2023-03-30|  2023-04-02|114.41099999996668| 57.20549999998334|   57.20549999998334|                           44|\n|              studio|     560|   1472488|Estados Unidos|     Cancelado|   2865|            Standard|2022-04-11 20:14:...|         3|                    1|       2|      2|       0|    0|         240.0|  2022-07-03|  2022-07-06|              80.0|              40.0|                40.0|                           83|\n|       duplo ou twin|     511|   1438060|      Portugal|     Registado|   2394|Standart Rate - Q...|2022-02-17 16:45:...|         1|                    1|       2|      2|       1|    0|          55.0|  2022-02-19|  2022-02-20|              55.0|              27.5|                27.5|                            2|\n|            standard|     319|   1686527|      Portugal|     Cancelado|   2264|         Normal (BB)|2023-02-27 10:54:...|         6|                    1|       2|      2|       0|    0|         438.0|  2023-04-26|  2023-05-02|              73.0|              36.5|                36.5|                           58|\n|                  t2|     482|   1551379|       Espanha|     Registado|   2286|(WEB) Non-refunda...|2022-07-24 19:07:...|         2|                    1|       4|      4|       1|    0|        437.33|  2022-07-30|  2022-08-01|           218.665|          54.66625|            54.66625|                            6|\n|      duplo standard|     556|   1669123|      Portugal|     Registado|   2831|WEB (Best Availab...|2023-02-01 10:57:...|         1|                    1|       2|      2|       0|    0|          93.5|  2023-02-04|  2023-02-05|              93.5|             46.75|               46.75|                            3|\n|      duplo standard|     483|   1441649|      Portugal|     Registado|   2288|CLG - Flexible si...|2022-02-23 19:59:...|         2|                    1|       2|      2|       0|    0|         178.0|  2022-03-02|  2022-03-04|              89.0|              44.5|                44.5|                            7|\n|            standard|     259|   1437773|   Reino Unido|     Registado|   1103|NON REFUNDABLE - ...|2022-02-17 10:10:...|         1|                    4|       1|      4|       0|    0|         378.0|  2022-02-23|  2022-02-24|             378.0|              94.5|               378.0|                            6|\n|s i ii iii iv ter...|     313|   1498203|      Alemanha|     Registado|   1378|              Normal|2022-05-17 03:49:...|         7|                    1|       2|      2|       0|    0|        1680.0|  2022-06-20|  2022-06-27|             240.0|             120.0|               120.0|                           34|\n|                  t1|     493|   1429953|      Portugal|     Registado|   2323|                 Bar|2022-02-02 17:01:...|         2|                    1|       3|      3|       0|    0|         180.0|  2022-02-06|  2022-02-08|              90.0|              30.0|                30.0|                            4|\n|       twin standard|     311|   1505559|   Reino Unido|     Registado|   1429|        TW Room Only|2022-05-26 15:39:...|         1|                    1|       2|      2|       0|    0|          74.0|  2022-06-24|  2022-06-25|              74.0|              37.0|                37.0|                           29|\n|               suite|     535|   1503462|      Portugal|      Pendente|   2527|             WebSite|2022-05-23 20:35:...|         1|                    1|       2|      2|       0|    0|         108.0|  2022-07-24|  2022-07-25|             108.0|              54.0|                54.0|                           62|\n|                twin|     444|   1504291|         Suiça|     Registado|   2384|              Normal|2022-05-24 20:54:...|         2|                    1|       2|      2|       0|    0|         320.0|  2022-08-08|  2022-08-10|             160.0|              80.0|                80.0|                           76|\n|     duplo economico|     503|   1459584|      Portugal|     Registado|   2785|             BAR APA|2022-03-26 18:25:...|         2|                    1|       2|      2|       0|    0|         120.0|  2022-05-06|  2022-05-08|              60.0|              30.0|                30.0|                           41|\n|      duplo standard|     311|   1515823|        Itália|  NãoRegistado|   1407|        DB Room Only|2022-06-08 14:27:...|         1|                    1|       1|      1|       0|    0|          74.0|  2022-06-22|  2022-06-23|              74.0|              74.0|                74.0|                           14|\n|       twin standard|     378|   1646326|      Portugal|     Registado|   1738|Tarifa Não Reembo...|2022-12-27 23:40:...|         1|                    1|       2|      2|       0|    0|          95.8|  2022-12-31|  2023-01-01|              95.8|              47.9|                47.9|                            4|\n|      duplo standard|     556|   1636544|      Portugal|      Pendente|   2831|WEB (Best Availab...|2022-12-05 16:04:...|         1|                    1|       1|      1|       0|    0|          76.5|  2022-12-24|  2022-12-25|              76.5|              76.5|                76.5|                           19|\n|            superior|     311|   1548568|      Portugal|  NãoRegistado|   2034|                 NR |2022-07-22 12:49:...|         1|                    1|       2|      2|       0|    0|         76.95|  2022-07-25|  2022-07-26|             76.95|            38.475|              38.475|                            3|\n|standard front si...|     238|   1687273|        Canadá|  NãoRegistado|    937|      Estadia Normal|2023-02-28 04:34:...|         3|                    1|       2|      2|       0|    0|         339.0|  2023-06-06|  2023-06-09|             113.0|              56.5|                56.5|                           98|\n|      duplo standard|     556|   1599581|        Brasil|      Pendente|   2831|WEB (Best Availab...|2022-09-30 19:29:...|         1|                    1|       2|      2|       0|    0|          57.0|  2022-10-02|  2022-10-03|              57.0|              28.5|                28.5|                            2|\n|               suite|     358|   1570480|     Dinamarca|     Registado|   1772|                 BAR|2022-08-17 17:11:...|         2|                    1|       2|      2|       0|    0|         540.0|  2022-08-26|  2022-08-28|             270.0|             135.0|               135.0|                            9|\n|            familiar|     179|   1642618|      Portugal|     Registado|    633| No Reembolsable 13%|2022-12-18 21:58:...|         1|                    1|       2|      2|       2|    0|        140.22|  2022-12-24|  2022-12-25|            140.22|             70.11|               70.11|                            6|\n|              studio|     395|   1642100|      Portugal|     Registado|   1828|            Standard|2022-12-17 14:49:...|         1|                    1|       2|      2|       0|    0|          75.0|  2022-12-18|  2022-12-19|              75.0|              37.5|                37.5|                            1|\n|    alojamento crato|     537|   1538270|      Portugal|     Cancelado|   2722|    Não Reembolsável|2022-07-08 14:42:...|         1|                    1|       2|      2|       0|    0|129.4999999999|  2022-07-09|  2022-07-10|    129.4999999999|    64.74999999995|      64.74999999995|                            1|\n|      duplo standard|     311|   1520369|       Holanda|     Registado|   1407|    DB Room Only NRF|2022-06-14 13:11:...|         1|                    1|       2|      2|       0|    0|          73.0|  2022-06-21|  2022-06-22|              73.0|              36.5|                36.5|                            7|\n|       twin standard|     311|   1580228|        Itália|  NãoRegistado|   1429|      MR - Main Rate|2022-09-01 10:04:...|         1|                    2|       2|      4|       0|    0|         176.4|  2022-09-07|  2022-09-08|             176.4|              44.1|                88.2|                            6|\n|      duplo standard|     556|   1688671|      Portugal|     Registado|   2831|WEB NRF - Non Ref...|2023-03-01 22:44:...|         1|                    1|       1|      1|       0|    0|         37.44|  2023-03-02|  2023-03-03|             37.44|             37.44|               37.44|                            1|\n|                twin|     322|   1630130|       Espanha|     Registado|   2259|Não Reembolsável ...|2022-11-23 12:00:...|         1|                    1|       2|      2|       0|    0|          76.0|  2022-11-27|  2022-11-28|              76.0|              38.0|                38.0|                            4|\n|                  t2|     482|   1570871|         Suiça|     Registado|   2286|(WEB) Best Availa...|2022-08-18 09:41:...|         6|                    1|       4|      4|       0|    0|        1102.0|  2022-09-03|  2022-09-09|183.66666666666666|45.916666666666664|  45.916666666666664|                           16|\n|casal com wc priv...|     492|   1680214|      Portugal|     Registado|   2333|                 Bar|2023-02-17 13:23:...|         2|                    1|       1|      1|       0|    0|          90.0|  2023-02-22|  2023-02-24|              45.0|              45.0|                45.0|                            5|\n|      duplo standard|     311|   1635677|        Itália|  NãoRegistado|   1407|      MR - Main Rate| 2022-12-03 21:57:05|         1|                    3|       2|      6|       0|    0|        171.99|  2023-01-06|  2023-01-07|            171.99|28.665000000000003|              85.995|                           34|\n|              triplo|     444|   1621324|       Irlanda|     Registado|   2229|              Normal|2022-11-06 16:06:...|         1|                    1|       3|      3|       0|    0|          90.0|  2022-11-06|  2022-11-07|              90.0|              30.0|                30.0|                            0|\n|            familiar|     433|   1690239|    Luxemburgo|     Registado|   2732|Non Refundable S/PA |2023-03-04 12:07:...|         4|                    1|       1|      1|       0|    0|         152.0|  2023-03-18|  2023-03-22|              38.0|              38.0|                38.0|                           14|\n|               duplo|     321|   1491534|      Portugal|     Registado|   1417|       B.A.R - C/ PA|2022-05-09 10:01:...|         2|                    1|       2|      2|       0|    0|         159.0|  2022-06-10|  2022-06-12|              79.5|             39.75|               39.75|                           32|\n|               suite|      54|   1481018|      Portugal|      Pendente|    168|Bar - Melhor Preç...|2022-04-24 21:12:...|         1|                    1|       2|      2|       0|    0|         100.0|  2022-09-24|  2022-09-25|             100.0|              50.0|                50.0|                          153|\n|               duplo|     415|   1441230|      Filandia|     Registado|   1940|      Non Refundable|2022-02-23 01:47:...|         2|                    1|       1|      1|       0|    0|         110.0|  2022-02-23|  2022-02-25|              55.0|              55.0|                55.0|                            0|\n|      duplo standard|     311|   1461745|        França|     Registado|   1407|              Promo |2022-03-29 17:00:...|         1|                    1|       2|      2|       0|    0|          49.5|  2022-04-09|  2022-04-10|              49.5|             24.75|               24.75|                           11|\n|            superior|     322|   1672211|Estados Unidos|     Registado|   2260|     Reembolsável AP|2023-02-05 20:53:...|         2|                    1|       2|      2|       0|    0|         240.0|  2023-05-29|  2023-05-31|             120.0|              60.0|                60.0|                          113|\n|                  t2|     332|   1695526|Estados Unidos|     Registado|   1473|               Junho|2023-03-12 00:55:...|         4|                    1|       2|      2|       0|    0|         768.0|  2023-06-13|  2023-06-17|             192.0|              96.0|                96.0|                           93|\n|      duplo standard|     311|   1718684|        Itália|     Registado|   1407|        Main Rate BB|2023-04-12 13:13:...|         1|                    1|       2|      2|       0|    0|        103.55|  2023-04-18|  2023-04-19|            103.55|            51.775|              51.775|                            6|\n|               duplo|     304|   1620941|      Portugal|    Modificada|   1406|         Tarifa Site|2022-11-05 19:14:...|         1|                    1|       2|      2|       0|    0|         62.56|  2022-11-12|  2022-11-13|             62.56|             31.28|               31.28|                            7|\n|          eco garden|     514|   1651800|        França|     Registado|   2425|   Non-Refundable >5|2023-01-07 10:04:...|         6|                    1|       2|      2|       0|    0|         696.0|  2023-08-01|  2023-08-07|             116.0|              58.0|                58.0|                          206|\n|                  t1|     493|   1440096|      Portugal|     Cancelado|   2323|                 Bar|2022-02-21 10:57:...|         3|                    1|       3|      3|       0|    0|         240.0|  2022-02-23|  2022-02-26|              80.0|26.666666666666668|  26.666666666666668|                            2|\n|      duplo standard|     556|   1441284|      Portugal|     Registado|   2831|NRF - Non Refundable|2022-02-23 09:50:...|         1|                    1|       2|      2|       0|    0|          83.7|  2022-02-25|  2022-02-26|              83.7|             41.85|               41.85|                            2|\n|            superior|     311|   1576545|       Espanha|     Registado|   2034|                 NR |2022-08-26 19:43:...|         1|                    1|       2|      2|       0|    0| 90.7499999999|  2022-08-30|  2022-08-31|     90.7499999999|    45.37499999995|      45.37499999995|                            4|\n|            standard|     319|   1528405|        França|     Registado|   2264|Não reembolsável ...|2022-06-25 07:16:...|         1|                    1|       2|      2|       0|    0|          68.0|  2022-07-19|  2022-07-20|              68.0|              34.0|                34.0|                           24|\n|        twin premium|     426|   1595420|      Portugal|     Registado|   1994|                 BAR|2022-09-24 18:50:...|         3|                    1|       2|      2|       0|    0|         345.0|  2022-10-29|  2022-11-01|             115.0|              57.5|                57.5|                           35|\n|          city duplo|     319|   1586157|      Alemanha|     Registado|   2890|         Normal (RO)|2022-09-10 07:30:...|         3|                    1|       1|      1|       0|    0|         213.0|  2022-09-13|  2022-09-16|              71.0|              71.0|                71.0|                            3|\n| duplo cama de casal|     478|   1453023|        França|     Registado|   2231|    Não Reembolsável|2022-03-16 15:28:...|         1|                    1|       2|      2|       0|    0|          50.0|  2022-03-23|  2022-03-24|              50.0|              25.0|                25.0|                            7|\n|       duplo terrace|      49|   1465358|       Bélgica|     Registado|    211|                  HB|2022-04-03 12:13:...|         4|                    1|       2|      2|       0|    0|        1040.0|  2022-05-30|  2022-06-03|             260.0|             130.0|               130.0|                           57|\n|            superior|     238|   1585916|   Reino Unido|  NãoRegistado|    938|      Estadia Normal|2022-09-09 17:29:...|         1|                    1|       2|      2|       0|    0|         117.0|  2022-09-11|  2022-09-12|             117.0|              58.5|                58.5|                            2|\n|            bungalow|     535|   1683500|      Portugal|      Pendente|   2783|             WebSite|2023-02-22 18:58:...|         1|                    1|       2|      2|       0|    0|          99.0|  2023-07-15|  2023-07-16|              99.0|              49.5|                49.5|                          143|\n|      duplo standard|     311|   1530956|      Portugal|  NãoRegistado|   1407|        DB Room Only|2022-06-28 18:17:...|         1|                    1|       1|      1|       0|    0|          84.0|  2022-07-05|  2022-07-06|              84.0|              84.0|                84.0|                            7|\n|            superior|     310|   1646526|        França|     Registado|   1673|      MR - Main Rate|2022-12-28 13:38:...|         3|                    1|       2|      2|       0|    0|         161.7|  2023-01-19|  2023-01-22|              53.9|             26.95|               26.95|                           22|\n|           duplotwin|     404|   1598935|      Portugal|    Modificada|   1888|        Preço Normal|2022-09-29 18:46:...|         1|                    1|       2|      2|       0|    0|          80.0|  2022-10-01|  2022-10-02|              80.0|              40.0|                40.0|                            2|\n|      duplo standard|     309|   1608441|      Portugal|    Modificada|   1372|        Main Rate BB|2022-10-14 14:03:...|         1|                    1|       2|      2|       0|    0|          58.8|  2022-10-15|  2022-10-16|              58.8|              29.4|                29.4|                            1|\n|              studio|     287|   1699330|        Canadá|     Registado|   1232|            Standard|2023-03-17 00:27:...|         1|                    1|       2|      2|       0|    0|          90.0|  2023-03-17|  2023-03-18|              90.0|              45.0|                45.0|                            0|\n|    duplo wextra bed|     556|   1437194|      Portugal|     Cancelado|   2847|WEB (Best Availab...|2022-02-16 11:20:...|         2|                    1|       2|      2|       1|    0|        211.25|  2022-02-19|  2022-02-21|           105.625|           52.8125|             52.8125|                            3|\n| duplo cama de casal|     478|   1509555|        França|     Registado|   2231|    Não Reembolsável|2022-05-31 13:34:...|         1|                    1|       1|      1|       0|    0|          90.0|  2022-08-07|  2022-08-08|              90.0|              90.0|                90.0|                           68|\n|               other|     391|   1639768|      Portugal|     Registado|   1803|        BASE.WEBSITE|2022-12-12 16:46:...|         2|                    1|       1|      1|       0|    0|          98.0|  2022-12-14|  2022-12-16|              49.0|              49.0|                49.0|                            2|\n|      duplo standard|     311|   1638471|        França|     Registado|   1407|                 NR |2022-12-09 17:02:...|         1|                    1|       2|      2|       0|    0| 58.9999999999|  2022-12-27|  2022-12-28|     58.9999999999|    29.49999999995|      29.49999999995|                           18|\n|       duplo confort|     179|   1663287|        França|     Registado|    630|            Avionics|2023-01-24 17:53:...|         5|                    1|       1|      1|       0|    0|         430.0|  2023-03-01|  2023-03-06|              86.0|              86.0|                86.0|                           36|\n|       twin standard|     310|   1486448|      Portugal|    Modificada|   1424|        Main Rate BB|2022-05-02 16:11:...|         1|                    1|       2|      2|       0|    0|          64.0|  2022-05-11|  2022-05-12|              64.0|              32.0|                32.0|                            9|\n|alojamento arraiolos|     537|   1555006|      Portugal|     Registado|   2720|    Não Reembolsável|2022-07-27 08:32:...|         1|                    1|       2|      2|       0|    0|129.4999999999|  2022-07-31|  2022-08-01|    129.4999999999|    64.74999999995|      64.74999999995|                            4|\n|                twin|     535|   1538248|      Portugal|      Pendente|   2524|             WebSite|2022-07-08 14:09:...|         1|                    1|       2|      2|       0|    0|          81.0|  2022-07-09|  2022-07-10|              81.0|              40.5|                40.5|                            1|\n|            superior|     310|   1719440|      Portugal|    Modificada|   1673|      MR - Main Rate|2023-04-13 11:24:...|         1|                    1|       2|      2|       0|    0|        64.505|  2023-04-15|  2023-04-16|            64.505|           32.2525|             32.2525|                            2|\n|      duplo standard|     539|   1635520|      Portugal|     Registado|   2542|                 Bar|2022-12-03 17:05:...|         3|                    1|       1|      1|       0|    0|         165.0|  2022-12-06|  2022-12-09|              55.0|              55.0|                55.0|                            3|\n|               suite|     238|   1485050|Estados Unidos|     Registado|    954|      Estadia Normal|2022-04-30 17:43:...|         3|                    1|       2|      2|       0|    0|         408.0|  2022-06-27|  2022-06-30|             136.0|              68.0|                68.0|                           58|\n|      duplo standard|     310|   1670950|      Portugal|  NãoRegistado|   1395|      MR - Main Rate|2023-02-03 21:31:...|         1|                    2|       2|      4|       0|    0|          88.2|  2023-02-03|  2023-02-04|              88.2|             22.05|                44.1|                            0|\n|                twin|     444|   1600426|      Portugal|     Registado|   2384|              Normal|2022-10-02 12:49:...|         1|                    1|       2|      2|       0|    0|          80.0|  2022-10-06|  2022-10-07|              80.0|              40.0|                40.0|                            4|\n|               suite|     280|   1435255|      Portugal|     Registado|   2564|                 BAR|2022-02-13 15:47:...|         1|                    1|       2|      2|       2|    0|         200.0|  2022-04-23|  2022-04-24|             200.0|             100.0|               100.0|                           69|\n|      duplo standard|     556|   1530928|      Portugal|     Cancelado|   2831|WEB (Best Availab...|2022-06-28 17:40:...|         1|                    2|       2|      4|       0|    0|         144.5|  2022-07-30|  2022-07-31|             144.5|            36.125|               72.25|                           32|\n+--------------------+--------+----------+--------------+--------------+-------+--------------------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+------------------+------------------+--------------------+-----------------------------+\nonly showing top 100 rows\n\n24955\nimport org.apache.spark.sql.DataFrame\nimport org.apache.spark.sql.functions._\nimport spark.implicits._\n\u001b[1m\u001b[34mjoinFolder\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = /data/joins\n\u001b[1m\u001b[34msaveJoins\u001b[0m: \u001b[1m\u001b[32mBoolean\u001b[0m = false\n\u001b[1m\u001b[34msaveDataFrame\u001b[0m: \u001b[1m\u001b[32m(df: org.apache.spark.sql.DataFrame, name: String)Unit\u001b[0m\n\u001b[1m\u001b[34minitialCount\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [tipo_quarto: string, hotel_ID: int ... 19 more fields]\n"
     }
    ]
   }
  },
  {
   "user": "anonymous",
   "config": {
    "colWidth": 12,
    "fontSize": 9,
    "enabled": true,
    "results": {},
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "editorMode": "ace/mode/scala"
   },
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       },
       {
        "columns": [
         {
          "name": "tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Quantidade de quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "preco_noite",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_adulto",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "preco_noite_ocupacao",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "jobName": "paragraph_1563110258183_1613653816",
   "id": "20190714-161738_1950435706",
   "dateCreated": "2019-07-14T16:17:38+0300",
   "status": "FINISHED",
   "progressUpdateIntervalMs": 500,
   "focus": true,
   "$$hashKey": "object:394",
   "text": "val joinTipologia = spark.sql(\n    \"\"\"\n       SELECT DISTINCT \n           Q.hotel_ID, \n           Q.Reserve_ID,\n           Q.pais,\n           Q.estado_reserva,\n           Q.room_ID,\n           Q.tipo_quarto AS Q_tipo_quarto,\n           Q.rate_plan,\n           Q.data_reserva,\n           Q.data_chegada,\n           Q.data_partida,\n           Q.num_noites,\n           Q.ocupacao,\n           Q.adultos,\n           Q.criancas,\n           Q.bebes,\n           Q.preco_euros,\n           Q.dif_data_chegada_data_reserva,\n           T.tipo_quarto as T_tipo_quarto, \n           T.quantidade,\n           T.capacidade_maxima,\n           T.capacidade_max_adultos,\n           T.capacidade_max_criancas,\n           T.capacidade_max_bebes\n       FROM QuartosReservados as Q\n       Inner JOIN Tipologias as T\n           ON Q.hotel_ID = T.hotel_ID AND T.room_ID = Q.room_ID\n      \"\"\")\n\nval joinTipologiaNotExists = spark.sql(\n    \"\"\"\n        SELECT *\n        FROM QuartosReservados\n        WHERE NOT EXISTS (\n           SELECT *\n           FROM Tipologias\n           WHERE QuartosReservados.hotel_ID = Tipologias.hotel_ID AND \n           QuartosReservados.room_ID = Tipologias.room_ID\n        )\n      \"\"\")\njoinTipologiaNotExists.show();\n\n\njoinTipologia.createOrReplaceTempView(\"JoinTipologia\")\njoinTipologia.cache()\n\nif (saveJoins)\n    saveDataFrame(joinTipologia, \"joinTipologia\")\n\nprintln(joinTipologia.count())\njoinTipologia.printSchema()",
   "dateStarted": "2023-05-23 21:42:13.939",
   "dateUpdated": "2023-05-23 21:42:16.082",
   "dateFinished": "2023-05-23 21:42:16.082",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+-------------+--------+----------+--------+--------------+-------+---------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+-----------------+------------------+--------------------+-----------------------------+\n|  tipo_quarto|hotel_ID|Reserve_ID|    pais|estado_reserva|room_ID|rate_plan|        data_reserva|num_noites|Quantidade de quartos|ocupacao|adultos|criancas|bebes|   preco_euros|data_chegada|data_partida|      preco_noite|preco_noite_adulto|preco_noite_ocupacao|dif_data_chegada_data_reserva|\n+-------------+--------+----------+--------+--------------+-------+---------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+-----------------+------------------+--------------------+-----------------------------+\n|twin standard|     309|   1438425|Portugal|    Modificada|   2802|    PROMO|2022-02-18 10:48:...|         1|                    1|       2|      2|       0|    0|          38.7|  2022-02-19|  2022-02-20|             38.7|             19.35|               19.35|                            1|\n|twin standard|     309|   1441490|Portugal|     Cancelado|   2802|    PROMO|2022-02-23 16:10:...|         1|                    1|       2|      2|       0|    0|          43.0|  2022-02-23|  2022-02-24|             43.0|              21.5|                21.5|                            0|\n|twin standard|     309|   1441490|Portugal|     Cancelado|   2802|    PROMO|2022-02-23 16:10:...|         1|                    1|       2|      2|       0|    0|          43.0|  2022-03-19|  2022-03-20|             43.0|              21.5|                21.5|                           24|\n|twin standard|     309|   1440314| Espanha|  NãoRegistado|   2802|    PROMO|2022-02-21 16:44:...|         3|                    1|       2|      2|       0|    0|128.9999999999|  2022-02-22|  2022-02-25|42.99999999996667|21.499999999983334|  21.499999999983334|                            1|\n|twin standard|     309|   1442562|Portugal|     Cancelado|   2802|    PROMO|2022-02-25 16:06:...|         1|                    1|       2|      2|       0|    0|          43.0|  2022-02-25|  2022-02-26|             43.0|              21.5|                21.5|                            0|\n|twin standard|     309|   1441186|Portugal|     Registado|   2802|    PROMO|2022-02-22 22:43:...|         1|                    1|       2|      2|       0|    0|          43.0|  2022-02-26|  2022-02-27|             43.0|              21.5|                21.5|                            4|\n|twin standard|     309|   1438484|Portugal|    Modificada|   2802|    PROMO|2022-02-18 12:14:...|         3|                    1|       2|      2|       0|    0|128.9999999999|  2022-02-18|  2022-02-21|42.99999999996667|21.499999999983334|  21.499999999983334|                            0|\n|twin standard|     309|   1444879|Portugal|     Registado|   2802|    PROMO|2022-03-01 21:17:...|         2|                    1|       2|      2|       0|    0| 77.3999999999|  2022-03-11|  2022-03-13|   38.69999999995|   19.349999999975|     19.349999999975|                           10|\n+-------------+--------+----------+--------+--------------+-------+---------+--------------------+----------+---------------------+--------+-------+--------+-----+--------------+------------+------------+-----------------+------------------+--------------------+-----------------------------+\n\n24947\nroot\n |-- hotel_ID: integer (nullable = true)\n |-- Reserve_ID: integer (nullable = true)\n |-- pais: string (nullable = true)\n |-- estado_reserva: string (nullable = true)\n |-- room_ID: integer (nullable = true)\n |-- Q_tipo_quarto: string (nullable = true)\n |-- rate_plan: string (nullable = true)\n |-- data_reserva: timestamp (nullable = true)\n |-- data_chegada: date (nullable = true)\n |-- data_partida: date (nullable = true)\n |-- num_noites: integer (nullable = true)\n |-- ocupacao: integer (nullable = true)\n |-- adultos: integer (nullable = true)\n |-- criancas: integer (nullable = true)\n |-- bebes: integer (nullable = true)\n |-- preco_euros: double (nullable = true)\n |-- dif_data_chegada_data_reserva: integer (nullable = true)\n |-- T_tipo_quarto: string (nullable = true)\n |-- quantidade: integer (nullable = true)\n |-- capacidade_maxima: integer (nullable = true)\n |-- capacidade_max_adultos: integer (nullable = true)\n |-- capacidade_max_criancas: integer (nullable = true)\n |-- capacidade_max_bebes: integer (nullable = true)\n\n\u001b[1m\u001b[34mjoinTipologia\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 21 more fields]\n\u001b[1m\u001b[34mjoinTipologiaNotExists\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [tipo_quarto: string, hotel_ID: int ... 19 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {},
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinTipologiaAndHotel = spark.sql(\n    \"\"\"\n       SELECT \n           J.*,\n           H.localizacao,\n           H.area_localizacao,\n           H.estrelas,\n           H.idade_max_criancas,\n           H.idade_max_bebes,\n           H.hora_max_checkin,\n           H.qtd_quartos\n       FROM joinTipologia as J\n       INNER JOIN Hotel as H\n           ON J.hotel_ID = H.hotel_ID\n    \"\"\")\n\njoinTipologiaAndHotel.createOrReplaceTempView(\"JoinTipologiaAndHotel\")\n\nprintln(joinTipologiaAndHotel.count())\n//joinTipologiaAndHotel.printSchema()\nif (saveJoins)\n    saveDataFrame(joinTipologiaAndHotel, \"joinTipologiaAndHotel\")",
   "id": "",
   "dateCreated": "2023-04-30 20:01:48.781",
   "config": {
    "tableHide": false
   },
   "dateStarted": "2023-05-23 21:42:16.102",
   "dateUpdated": "2023-05-23 21:42:17.359",
   "dateFinished": "2023-05-23 21:42:17.358",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n\u001b[1m\u001b[34mjoinTipologiaAndHotel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 28 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {},
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": false
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinFeriados = spark.sql(\n    \"\"\"\n        SELECT J.*, F.is_holiday\n        FROM JoinTipologiaAndHotel AS J\n        LEFT JOIN (SELECT * FROM Feriados WHERE is_holiday=1) AS F\n            ON F.date <= J.data_partida AND f.date >= data_chegada\n    \"\"\"\n)\njoinFeriados = joinFeriados.na.fill(0, Seq(\"is_holiday\"))\n\njoinFeriados.createOrReplaceTempView(\"JoinFeriados\")\n\nprintln(joinFeriados.count())\n\njoinFeriados.show()",
   "id": "",
   "dateCreated": "2023-04-30 20:12:14.191",
   "config": {
    "tableHide": false
   },
   "dateStarted": "2023-05-23 21:42:17.368",
   "dateUpdated": "2023-05-23 21:42:19.202",
   "dateFinished": "2023-05-23 21:42:19.202",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "25213\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|  preco_euros|dif_data_chegada_data_reserva|       T_tipo_quarto|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\n|     444|   1601297|        França|     Registado|   2073|               duplo|              Normal|2022-10-03 14:29:...|  2022-10-06|  2022-10-07|         1|       2|      2|       0|    0|         80.0|                            3|              Duplo |        14|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-23 23:59:00|         77|         0|\n|     482|   1708773|       Espanha|     Registado|   2285|                  t1|(WEB) Best Availa...|2023-03-30 01:54:...|  2023-04-29|  2023-05-01|         2|       4|     20|       0|    0|       1330.0|                           30|      Apartamento T1|        90|                4|                     4|                      3|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         1|\n|     535|   1553843|      Portugal|      Pendente|   2783|            bungalow|             WebSite|2022-07-26 19:07:...|  2022-07-29|  2022-07-30|         1|       2|      2|       0|    0|         90.0|                            3|            Bungalow|         1|                2|                     2|                      0|                   0| Travanca do Mondego|         Coimbra|       4|                12|             24|2023-05-23 23:55:00|         11|         0|\n|     238|   1507433|    Eslováquia|     Registado|    938|            superior|      Estadia Normal|2022-05-29 10:07:...|  2022-06-01|  2022-06-02|         1|       1|      1|       0|    0|         93.5|                            3|Side Superior Bal...|         3|                3|                     3|                      0|                   1|             Funchal|         Funchal|       3|                 8|             23|2023-05-23 23:30:00|         52|         0|\n|     492|   1675729|      Portugal|     Registado|   2322|twin com wc priva...|                 Bar|2023-02-10 16:19:...|  2023-02-13|  2023-02-17|         4|       1|      1|       0|    0|        210.0|                            3|Quarto twin com W...|         3|                2|                     2|                      1|                   1|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 09:00:00|         13|         0|\n|     311|   1588300|     Dinamarca|  NãoRegistado|   2034|            superior|        Main Rate BB|2022-09-13 15:10:...|  2022-09-19|  2022-09-20|         1|       2|      2|       0|    0|        107.8|                            6|DBS - Quarto Dupl...|         5|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|\n|     556|   1472283|      Portugal|      Pendente|   2832|       twin standard|WEB (Best Availab...|2022-04-11 15:50:...|  2022-04-11|  2022-04-12|         1|       2|      2|       0|    0|         58.9|                            0|  Twin Room Standard|        27|                2|                     2|                      1|                   0|             Covilhã|  Castelo Branco|       3|                10|              3|2023-05-23 23:00:00|         84|         0|\n|     556|   1709442|      Portugal|      Pendente|   2833|     triplo standard|WEB (Best Availab...|2023-03-30 22:50:...|  2023-04-29|  2023-05-01|         2|       3|      9|       0|    0|        606.9|                           30|Triple Room Standard|         7|                3|                     3|                      2|                   1|             Covilhã|  Castelo Branco|       3|                10|              3|2023-05-23 23:00:00|         84|         1|\n|     414|   1461364|       Irlanda|     Registado|   2047|            superior|        Normal - Bar|2022-03-29 08:26:...|  2022-06-05|  2022-06-08|         3|       2|      2|       0|    0|        330.0|                           68|Duplo Superior Vi...|         3|                2|                     2|                      0|                   1|São Martinho do P...|        Alcobaça|       3|                12|             36|2023-05-23 23:30:00|         30|         0|\n|     556|   1688194|      Portugal|      Pendente|   2831|      duplo standard|WEB (Best Availab...|2023-03-01 12:30:...|  2023-03-13|  2023-03-14|         1|       2|      2|       0|    0|        55.25|                           12|Double Room Standard|        45|                3|                     2|                      0|                   1|             Covilhã|  Castelo Branco|       3|                10|              3|2023-05-23 23:00:00|         84|         0|\n|     259|   1651760|Estados Unidos|     Cancelado|   1103|            standard|              Normal|2023-01-07 03:15:...|  2023-05-09|  2023-05-10|         1|       2|      2|       0|    0|        155.0|                          122|            Standard|        13|                3|                     3|                      1|                   1|           Guimarães|       Guimarães|       4|                11|             36|2023-05-23 23:59:00|         22|         0|\n|     311|   1503700|      Alemanha|     Registado|   1407|      duplo standard|            Duplo BB|2022-05-24 09:22:...|  2022-06-02|  2022-06-03|         1|       1|      4|       0|    0|        326.0|                            9|DB - Quarto Duplo...|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|\n|     311|   1710048|       Holanda|     Registado|   1407|      duplo standard|        Main Rate BB|2023-03-31 19:54:...|  2023-05-05|  2023-05-06|         1|       2|      2|       0|    0|         89.3|                           35|DB - Quarto Duplo...|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|\n|     310|   1630692|      Portugal|  NãoRegistado|   1395|      duplo standard|      MR - Main Rate|2022-11-24 15:01:...|  2022-12-01|  2022-12-02|         1|       2|      2|       0|    0|         44.1|                            7|Quarto Duplo Stan...|        10|                2|                     2|                      1|                   0|                Gaia|           Porto|       3|                 0|              0|2023-05-23 23:59:00|        192|         1|\n|     482|   1619744|       Espanha|     Registado|   2285|                  t1|(WEB) Non-refunda...|2022-11-03 14:05:...|  2022-11-12|  2022-11-13|         1|       2|      2|       0|    0|        30.92|                            9|      Apartamento T1|        90|                4|                     4|                      3|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|\n|     514|   1440381|   Reino Unido|     Cancelado|   2425|          eco garden|   Non-Refundable >5|2022-02-21 18:09:...|  2022-06-01|  2022-06-06|         5|       2|      2|       0|    0|        540.0|                          100|     Eco Garden Room|         4|                2|                     2|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-23 18:00:00|         13|         0|\n|     444|   1583979|      Portugal|     Registado|   2229|              triplo|              Normal|2022-09-06 20:23:...|  2022-09-17|  2022-09-19|         2|       3|      3|       0|    0|        280.0|                           11|              Triplo|         5|                3|                     3|                      2|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-23 23:59:00|         77|         0|\n|     310|   1540193|      Portugal|    Modificada|   1673|            superior|               NR BB|2022-07-11 12:32:...|  2022-07-11|  2022-07-12|         1|       1|      1|       0|    0|66.2669999999|                            0|Quarto Duplo Supe...|        63|                2|                     2|                      1|                   0|                Gaia|           Porto|       3|                 0|              0|2023-05-23 23:59:00|        192|         0|\n|     444|   1490161|      Portugal|     Registado|   2075|               suite|              Normal|2022-05-07 09:58:...|  2022-05-07|  2022-05-08|         1|       2|      2|       0|    0|        110.0|                            0|        Suite Junior|         7|                4|                     2|                      3|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-23 23:59:00|         77|         0|\n|     539|   1526991|      Portugal|     Registado|   2542|      duplo standard|                 Bar|2022-06-22 22:13:...|  2022-06-24|  2022-06-26|         2|       1|      1|       0|    0|        320.0|                            2|Quarto Dpl. Standard|         5|                2|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+--------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinFeriados\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 29 more fields]\njoinFeriados: org.apache.spark.sql.DataFrame = [hotel_ID: int, Reserve_ID: int ... 29 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinFeriadosGrouped = spark.sql(\n    \"\"\"\n        SELECT \n            hotel_ID,  Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros, dif_data_chegada_data_reserva, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, max(is_holiday) AS is_holiday\n        FROM JoinFeriados\n        GROUP BY hotel_ID, Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros, dif_data_chegada_data_reserva, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos\n    \"\"\"\n)\n\njoinFeriadosGrouped.createOrReplaceTempView(\"JoinFeriadosGrouped\")\n\nprintln(joinFeriadosGrouped.count())\njoinFeriadosGrouped.show()",
   "id": "",
   "dateCreated": "2023-05-16 20:45:38.018",
   "config": {},
   "dateStarted": "2023-05-23 21:42:19.223",
   "dateUpdated": "2023-05-23 21:42:25.020",
   "dateFinished": "2023-05-23 21:42:25.019",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|  preco_euros|dif_data_chegada_data_reserva|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\n|     322|   1607927|     Austrália|     Registado|   2259|                twin|                Twin| Não Reembolsável AP|2022-10-13 17:24:...|  2022-10-17|  2022-10-18|         1|       2|      2|       0|    0|         66.0|                            4|        18|                2|                     2|                      1|                   0|              Aveiro|          Aveiro|       3|                10|             24|2023-05-23 23:59:00|         52|         0|\n|      44|   1572437|Estados Unidos|     Registado|    190|     vista traseiras|Quarto Vista Tras...|                 BAR|2022-08-20 20:57:...|  2022-10-18|  2022-10-20|         2|       2|      2|       0|    0|        228.0|                           59|         2|                2|                     2|                      0|                   1|      Pinhão - Alijó|           Alijó|       3|                12|             24|2023-05-23 23:00:00|         10|         0|\n|     539|   1517277|      Portugal|     Registado|   2542|      duplo standard|Quarto Dpl. Standard|                 Bar|2022-06-10 11:42:...|  2022-06-21|  2022-06-22|         1|       1|      1|       0|    0|         48.0|                           11|         5|                2|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|\n|     539|   1490940|      Portugal|     Registado|   2545|                  t1|            Villa T1|                 Bar|2022-05-08 15:12:...|  2022-05-08|  2022-05-10|         2|       1|      1|       0|    0|        162.0|                            0|         1|                4|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|\n|     185|   1488661|      Portugal|     Registado|    660|           duplotwin|          Duplo/Twin|                 BAR|2022-05-05 10:20:...|  2022-06-12|  2022-06-13|         1|       2|      2|       0|    0|        139.0|                           38|        17|                2|                     2|                      1|                   1|   Valdigem - Lamego|          Chaves|       4|                12|             36|2023-05-23 23:00:00|         20|         0|\n|     482|   1477829|      Portugal|    Modificada|   2285|                  t1|      Apartamento T1|(WEB) Best Availa...|2022-04-20 12:01:...|  2022-07-25|  2022-08-01|         7|       4|      4|       0|    0|      1296.75|                           96|        90|                4|                     4|                      3|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|\n|     328|   1485741|       Holanda|     Registado|   1452|              single|         Single Room|             WebSite|2022-05-01 17:59:...|  2022-05-07|  2022-05-09|         2|       1|      1|       0|    0|         79.3|                            6|         3|                1|                     1|                      0|                   0|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 22:00:00|         56|         0|\n|     482|   1606829|      Portugal|     Registado|   2285|                  t1|      Apartamento T1|(WEB) Best Availa...|2022-10-12 10:09:...|  2022-10-13|  2022-10-15|         2|       2|      2|       0|    0|        114.0|                            1|        90|                4|                     4|                      3|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|\n|     311|   1709250|      Portugal|      Pendente|   1407|      duplo standard|DB - Quarto Duplo...|      MR - Main Rate|2023-03-30 18:25:...|  2023-04-12|  2023-04-13|         1|       1|      1|       0|    0|      78.3275|                           13|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|\n|     514|   1485227|   Reino Unido|     Registado|   2492|              garden|         Garden Room|   Non-Refundable >5|2022-04-30 22:31:...|  2022-08-10|  2022-08-17|         7|       1|      1|       0|    0|        924.0|                          102|         4|                3|                     2|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-23 18:00:00|         13|         1|\n|     311|   1576545|       Espanha|     Registado|   2034|            superior|DBS - Quarto Dupl...|                 NR |2022-08-26 19:43:...|  2022-08-30|  2022-08-31|         1|       2|      2|       0|    0|90.7499999999|                            4|         5|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|\n|     311|   1508102|       Letónia|     Registado|   1429|       twin standard|TW - Quarto Twin ...|    TW Room Only NRF|2022-05-29 20:02:...|  2022-06-02|  2022-06-03|         1|       1|      1|       0|    0|         73.0|                            4|         4|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|\n|     492|   1678170|      Portugal|     Registado|   2322|twin com wc priva...|Quarto twin com W...|                 Bar|2023-02-14 13:48:...|  2023-02-18|  2023-02-20|         2|       2|      2|       0|    0|        140.0|                            4|         3|                2|                     2|                      1|                   1|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 09:00:00|         13|         0|\n|     504|   1555750|      Portugal|     Registado|   2374|               other|       Cela da Torre|                 Bar|2022-07-28 07:38:...|  2022-08-13|  2022-08-15|         2|       1|      1|       0|    0|       206.91|                           16|         1|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-23 23:59:00|         27|         1|\n|     259|   1483687|        França|     Registado|   1103|            standard|            Standard|Pacote Romântico/...|2022-04-28 14:44:...|  2022-05-06|  2022-05-07|         1|       2|      2|       0|    0|        125.0|                            8|        13|                3|                     3|                      1|                   1|           Guimarães|       Guimarães|       4|                11|             36|2023-05-23 23:59:00|         22|         0|\n|     535|   1670013|      Portugal|      Pendente|   2783|            bungalow|            Bungalow|             WebSite|2023-02-02 16:18:...|  2023-02-15|  2023-02-16|         1|       2|      2|       0|    0|         72.0|                           13|         1|                2|                     2|                      0|                   0| Travanca do Mondego|         Coimbra|       4|                12|             24|2023-05-23 23:55:00|         11|         0|\n|     311|   1453510|      Portugal|    Modificada|   1407|      duplo standard|DB - Quarto Duplo...|    DB Room Only NRF|2022-03-17 14:39:...|  2022-03-21|  2022-03-22|         1|       1|      1|       0|    0|         63.0|                            4|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|\n|     310|   1645220|      Portugal|     Registado|   1673|            superior|Quarto Duplo Supe...|               NR BB|2022-12-25 17:48:...|  2022-12-27|  2022-12-28|         1|       2|      2|       0|    0|         70.3|                            2|        63|                2|                     2|                      1|                   0|                Gaia|           Porto|       3|                 0|              0|2023-05-23 23:59:00|        192|         0|\n|     492|   1447780|      Portugal|     Registado|   2322|twin com wc priva...|Quarto twin com W...|                 Bar|2022-03-07 12:28:...|  2022-03-07|  2022-03-08|         1|       1|      1|       0|    0|         50.0|                            0|         3|                2|                     2|                      1|                   1|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 09:00:00|         13|         0|\n|     444|   1578457|Estados Unidos|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|              Normal|2022-08-29 20:19:...|  2022-09-24|  2022-09-26|         2|       2|      2|       0|    0|        260.0|                           26|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-23 23:59:00|         77|         0|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinFeriadosGrouped\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 29 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {},
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Location",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "Event",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "start_Date",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "end_date",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "val joinEventos = spark.sql(\n    \"\"\"\n        SELECT QR.*, E.*\n        FROM JoinFeriadosGrouped QR\n        LEFT JOIN Eventos E\n            ON QR.data_partida >= E.start_Date AND QR.data_chegada <= E.end_date\n            AND QR.area_localizacao = E.Location\n    \"\"\")\n\njoinEventos.createOrReplaceTempView(\"JoinEventos\")\n\nprintln(joinEventos.count())\njoinEventos.show()",
   "id": "",
   "dateCreated": "2023-04-30 20:16:51.675",
   "config": {},
   "dateStarted": "2023-05-23 21:42:25.036",
   "dateUpdated": "2023-05-23 21:42:30.654",
   "dateFinished": "2023-05-23 21:42:30.654",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24961\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------+-----+----------+--------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|  preco_euros|dif_data_chegada_data_reserva|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|Location|Event|start_Date|end_date|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------+-----+----------+--------+\n|     322|   1607927|     Austrália|     Registado|   2259|                twin|                Twin| Não Reembolsável AP|2022-10-13 17:24:...|  2022-10-17|  2022-10-18|         1|       2|      2|       0|    0|         66.0|                            4|        18|                2|                     2|                      1|                   0|              Aveiro|          Aveiro|       3|                10|             24|2023-05-23 23:59:00|         52|         0|    null| null|      null|    null|\n|      44|   1572437|Estados Unidos|     Registado|    190|     vista traseiras|Quarto Vista Tras...|                 BAR|2022-08-20 20:57:...|  2022-10-18|  2022-10-20|         2|       2|      2|       0|    0|        228.0|                           59|         2|                2|                     2|                      0|                   1|      Pinhão - Alijó|           Alijó|       3|                12|             24|2023-05-23 23:00:00|         10|         0|    null| null|      null|    null|\n|     539|   1517277|      Portugal|     Registado|   2542|      duplo standard|Quarto Dpl. Standard|                 Bar|2022-06-10 11:42:...|  2022-06-21|  2022-06-22|         1|       1|      1|       0|    0|         48.0|                           11|         5|                2|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|    null| null|      null|    null|\n|     539|   1490940|      Portugal|     Registado|   2545|                  t1|            Villa T1|                 Bar|2022-05-08 15:12:...|  2022-05-08|  2022-05-10|         2|       1|      1|       0|    0|        162.0|                            0|         1|                4|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|    null| null|      null|    null|\n|     185|   1488661|      Portugal|     Registado|    660|           duplotwin|          Duplo/Twin|                 BAR|2022-05-05 10:20:...|  2022-06-12|  2022-06-13|         1|       2|      2|       0|    0|        139.0|                           38|        17|                2|                     2|                      1|                   1|   Valdigem - Lamego|          Chaves|       4|                12|             36|2023-05-23 23:00:00|         20|         0|    null| null|      null|    null|\n|     482|   1477829|      Portugal|    Modificada|   2285|                  t1|      Apartamento T1|(WEB) Best Availa...|2022-04-20 12:01:...|  2022-07-25|  2022-08-01|         7|       4|      4|       0|    0|      1296.75|                           96|        90|                4|                     4|                      3|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|    null| null|      null|    null|\n|     328|   1485741|       Holanda|     Registado|   1452|              single|         Single Room|             WebSite|2022-05-01 17:59:...|  2022-05-07|  2022-05-09|         2|       1|      1|       0|    0|         79.3|                            6|         3|                1|                     1|                      0|                   0|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 22:00:00|         56|         0|    null| null|      null|    null|\n|     482|   1606829|      Portugal|     Registado|   2285|                  t1|      Apartamento T1|(WEB) Best Availa...|2022-10-12 10:09:...|  2022-10-13|  2022-10-15|         2|       2|      2|       0|    0|        114.0|                            1|        90|                4|                     4|                      3|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|    null| null|      null|    null|\n|     311|   1709250|      Portugal|      Pendente|   1407|      duplo standard|DB - Quarto Duplo...|      MR - Main Rate|2023-03-30 18:25:...|  2023-04-12|  2023-04-13|         1|       1|      1|       0|    0|      78.3275|                           13|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|    null| null|      null|    null|\n|     514|   1485227|   Reino Unido|     Registado|   2492|              garden|         Garden Room|   Non-Refundable >5|2022-04-30 22:31:...|  2022-08-10|  2022-08-17|         7|       1|      1|       0|    0|        924.0|                          102|         4|                3|                     2|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-23 18:00:00|         13|         1|    null| null|      null|    null|\n|     311|   1576545|       Espanha|     Registado|   2034|            superior|DBS - Quarto Dupl...|                 NR |2022-08-26 19:43:...|  2022-08-30|  2022-08-31|         1|       2|      2|       0|    0|90.7499999999|                            4|         5|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|    null| null|      null|    null|\n|     311|   1508102|       Letónia|     Registado|   1429|       twin standard|TW - Quarto Twin ...|    TW Room Only NRF|2022-05-29 20:02:...|  2022-06-02|  2022-06-03|         1|       1|      1|       0|    0|         73.0|                            4|         4|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|    null| null|      null|    null|\n|     492|   1678170|      Portugal|     Registado|   2322|twin com wc priva...|Quarto twin com W...|                 Bar|2023-02-14 13:48:...|  2023-02-18|  2023-02-20|         2|       2|      2|       0|    0|        140.0|                            4|         3|                2|                     2|                      1|                   1|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 09:00:00|         13|         0|    null| null|      null|    null|\n|     504|   1555750|      Portugal|     Registado|   2374|               other|       Cela da Torre|                 Bar|2022-07-28 07:38:...|  2022-08-13|  2022-08-15|         2|       1|      1|       0|    0|       206.91|                           16|         1|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-23 23:59:00|         27|         1|    null| null|      null|    null|\n|     259|   1483687|        França|     Registado|   1103|            standard|            Standard|Pacote Romântico/...|2022-04-28 14:44:...|  2022-05-06|  2022-05-07|         1|       2|      2|       0|    0|        125.0|                            8|        13|                3|                     3|                      1|                   1|           Guimarães|       Guimarães|       4|                11|             36|2023-05-23 23:59:00|         22|         0|    null| null|      null|    null|\n|     535|   1670013|      Portugal|      Pendente|   2783|            bungalow|            Bungalow|             WebSite|2023-02-02 16:18:...|  2023-02-15|  2023-02-16|         1|       2|      2|       0|    0|         72.0|                           13|         1|                2|                     2|                      0|                   0| Travanca do Mondego|         Coimbra|       4|                12|             24|2023-05-23 23:55:00|         11|         0|    null| null|      null|    null|\n|     311|   1453510|      Portugal|    Modificada|   1407|      duplo standard|DB - Quarto Duplo...|    DB Room Only NRF|2022-03-17 14:39:...|  2022-03-21|  2022-03-22|         1|       1|      1|       0|    0|         63.0|                            4|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|    null| null|      null|    null|\n|     310|   1645220|      Portugal|     Registado|   1673|            superior|Quarto Duplo Supe...|               NR BB|2022-12-25 17:48:...|  2022-12-27|  2022-12-28|         1|       2|      2|       0|    0|         70.3|                            2|        63|                2|                     2|                      1|                   0|                Gaia|           Porto|       3|                 0|              0|2023-05-23 23:59:00|        192|         0|    null| null|      null|    null|\n|     492|   1447780|      Portugal|     Registado|   2322|twin com wc priva...|Quarto twin com W...|                 Bar|2022-03-07 12:28:...|  2022-03-07|  2022-03-08|         1|       1|      1|       0|    0|         50.0|                            0|         3|                2|                     2|                      1|                   1|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 09:00:00|         13|         0|    null| null|      null|    null|\n|     444|   1578457|Estados Unidos|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|              Normal|2022-08-29 20:19:...|  2022-09-24|  2022-09-26|         2|       2|      2|       0|    0|        260.0|                           26|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-23 23:59:00|         77|         0|    null| null|      null|    null|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+--------+-----+----------+--------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinEventos\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 33 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "event_count",
          "tpe": {
           "presentableName": "long"
          },
          "nullable": false
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinEventosGrouped = spark.sql(\n    \"\"\"\n        SELECT \n            hotel_ID,  Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros, dif_data_chegada_data_reserva, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, is_holiday, count(Event) AS event_count\n        FROM JoinEventos\n        GROUP BY hotel_ID, Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros, dif_data_chegada_data_reserva, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, is_holiday\n    \"\"\"\n)\n\njoinEventosGrouped.createOrReplaceTempView(\"JoinEventosGrouped\")\n\nprintln(joinEventosGrouped.count())\njoinEventosGrouped.show()",
   "id": "",
   "dateCreated": "2023-05-16 20:40:44.016",
   "config": {},
   "dateStarted": "2023-05-23 21:42:30.674",
   "dateUpdated": "2023-05-23 21:42:36.728",
   "dateFinished": "2023-05-23 21:42:36.728",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|  preco_euros|dif_data_chegada_data_reserva|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|event_count|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+\n|     322|   1607927|     Austrália|     Registado|   2259|                twin|                Twin| Não Reembolsável AP|2022-10-13 17:24:...|  2022-10-17|  2022-10-18|         1|       2|      2|       0|    0|         66.0|                            4|        18|                2|                     2|                      1|                   0|              Aveiro|          Aveiro|       3|                10|             24|2023-05-23 23:59:00|         52|         0|          0|\n|      44|   1572437|Estados Unidos|     Registado|    190|     vista traseiras|Quarto Vista Tras...|                 BAR|2022-08-20 20:57:...|  2022-10-18|  2022-10-20|         2|       2|      2|       0|    0|        228.0|                           59|         2|                2|                     2|                      0|                   1|      Pinhão - Alijó|           Alijó|       3|                12|             24|2023-05-23 23:00:00|         10|         0|          0|\n|     539|   1517277|      Portugal|     Registado|   2542|      duplo standard|Quarto Dpl. Standard|                 Bar|2022-06-10 11:42:...|  2022-06-21|  2022-06-22|         1|       1|      1|       0|    0|         48.0|                           11|         5|                2|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|          0|\n|     539|   1490940|      Portugal|     Registado|   2545|                  t1|            Villa T1|                 Bar|2022-05-08 15:12:...|  2022-05-08|  2022-05-10|         2|       1|      1|       0|    0|        162.0|                            0|         1|                4|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|          0|\n|     185|   1488661|      Portugal|     Registado|    660|           duplotwin|          Duplo/Twin|                 BAR|2022-05-05 10:20:...|  2022-06-12|  2022-06-13|         1|       2|      2|       0|    0|        139.0|                           38|        17|                2|                     2|                      1|                   1|   Valdigem - Lamego|          Chaves|       4|                12|             36|2023-05-23 23:00:00|         20|         0|          0|\n|     482|   1477829|      Portugal|    Modificada|   2285|                  t1|      Apartamento T1|(WEB) Best Availa...|2022-04-20 12:01:...|  2022-07-25|  2022-08-01|         7|       4|      4|       0|    0|      1296.75|                           96|        90|                4|                     4|                      3|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|          0|\n|     328|   1485741|       Holanda|     Registado|   1452|              single|         Single Room|             WebSite|2022-05-01 17:59:...|  2022-05-07|  2022-05-09|         2|       1|      1|       0|    0|         79.3|                            6|         3|                1|                     1|                      0|                   0|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 22:00:00|         56|         0|          0|\n|     482|   1606829|      Portugal|     Registado|   2285|                  t1|      Apartamento T1|(WEB) Best Availa...|2022-10-12 10:09:...|  2022-10-13|  2022-10-15|         2|       2|      2|       0|    0|        114.0|                            1|        90|                4|                     4|                      3|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|          0|\n|     311|   1709250|      Portugal|      Pendente|   1407|      duplo standard|DB - Quarto Duplo...|      MR - Main Rate|2023-03-30 18:25:...|  2023-04-12|  2023-04-13|         1|       1|      1|       0|    0|      78.3275|                           13|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|          0|\n|     514|   1485227|   Reino Unido|     Registado|   2492|              garden|         Garden Room|   Non-Refundable >5|2022-04-30 22:31:...|  2022-08-10|  2022-08-17|         7|       1|      1|       0|    0|        924.0|                          102|         4|                3|                     2|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-23 18:00:00|         13|         1|          0|\n|     311|   1576545|       Espanha|     Registado|   2034|            superior|DBS - Quarto Dupl...|                 NR |2022-08-26 19:43:...|  2022-08-30|  2022-08-31|         1|       2|      2|       0|    0|90.7499999999|                            4|         5|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|          0|\n|     311|   1508102|       Letónia|     Registado|   1429|       twin standard|TW - Quarto Twin ...|    TW Room Only NRF|2022-05-29 20:02:...|  2022-06-02|  2022-06-03|         1|       1|      1|       0|    0|         73.0|                            4|         4|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|          0|\n|     492|   1678170|      Portugal|     Registado|   2322|twin com wc priva...|Quarto twin com W...|                 Bar|2023-02-14 13:48:...|  2023-02-18|  2023-02-20|         2|       2|      2|       0|    0|        140.0|                            4|         3|                2|                     2|                      1|                   1|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 09:00:00|         13|         0|          0|\n|     504|   1555750|      Portugal|     Registado|   2374|               other|       Cela da Torre|                 Bar|2022-07-28 07:38:...|  2022-08-13|  2022-08-15|         2|       1|      1|       0|    0|       206.91|                           16|         1|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-23 23:59:00|         27|         1|          0|\n|     259|   1483687|        França|     Registado|   1103|            standard|            Standard|Pacote Romântico/...|2022-04-28 14:44:...|  2022-05-06|  2022-05-07|         1|       2|      2|       0|    0|        125.0|                            8|        13|                3|                     3|                      1|                   1|           Guimarães|       Guimarães|       4|                11|             36|2023-05-23 23:59:00|         22|         0|          0|\n|     535|   1670013|      Portugal|      Pendente|   2783|            bungalow|            Bungalow|             WebSite|2023-02-02 16:18:...|  2023-02-15|  2023-02-16|         1|       2|      2|       0|    0|         72.0|                           13|         1|                2|                     2|                      0|                   0| Travanca do Mondego|         Coimbra|       4|                12|             24|2023-05-23 23:55:00|         11|         0|          0|\n|     311|   1453510|      Portugal|    Modificada|   1407|      duplo standard|DB - Quarto Duplo...|    DB Room Only NRF|2022-03-17 14:39:...|  2022-03-21|  2022-03-22|         1|       1|      1|       0|    0|         63.0|                            4|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|          0|\n|     310|   1645220|      Portugal|     Registado|   1673|            superior|Quarto Duplo Supe...|               NR BB|2022-12-25 17:48:...|  2022-12-27|  2022-12-28|         1|       2|      2|       0|    0|         70.3|                            2|        63|                2|                     2|                      1|                   0|                Gaia|           Porto|       3|                 0|              0|2023-05-23 23:59:00|        192|         0|          0|\n|     492|   1447780|      Portugal|     Registado|   2322|twin com wc priva...|Quarto twin com W...|                 Bar|2022-03-07 12:28:...|  2022-03-07|  2022-03-08|         1|       1|      1|       0|    0|         50.0|                            0|         3|                2|                     2|                      1|                   1|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 09:00:00|         13|         0|          0|\n|     444|   1578457|Estados Unidos|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|              Normal|2022-08-29 20:19:...|  2022-09-24|  2022-09-26|         2|       2|      2|       0|    0|        260.0|                           26|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-23 23:59:00|         77|         0|          0|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinEventosGrouped\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 30 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "inlay": {
       "collapsed": true
      },
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "event_count",
          "tpe": {
           "presentableName": "long"
          },
          "nullable": false
         },
         {
          "name": "city",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "tavg",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "tmax",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "tmin",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "prcp",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "val joinMeteoTemp = spark.sql(\n    \"\"\"\n        SELECT QR.*, M.city, M.tavg, M.tmax, M.tmin, M.prcp\n        FROM JoinEventosGrouped AS QR\n        LEFT JOIN Meteorologia AS M \n            ON QR.area_localizacao = M.city \n            AND M.date <= QR.data_partida AND M.date >= QR.data_chegada\n    \"\"\")\n\njoinMeteoTemp.createOrReplaceTempView(\"JoinMeteoTemp\")\n\nprintln(joinMeteoTemp.count())\njoinMeteoTemp.show()",
   "id": "",
   "dateCreated": "2023-05-01 15:31:17.385",
   "config": {
    "tableHide": true
   },
   "dateStarted": "2023-05-23 21:42:36.744",
   "dateUpdated": "2023-05-23 21:42:43.266",
   "dateFinished": "2023-05-23 21:42:43.266",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "69746\n+--------+----------+--------------+--------------+-------+---------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------+----+----+----+----+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|  Q_tipo_quarto|       T_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|preco_euros|dif_data_chegada_data_reserva|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|      localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|event_count|  city|tavg|tmax|tmin|prcp|\n+--------+----------+--------------+--------------+-------+---------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------+----+----+----+----+\n|     322|   1607927|     Austrália|     Registado|   2259|           twin|                Twin| Não Reembolsável AP|2022-10-13 17:24:...|  2022-10-17|  2022-10-18|         1|       2|      2|       0|    0|       66.0|                            4|        18|                2|                     2|                      1|                   0|           Aveiro|          Aveiro|       3|                10|             24|2023-05-23 23:59:00|         52|         0|          0|Aveiro|18.8|21.4|16.6|null|\n|     322|   1607927|     Austrália|     Registado|   2259|           twin|                Twin| Não Reembolsável AP|2022-10-13 17:24:...|  2022-10-17|  2022-10-18|         1|       2|      2|       0|    0|       66.0|                            4|        18|                2|                     2|                      1|                   0|           Aveiro|          Aveiro|       3|                10|             24|2023-05-23 23:59:00|         52|         0|          0|Aveiro|18.1|21.3|15.8|null|\n|      44|   1572437|Estados Unidos|     Registado|    190|vista traseiras|Quarto Vista Tras...|                 BAR|2022-08-20 20:57:...|  2022-10-18|  2022-10-20|         2|       2|      2|       0|    0|      228.0|                           59|         2|                2|                     2|                      0|                   1|   Pinhão - Alijó|           Alijó|       3|                12|             24|2023-05-23 23:00:00|         10|         0|          0| Alijó|13.1|16.0| 9.7|23.3|\n|      44|   1572437|Estados Unidos|     Registado|    190|vista traseiras|Quarto Vista Tras...|                 BAR|2022-08-20 20:57:...|  2022-10-18|  2022-10-20|         2|       2|      2|       0|    0|      228.0|                           59|         2|                2|                     2|                      0|                   1|   Pinhão - Alijó|           Alijó|       3|                12|             24|2023-05-23 23:00:00|         10|         0|          0| Alijó|14.5|16.9|11.2|36.2|\n|      44|   1572437|Estados Unidos|     Registado|    190|vista traseiras|Quarto Vista Tras...|                 BAR|2022-08-20 20:57:...|  2022-10-18|  2022-10-20|         2|       2|      2|       0|    0|      228.0|                           59|         2|                2|                     2|                      0|                   1|   Pinhão - Alijó|           Alijó|       3|                12|             24|2023-05-23 23:00:00|         10|         0|          0| Alijó|17.3|22.0|13.6| 0.0|\n|     539|   1517277|      Portugal|     Registado|   2542| duplo standard|Quarto Dpl. Standard|                 Bar|2022-06-10 11:42:...|  2022-06-21|  2022-06-22|         1|       1|      1|       0|    0|       48.0|                           11|         5|                2|                     2|                      0|                   0|           Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|          0|Amares|16.5|19.7|14.0|null|\n|     539|   1517277|      Portugal|     Registado|   2542| duplo standard|Quarto Dpl. Standard|                 Bar|2022-06-10 11:42:...|  2022-06-21|  2022-06-22|         1|       1|      1|       0|    0|       48.0|                           11|         5|                2|                     2|                      0|                   0|           Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|          0|Amares|16.4|19.6|13.8|null|\n|     539|   1490940|      Portugal|     Registado|   2545|             t1|            Villa T1|                 Bar|2022-05-08 15:12:...|  2022-05-08|  2022-05-10|         2|       1|      1|       0|    0|      162.0|                            0|         1|                4|                     2|                      0|                   0|           Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|          0|Amares|15.0|19.5|11.2|null|\n|     539|   1490940|      Portugal|     Registado|   2545|             t1|            Villa T1|                 Bar|2022-05-08 15:12:...|  2022-05-08|  2022-05-10|         2|       1|      1|       0|    0|      162.0|                            0|         1|                4|                     2|                      0|                   0|           Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|          0|Amares|16.4|21.4|12.0|null|\n|     539|   1490940|      Portugal|     Registado|   2545|             t1|            Villa T1|                 Bar|2022-05-08 15:12:...|  2022-05-08|  2022-05-10|         2|       1|      1|       0|    0|      162.0|                            0|         1|                4|                     2|                      0|                   0|           Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|          0|Amares|17.2|22.3|12.3|null|\n|     185|   1488661|      Portugal|     Registado|    660|      duplotwin|          Duplo/Twin|                 BAR|2022-05-05 10:20:...|  2022-06-12|  2022-06-13|         1|       2|      2|       0|    0|      139.0|                           38|        17|                2|                     2|                      1|                   1|Valdigem - Lamego|          Chaves|       4|                12|             36|2023-05-23 23:00:00|         20|         0|          0|Chaves|27.3|35.5|21.1| 0.0|\n|     185|   1488661|      Portugal|     Registado|    660|      duplotwin|          Duplo/Twin|                 BAR|2022-05-05 10:20:...|  2022-06-12|  2022-06-13|         1|       2|      2|       0|    0|      139.0|                           38|        17|                2|                     2|                      1|                   1|Valdigem - Lamego|          Chaves|       4|                12|             36|2023-05-23 23:00:00|         20|         0|          0|Chaves|27.1|33.9|20.8| 0.0|\n|     482|   1477829|      Portugal|    Modificada|   2285|             t1|      Apartamento T1|(WEB) Best Availa...|2022-04-20 12:01:...|  2022-07-25|  2022-08-01|         7|       4|      4|       0|    0|    1296.75|                           96|        90|                4|                     4|                      3|                   1|         Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|          0| Lagos|23.1|28.4|19.0|null|\n|     482|   1477829|      Portugal|    Modificada|   2285|             t1|      Apartamento T1|(WEB) Best Availa...|2022-04-20 12:01:...|  2022-07-25|  2022-08-01|         7|       4|      4|       0|    0|    1296.75|                           96|        90|                4|                     4|                      3|                   1|         Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|          0| Lagos|23.5|29.7|17.6|null|\n|     482|   1477829|      Portugal|    Modificada|   2285|             t1|      Apartamento T1|(WEB) Best Availa...|2022-04-20 12:01:...|  2022-07-25|  2022-08-01|         7|       4|      4|       0|    0|    1296.75|                           96|        90|                4|                     4|                      3|                   1|         Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|          0| Lagos|23.1|28.5|17.1|null|\n|     482|   1477829|      Portugal|    Modificada|   2285|             t1|      Apartamento T1|(WEB) Best Availa...|2022-04-20 12:01:...|  2022-07-25|  2022-08-01|         7|       4|      4|       0|    0|    1296.75|                           96|        90|                4|                     4|                      3|                   1|         Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|          0| Lagos|23.0|27.8|17.6|null|\n|     482|   1477829|      Portugal|    Modificada|   2285|             t1|      Apartamento T1|(WEB) Best Availa...|2022-04-20 12:01:...|  2022-07-25|  2022-08-01|         7|       4|      4|       0|    0|    1296.75|                           96|        90|                4|                     4|                      3|                   1|         Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|          0| Lagos|23.0|28.4|17.6|null|\n|     482|   1477829|      Portugal|    Modificada|   2285|             t1|      Apartamento T1|(WEB) Best Availa...|2022-04-20 12:01:...|  2022-07-25|  2022-08-01|         7|       4|      4|       0|    0|    1296.75|                           96|        90|                4|                     4|                      3|                   1|         Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|          0| Lagos|21.4|24.4|17.2|null|\n|     482|   1477829|      Portugal|    Modificada|   2285|             t1|      Apartamento T1|(WEB) Best Availa...|2022-04-20 12:01:...|  2022-07-25|  2022-08-01|         7|       4|      4|       0|    0|    1296.75|                           96|        90|                4|                     4|                      3|                   1|         Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|          0| Lagos|23.8|28.8|18.2|null|\n|     482|   1477829|      Portugal|    Modificada|   2285|             t1|      Apartamento T1|(WEB) Best Availa...|2022-04-20 12:01:...|  2022-07-25|  2022-08-01|         7|       4|      4|       0|    0|    1296.75|                           96|        90|                4|                     4|                      3|                   1|         Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|          0| Lagos|26.1|32.0|19.0|null|\n+--------+----------+--------------+--------------+-------+---------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-----------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+-----------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------+----+----+----+----+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinMeteoTemp\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 35 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "event_count",
          "tpe": {
           "presentableName": "long"
          },
          "nullable": false
         },
         {
          "name": "temperature_avg",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "temperature_max",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "temperature_min",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "precipitation_avg",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "precipitation_max",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "precipitation_min",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "var joinMeteoGrouped = spark.sql(\n    \"\"\"\n        SELECT \n            hotel_ID,  Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros, dif_data_chegada_data_reserva, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, is_holiday, event_count,\n            avg(tavg) AS temperature_avg,\n            max(tmax) AS temperature_max,\n            min(tmin) AS temperature_min,\n            avg(prcp) AS precipitation_avg,\n            max(prcp) AS precipitation_max,\n            min(prcp) AS precipitation_min\n        FROM JoinMeteoTemp\n        GROUP BY hotel_ID, Reserve_ID, pais, estado_reserva, room_ID, Q_tipo_quarto, T_tipo_quarto, rate_plan, data_reserva, data_chegada, data_partida, num_noites, ocupacao, adultos, criancas, bebes, preco_euros, dif_data_chegada_data_reserva, quantidade, capacidade_maxima, capacidade_max_adultos, capacidade_max_criancas, capacidade_max_bebes, localizacao, area_localizacao, estrelas, idade_max_criancas, idade_max_bebes, hora_max_checkin, qtd_quartos, is_holiday, event_count\n    \"\"\"\n)\n\njoinMeteoGrouped.createOrReplaceTempView(\"JoinMeteoGrouped\")\n\nprintln(joinMeteoGrouped.count())\njoinMeteoGrouped.show()",
   "id": "",
   "dateCreated": "2023-05-16 21:41:47.134",
   "config": {},
   "dateStarted": "2023-05-23 21:42:43.287",
   "dateUpdated": "2023-05-23 21:42:50.645",
   "dateFinished": "2023-05-23 21:42:50.645",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+------------------+-----------------+-----------------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|  preco_euros|dif_data_chegada_data_reserva|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|event_count|   temperature_avg|temperature_max|temperature_min| precipitation_avg|precipitation_max|precipitation_min|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+------------------+-----------------+-----------------+\n|     322|   1607927|     Austrália|     Registado|   2259|                twin|                Twin| Não Reembolsável AP|2022-10-13 17:24:...|  2022-10-17|  2022-10-18|         1|       2|      2|       0|    0|         66.0|                            4|        18|                2|                     2|                      1|                   0|              Aveiro|          Aveiro|       3|                10|             24|2023-05-23 23:59:00|         52|         0|          0|18.450000000000003|           21.4|           15.8|              null|             null|             null|\n|      44|   1572437|Estados Unidos|     Registado|    190|     vista traseiras|Quarto Vista Tras...|                 BAR|2022-08-20 20:57:...|  2022-10-18|  2022-10-20|         2|       2|      2|       0|    0|        228.0|                           59|         2|                2|                     2|                      0|                   1|      Pinhão - Alijó|           Alijó|       3|                12|             24|2023-05-23 23:00:00|         10|         0|          0|14.966666666666669|           22.0|            9.7|19.833333333333332|             36.2|              0.0|\n|     539|   1517277|      Portugal|     Registado|   2542|      duplo standard|Quarto Dpl. Standard|                 Bar|2022-06-10 11:42:...|  2022-06-21|  2022-06-22|         1|       1|      1|       0|    0|         48.0|                           11|         5|                2|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|          0|             16.45|           19.7|           13.8|              null|             null|             null|\n|     539|   1490940|      Portugal|     Registado|   2545|                  t1|            Villa T1|                 Bar|2022-05-08 15:12:...|  2022-05-08|  2022-05-10|         2|       1|      1|       0|    0|        162.0|                            0|         1|                4|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|          0|              16.2|           22.3|           11.2|              null|             null|             null|\n|     185|   1488661|      Portugal|     Registado|    660|           duplotwin|          Duplo/Twin|                 BAR|2022-05-05 10:20:...|  2022-06-12|  2022-06-13|         1|       2|      2|       0|    0|        139.0|                           38|        17|                2|                     2|                      1|                   1|   Valdigem - Lamego|          Chaves|       4|                12|             36|2023-05-23 23:00:00|         20|         0|          0|27.200000000000003|           35.5|           20.8|               0.0|              0.0|              0.0|\n|     482|   1477829|      Portugal|    Modificada|   2285|                  t1|      Apartamento T1|(WEB) Best Availa...|2022-04-20 12:01:...|  2022-07-25|  2022-08-01|         7|       4|      4|       0|    0|      1296.75|                           96|        90|                4|                     4|                      3|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|          0|            23.375|           32.0|           17.1|              null|             null|             null|\n|     328|   1485741|       Holanda|     Registado|   1452|              single|         Single Room|             WebSite|2022-05-01 17:59:...|  2022-05-07|  2022-05-09|         2|       1|      1|       0|    0|         79.3|                            6|         3|                1|                     1|                      0|                   0|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 22:00:00|         56|         0|          0|              22.3|           30.5|           15.0|               0.0|              0.0|              0.0|\n|     482|   1606829|      Portugal|     Registado|   2285|                  t1|      Apartamento T1|(WEB) Best Availa...|2022-10-12 10:09:...|  2022-10-13|  2022-10-15|         2|       2|      2|       0|    0|        114.0|                            1|        90|                4|                     4|                      3|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|          0|              20.2|           24.4|           17.6|              null|             null|             null|\n|     311|   1709250|      Portugal|      Pendente|   1407|      duplo standard|DB - Quarto Duplo...|      MR - Main Rate|2023-03-30 18:25:...|  2023-04-12|  2023-04-13|         1|       1|      1|       0|    0|      78.3275|                           13|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|          0|              12.4|           16.0|            7.0|               1.9|              3.5|              0.3|\n|     514|   1485227|   Reino Unido|     Registado|   2492|              garden|         Garden Room|   Non-Refundable >5|2022-04-30 22:31:...|  2022-08-10|  2022-08-17|         7|       1|      1|       0|    0|        924.0|                          102|         4|                3|                     2|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-23 18:00:00|         13|         1|          0|           21.8625|           29.9|           17.9|               0.0|              0.0|              0.0|\n|     311|   1576545|       Espanha|     Registado|   2034|            superior|DBS - Quarto Dupl...|                 NR |2022-08-26 19:43:...|  2022-08-30|  2022-08-31|         1|       2|      2|       0|    0|90.7499999999|                            4|         5|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|          0|             18.15|           22.8|           14.8|               0.0|              0.0|              0.0|\n|     311|   1508102|       Letónia|     Registado|   1429|       twin standard|TW - Quarto Twin ...|    TW Room Only NRF|2022-05-29 20:02:...|  2022-06-02|  2022-06-03|         1|       1|      1|       0|    0|         73.0|                            4|         4|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|          0|              18.5|           22.9|           15.3|               1.2|              1.4|              1.0|\n|     492|   1678170|      Portugal|     Registado|   2322|twin com wc priva...|Quarto twin com W...|                 Bar|2023-02-14 13:48:...|  2023-02-18|  2023-02-20|         2|       2|      2|       0|    0|        140.0|                            4|         3|                2|                     2|                      1|                   1|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 09:00:00|         13|         0|          0|14.333333333333334|           20.2|           10.7|0.6666666666666666|              1.2|              0.0|\n|     504|   1555750|      Portugal|     Registado|   2374|               other|       Cela da Torre|                 Bar|2022-07-28 07:38:...|  2022-08-13|  2022-08-15|         2|       1|      1|       0|    0|       206.91|                           16|         1|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-23 23:59:00|         27|         1|          0|18.166666666666668|           22.7|           13.9|2.2666666666666666|              6.8|              0.0|\n|     259|   1483687|        França|     Registado|   1103|            standard|            Standard|Pacote Romântico/...|2022-04-28 14:44:...|  2022-05-06|  2022-05-07|         1|       2|      2|       0|    0|        125.0|                            8|        13|                3|                     3|                      1|                   1|           Guimarães|       Guimarães|       4|                11|             36|2023-05-23 23:59:00|         22|         0|          0|             15.75|           20.8|           10.3|              null|             null|             null|\n|     535|   1670013|      Portugal|      Pendente|   2783|            bungalow|            Bungalow|             WebSite|2023-02-02 16:18:...|  2023-02-15|  2023-02-16|         1|       2|      2|       0|    0|         72.0|                           13|         1|                2|                     2|                      0|                   0| Travanca do Mondego|         Coimbra|       4|                12|             24|2023-05-23 23:55:00|         11|         0|          0|             13.95|           18.9|            9.7|               0.0|              0.0|              0.0|\n|     311|   1453510|      Portugal|    Modificada|   1407|      duplo standard|DB - Quarto Duplo...|    DB Room Only NRF|2022-03-17 14:39:...|  2022-03-21|  2022-03-22|         1|       1|      1|       0|    0|         63.0|                            4|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|          0|             13.25|           18.2|           10.7|              null|             null|             null|\n|     310|   1645220|      Portugal|     Registado|   1673|            superior|Quarto Duplo Supe...|               NR BB|2022-12-25 17:48:...|  2022-12-27|  2022-12-28|         1|       2|      2|       0|    0|         70.3|                            2|        63|                2|                     2|                      1|                   0|                Gaia|           Porto|       3|                 0|              0|2023-05-23 23:59:00|        192|         0|          0|12.649999999999999|           14.9|           11.4|              6.45|             12.6|              0.3|\n|     492|   1447780|      Portugal|     Registado|   2322|twin com wc priva...|Quarto twin com W...|                 Bar|2022-03-07 12:28:...|  2022-03-07|  2022-03-08|         1|       1|      1|       0|    0|         50.0|                            0|         3|                2|                     2|                      1|                   1|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 09:00:00|         13|         0|          0|             12.45|           17.2|            8.9|              3.25|              5.1|              1.4|\n|     444|   1578457|Estados Unidos|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|              Normal|2022-08-29 20:19:...|  2022-09-24|  2022-09-26|         2|       2|      2|       0|    0|        260.0|                           26|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-23 23:59:00|         77|         0|          0|              17.5|           22.2|           10.0|               0.0|              0.0|              0.0|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+------------------+-----------------+-----------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mjoinMeteoGrouped\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 36 more fields]\n"
     }
    ]
   }
  },
  {
   "settings": {
    "params": {
     "bdtMeta": {
      "ZTOOLS_DATA_FRAMES": [
       {
        "columns": [
         {
          "name": "hotel_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Reserve_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "pais",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estado_reserva",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "room_ID",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "Q_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "T_tipo_quarto",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "rate_plan",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "data_reserva",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "data_chegada",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "data_partida",
          "tpe": {
           "presentableName": "date"
          },
          "nullable": true
         },
         {
          "name": "num_noites",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "ocupacao",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "preco_euros",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "dif_data_chegada_data_reserva",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "quantidade",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_maxima",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_adultos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "capacidade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "area_localizacao",
          "tpe": {
           "presentableName": "string"
          },
          "nullable": true
         },
         {
          "name": "estrelas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_criancas",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "idade_max_bebes",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "hora_max_checkin",
          "tpe": {
           "presentableName": "timestamp"
          },
          "nullable": true
         },
         {
          "name": "qtd_quartos",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "is_holiday",
          "tpe": {
           "presentableName": "integer"
          },
          "nullable": true
         },
         {
          "name": "event_count",
          "tpe": {
           "presentableName": "long"
          },
          "nullable": false
         },
         {
          "name": "temperature_avg",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "temperature_max",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "temperature_min",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "precipitation_avg",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "precipitation_max",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         },
         {
          "name": "precipitation_min",
          "tpe": {
           "presentableName": "double"
          },
          "nullable": true
         }
        ]
       }
      ]
     }
    },
    "forms": {}
   },
   "apps": [],
   "status": "FINISHED",
   "text": "joinMeteoGrouped.createOrReplaceTempView(\"FinalDataSet\")\n\nval FinalDataSet = spark.sql(\"select * from FinalDataSet\")\nprintln(FinalDataSet.count())\nFinalDataSet.show()\n\nsaveDataFrame(FinalDataSet, \"FinalDataSet\")",
   "id": "",
   "dateCreated": "2023-05-01 15:47:23.871",
   "config": {},
   "dateStarted": "2023-05-23 21:42:50.665",
   "dateUpdated": "2023-05-23 21:43:02.630",
   "dateFinished": "2023-05-23 21:43:02.630",
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "24947\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+------------------+-----------------+-----------------+\n|hotel_ID|Reserve_ID|          pais|estado_reserva|room_ID|       Q_tipo_quarto|       T_tipo_quarto|           rate_plan|        data_reserva|data_chegada|data_partida|num_noites|ocupacao|adultos|criancas|bebes|  preco_euros|dif_data_chegada_data_reserva|quantidade|capacidade_maxima|capacidade_max_adultos|capacidade_max_criancas|capacidade_max_bebes|         localizacao|area_localizacao|estrelas|idade_max_criancas|idade_max_bebes|   hora_max_checkin|qtd_quartos|is_holiday|event_count|   temperature_avg|temperature_max|temperature_min| precipitation_avg|precipitation_max|precipitation_min|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+------------------+-----------------+-----------------+\n|     322|   1607927|     Austrália|     Registado|   2259|                twin|                Twin| Não Reembolsável AP|2022-10-13 17:24:...|  2022-10-17|  2022-10-18|         1|       2|      2|       0|    0|         66.0|                            4|        18|                2|                     2|                      1|                   0|              Aveiro|          Aveiro|       3|                10|             24|2023-05-23 23:59:00|         52|         0|          0|18.450000000000003|           21.4|           15.8|              null|             null|             null|\n|      44|   1572437|Estados Unidos|     Registado|    190|     vista traseiras|Quarto Vista Tras...|                 BAR|2022-08-20 20:57:...|  2022-10-18|  2022-10-20|         2|       2|      2|       0|    0|        228.0|                           59|         2|                2|                     2|                      0|                   1|      Pinhão - Alijó|           Alijó|       3|                12|             24|2023-05-23 23:00:00|         10|         0|          0|14.966666666666669|           22.0|            9.7|19.833333333333332|             36.2|              0.0|\n|     539|   1517277|      Portugal|     Registado|   2542|      duplo standard|Quarto Dpl. Standard|                 Bar|2022-06-10 11:42:...|  2022-06-21|  2022-06-22|         1|       1|      1|       0|    0|         48.0|                           11|         5|                2|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|          0|             16.45|           19.7|           13.8|              null|             null|             null|\n|     539|   1490940|      Portugal|     Registado|   2545|                  t1|            Villa T1|                 Bar|2022-05-08 15:12:...|  2022-05-08|  2022-05-10|         2|       1|      1|       0|    0|        162.0|                            0|         1|                4|                     2|                      0|                   0|              Amares|          Amares|       0|                 0|              0|2023-05-23 18:00:00|         58|         0|          0|              16.2|           22.3|           11.2|              null|             null|             null|\n|     185|   1488661|      Portugal|     Registado|    660|           duplotwin|          Duplo/Twin|                 BAR|2022-05-05 10:20:...|  2022-06-12|  2022-06-13|         1|       2|      2|       0|    0|        139.0|                           38|        17|                2|                     2|                      1|                   1|   Valdigem - Lamego|          Chaves|       4|                12|             36|2023-05-23 23:00:00|         20|         0|          0|27.200000000000003|           35.5|           20.8|               0.0|              0.0|              0.0|\n|     482|   1477829|      Portugal|    Modificada|   2285|                  t1|      Apartamento T1|(WEB) Best Availa...|2022-04-20 12:01:...|  2022-07-25|  2022-08-01|         7|       4|      4|       0|    0|      1296.75|                           96|        90|                4|                     4|                      3|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|          0|            23.375|           32.0|           17.1|              null|             null|             null|\n|     328|   1485741|       Holanda|     Registado|   1452|              single|         Single Room|             WebSite|2022-05-01 17:59:...|  2022-05-07|  2022-05-09|         2|       1|      1|       0|    0|         79.3|                            6|         3|                1|                     1|                      0|                   0|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 22:00:00|         56|         0|          0|              22.3|           30.5|           15.0|               0.0|              0.0|              0.0|\n|     482|   1606829|      Portugal|     Registado|   2285|                  t1|      Apartamento T1|(WEB) Best Availa...|2022-10-12 10:09:...|  2022-10-13|  2022-10-15|         2|       2|      2|       0|    0|        114.0|                            1|        90|                4|                     4|                      3|                   1|            Portimão|           Lagos|       4|                 3|             36|2023-05-23 23:59:00|        143|         0|          0|              20.2|           24.4|           17.6|              null|             null|             null|\n|     311|   1709250|      Portugal|      Pendente|   1407|      duplo standard|DB - Quarto Duplo...|      MR - Main Rate|2023-03-30 18:25:...|  2023-04-12|  2023-04-13|         1|       1|      1|       0|    0|      78.3275|                           13|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|          0|              12.4|           16.0|            7.0|               1.9|              3.5|              0.3|\n|     514|   1485227|   Reino Unido|     Registado|   2492|              garden|         Garden Room|   Non-Refundable >5|2022-04-30 22:31:...|  2022-08-10|  2022-08-17|         7|       1|      1|       0|    0|        924.0|                          102|         4|                3|                     2|                      0|                   0|Charneca de Caparica|       Carnaxide|       3|                12|             24|2023-05-23 18:00:00|         13|         1|          0|           21.8625|           29.9|           17.9|               0.0|              0.0|              0.0|\n|     311|   1576545|       Espanha|     Registado|   2034|            superior|DBS - Quarto Dupl...|                 NR |2022-08-26 19:43:...|  2022-08-30|  2022-08-31|         1|       2|      2|       0|    0|90.7499999999|                            4|         5|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|          0|             18.15|           22.8|           14.8|               0.0|              0.0|              0.0|\n|     311|   1508102|       Letónia|     Registado|   1429|       twin standard|TW - Quarto Twin ...|    TW Room Only NRF|2022-05-29 20:02:...|  2022-06-02|  2022-06-03|         1|       1|      1|       0|    0|         73.0|                            4|         4|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|          0|              18.5|           22.9|           15.3|               1.2|              1.4|              1.0|\n|     492|   1678170|      Portugal|     Registado|   2322|twin com wc priva...|Quarto twin com W...|                 Bar|2023-02-14 13:48:...|  2023-02-18|  2023-02-20|         2|       2|      2|       0|    0|        140.0|                            4|         3|                2|                     2|                      1|                   1|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 09:00:00|         13|         0|          0|14.333333333333334|           20.2|           10.7|0.6666666666666666|              1.2|              0.0|\n|     504|   1555750|      Portugal|     Registado|   2374|               other|       Cela da Torre|                 Bar|2022-07-28 07:38:...|  2022-08-13|  2022-08-15|         2|       1|      1|       0|    0|       206.91|                           16|         1|                2|                     2|                      0|                   1|              Monção|          Monção|       4|                12|             36|2023-05-23 23:59:00|         27|         1|          0|18.166666666666668|           22.7|           13.9|2.2666666666666666|              6.8|              0.0|\n|     259|   1483687|        França|     Registado|   1103|            standard|            Standard|Pacote Romântico/...|2022-04-28 14:44:...|  2022-05-06|  2022-05-07|         1|       2|      2|       0|    0|        125.0|                            8|        13|                3|                     3|                      1|                   1|           Guimarães|       Guimarães|       4|                11|             36|2023-05-23 23:59:00|         22|         0|          0|             15.75|           20.8|           10.3|              null|             null|             null|\n|     535|   1670013|      Portugal|      Pendente|   2783|            bungalow|            Bungalow|             WebSite|2023-02-02 16:18:...|  2023-02-15|  2023-02-16|         1|       2|      2|       0|    0|         72.0|                           13|         1|                2|                     2|                      0|                   0| Travanca do Mondego|         Coimbra|       4|                12|             24|2023-05-23 23:55:00|         11|         0|          0|             13.95|           18.9|            9.7|               0.0|              0.0|              0.0|\n|     311|   1453510|      Portugal|    Modificada|   1407|      duplo standard|DB - Quarto Duplo...|    DB Room Only NRF|2022-03-17 14:39:...|  2022-03-21|  2022-03-22|         1|       1|      1|       0|    0|         63.0|                            4|         8|                2|                     2|                      2|                   0|                Maia|            Maia|       3|                12|             36|2023-05-23 23:59:00|         30|         0|          0|             13.25|           18.2|           10.7|              null|             null|             null|\n|     310|   1645220|      Portugal|     Registado|   1673|            superior|Quarto Duplo Supe...|               NR BB|2022-12-25 17:48:...|  2022-12-27|  2022-12-28|         1|       2|      2|       0|    0|         70.3|                            2|        63|                2|                     2|                      1|                   0|                Gaia|           Porto|       3|                 0|              0|2023-05-23 23:59:00|        192|         0|          0|12.649999999999999|           14.9|           11.4|              6.45|             12.6|              0.3|\n|     492|   1447780|      Portugal|     Registado|   2322|twin com wc priva...|Quarto twin com W...|                 Bar|2022-03-07 12:28:...|  2022-03-07|  2022-03-08|         1|       1|      1|       0|    0|         50.0|                            0|         3|                2|                     2|                      1|                   1|              Lisboa|       Carnaxide|       0|                 0|              0|2023-05-23 09:00:00|         13|         0|          0|             12.45|           17.2|            8.9|              3.25|              5.1|              1.4|\n|     444|   1578457|Estados Unidos|     Registado|   2074|duplo vista mar l...|Duplo   Vista Mar...|              Normal|2022-08-29 20:19:...|  2022-09-24|  2022-09-26|         2|       2|      2|       0|    0|        260.0|                           26|         5|                2|                     2|                      1|                   1|              Nazaré|         Batalha|       4|                12|             24|2023-05-23 23:59:00|         77|         0|          0|              17.5|           22.2|           10.0|               0.0|              0.0|              0.0|\n+--------+----------+--------------+--------------+-------+--------------------+--------------------+--------------------+--------------------+------------+------------+----------+--------+-------+--------+-----+-------------+-----------------------------+----------+-----------------+----------------------+-----------------------+--------------------+--------------------+----------------+--------+------------------+---------------+-------------------+-----------+----------+-----------+------------------+---------------+---------------+------------------+-----------------+-----------------+\nonly showing top 20 rows\n\n\u001b[1m\u001b[34mFinalDataSet\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [hotel_ID: int, Reserve_ID: int ... 36 more fields]\n"
     }
    ]
   }
  }
 ],
 "name": "Zeppelin Notebook",
 "id": "",
 "noteParams": {},
 "noteForms": {},
 "angularObjects": {},
 "config": {
  "isZeppelinNotebookCronEnable": false,
  "looknfeel": "default",
  "personalizedMode": "false"
 },
 "info": {}
}